package com.nbcu.sphere.Common;

import java.awt.Robot;
import java.awt.event.KeyEvent;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.FilenameFilter;
import java.io.InputStreamReader;
import java.lang.reflect.Constructor;
import java.lang.reflect.Method;
import java.net.URL;
import java.nio.file.Files;
import java.nio.file.StandardCopyOption;
import java.sql.Timestamp;
import java.text.DateFormat;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Locale;
import java.util.Properties;
import java.util.Random;
import java.util.Scanner;
import java.util.concurrent.TimeUnit;

import org.apache.commons.io.FileUtils;
import org.apache.commons.lang3.time.DateUtils;
import org.bouncycastle.util.Store;
import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.firefox.FirefoxProfile;
import org.openqa.selenium.firefox.internal.ProfilesIni;
import org.openqa.selenium.ie.InternetExplorerDriver;
import org.openqa.selenium.interactions.Action;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.remote.DesiredCapabilities;
import org.openqa.selenium.safari.SafariDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.Select;
import org.openqa.selenium.support.ui.WebDriverWait;


//import org.seleniumhq.jetty7.util.log.Log;










import com.gargoylesoftware.htmlunit.javascript.host.intl.DateTimeFormat;
import com.nbcu.sphere.TestDriver;
import com.nbcu.sphere.ConfigManager.FileLocSetter;
import com.nbcu.sphere.ConfigManager.SQLConfig;
import com.nbcu.sphere.ObjectRepository.SphereCommon;
import com.nbcu.sphere.ObjectRepository.SphereModules;
import com.nbcu.sphere.ReportManager.Reporter;
import com.nbcu.sphere.UtilManager.AppMessages;
import com.nbcu.sphere.UtilManager.DBUtil;
import com.nbcu.sphere.UtilManager.ExcelUtil;

import junit.framework.Assert;
import jxl.write.DateTime;
import oracle.jdbc.driver.Message;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;



public class BusinessFunctionLibrary
{
	//public static AppiumDriver<IOSElement> iosdriver;
	//public static WebDriver driver = null;
	public static Properties prop=null; // properties file
	public static Properties objRepProp=null; // object repository property
	public static Reporter obj=new Reporter();
//	public static PrepareExcelReport objEx=new PrepareExcelReport();
	
	public static boolean step_fail; // keep track of total step fail for each testcase
	public static int mainStep; // keep track of main step for each testcases
	public static int subStep; // keep track of subStep for each mainStep
	public static boolean testCaseStatus; // keep track of the test flow
	public String strTimeDiff = null;
	
	DBUtil objDBUtility = new DBUtil();
	SphereCommon objSphereCommon = new SphereCommon();
	SphereModules objSphereModules = new SphereModules();
	GenericFunctionLibrary objGenericFunctionLibrary = new GenericFunctionLibrary();
	AppMessages objAppMessages = new AppMessages();
	SQLConfig objSQLConfig = new SQLConfig();
	
	ExcelUtil objExcelUtility = new ExcelUtil();
			 
		 public void fnCompareMenuOptions(String sExpMenuList) throws Exception {
			 
			 String sMenuOrder = "";
		    	String sMenuType = "";
			    try {
			    	
			    	List<String> arrExpMenuList = new ArrayList<String>();
			    	List<String> arrActMenuList = new ArrayList<String>();
			    	String[] arrMenu = sExpMenuList.split(":");
			    	
			    	List<WebElement> eleNavList = TestDriver.driver.findElements(By.xpath(SphereCommon.Main_HomeNavigationLinks_xp));
					Integer iNavListSize = eleNavList.size();
					
								    	
			    	if(sExpMenuList.contains("MainMenu"))
			    	{
			    		sMenuType = "Main Menu";  //For reporting purpose
			    		for (String sExpMenuOption: arrMenu[1].toString().split(","))
			    		{
			    			sMenuOrder = sMenuOrder + ", " + sExpMenuOption;
			    			System.out.println(sExpMenuOption);
			    			arrExpMenuList.add(sExpMenuOption);
			    		}
			    		sMenuOrder = sMenuOrder.substring(2);
			    		
			    		for(int i=0;i<iNavListSize; i++)
						{
			    			objGenericFunctionLibrary.HighlightElement(eleNavList.get(i).findElement(By.xpath("./div")));
			    			String sMainMenuOption = eleNavList.get(i).findElement(By.xpath("./div")).getText();
							System.out.println(sMainMenuOption);
							arrActMenuList.add(i, sMainMenuOption);
						}
			    		
			    	}
			    	else if(sExpMenuList.contains("SubMenu"))
			    	{
			    		sMenuType = "Sub Menu";    //For reporting purpose
			    		for (String sExpMenuOption: arrMenu[2].toString().split(","))
			    		{
			    			sMenuOrder = sMenuOrder + ", " + sExpMenuOption;
			    			System.out.println(sExpMenuOption);
			    			arrExpMenuList.add(sExpMenuOption);
			    		}
			    		sMenuOrder = arrMenu[1].toString() + "->" + sMenuOrder.substring(2);
			    		
			    		for(int i=0;i<iNavListSize; i++)
						{
			    			String sMainMenuOption = eleNavList.get(i).findElement(By.xpath("./div")).getText();
							System.out.println(sMainMenuOption);
							if(sMainMenuOption.equalsIgnoreCase(arrMenu[1].toString()))
							{	
								objGenericFunctionLibrary.ClickByElement(eleNavList.get(i).findElement(By.xpath("./div")), arrMenu[1].toString(), true);
								//eleNavList.get(i).click();
								List<WebElement> eleSubNavList = eleNavList.get(i).findElements(By.xpath("./ul/li"));
								Integer iSubNavListSize = eleSubNavList.size();
								for(int j=0;j<iSubNavListSize; j++)
								{
									objGenericFunctionLibrary.HighlightElement(eleSubNavList.get(j).findElement(By.xpath("./div/span[2]")));
									String sSubMenuOption = eleSubNavList.get(j).findElement(By.xpath("./div/span[2]")).getText();
									System.out.println(sSubMenuOption);
									arrActMenuList.add(j, sSubMenuOption);
								}
								break;
							}
							
						}
			    		
			    	}
			    	
			    	if(arrActMenuList.equals(arrExpMenuList))
					{
						obj.repAddData( "Verify "+sMenuType+" Options on Home Page", "All "+sMenuType+" options should be available in correct order", "All "+sMenuType+" options are verified with correct values and order : "+sMenuOrder, "Pass");
					}
					else
					{
						obj.repAddData( "Verify "+sMenuType+" Options  on Home Page", "All "+sMenuType+" options should be available in correct order", sMenuType+" options check failed with incorrect values or order : "+sMenuOrder, "Fail");
					}
			    	
			    } catch (Exception e) {
			    	obj.repAddData( "Verify "+sMenuType+" Options  on Home Page", "All "+sMenuType+" options should be available in correct order", sMenuType+" options check failed with incorrect values or order : "+sMenuOrder, "Fail");
			    	 System.out.println("fnCompareMenuOptions --------------Failed");    
					    TestDriver.log.error("fnCompareMenuOptions failed",e);
			    }
			}
		 public void fnBusinessTest()
		 {
			System.out.println("Business Function Call");
		 }
	 
		 @SuppressWarnings("static-access")
		 public void fnClickMainMenuElement(String sMainOptionText) throws Exception {

			 WebElement eleMain = null;
			 try {
				 System.out.println("Hello");
				 List<WebElement> eleNavList = TestDriver.driver.findElements(By.xpath(objSphereCommon.Main_HomeNavigationLinks_xp));
				 Integer iNavListSize = eleNavList.size();
				 for(int i=0;i<iNavListSize; i++)
				 {
					 eleMain = eleNavList.get(i).findElement(By.xpath("./div/span[2]"));
					 String sMainMenuOption = eleMain.getText();
					 if(sMainMenuOption.equalsIgnoreCase(sMainOptionText))
					 {
						 objGenericFunctionLibrary.ClickByElement(eleMain, sMainOptionText, true);
						 break;
					 }
					 //objGenericFunctionLibrary.HighlightElement(eleNavList.get(i).findElement(By.xpath("./div/span[2]")));
				 }


			 } catch (Exception e) {
				 System.out.println("fnClickMainMenuElement --------------Failed");    
				 TestDriver.log.error("fnClickMainMenuElement failed",e);
			 }
		 }

		 @SuppressWarnings("static-access")
		 public void fnClickSubMenuElement(String sMainOptionText, String sSubOptionText) throws Exception {

			 WebElement eleMain = null;
			 WebElement eleSub = null;
			 try {

				 List<WebElement> eleNavList = TestDriver.driver.findElements(By.xpath(objSphereCommon.Main_HomeNavigationLinks_xp));
				 Integer iNavListSize = eleNavList.size();
				 for(int i=0;i<iNavListSize; i++)
				 {
					 eleMain = eleNavList.get(i).findElement(By.xpath("./div/span[2]"));
					 String sMainMenuOption = eleMain.getText();
					 if(sMainMenuOption.equalsIgnoreCase(sMainOptionText))
					 {
						 objGenericFunctionLibrary.ClickByElement(eleMain, sMainOptionText, true);

						 List<WebElement> eleSubNavList = eleNavList.get(i).findElements(By.xpath("./ul/li"));
						 Integer iSubNavListSize = eleSubNavList.size();
						 for(int j=0;j<iSubNavListSize; j++)
						 {
							 eleSub = eleSubNavList.get(j).findElement(By.xpath("./div/span[2]"));
							 String sSubMenuOption = eleSub.getText();
							 if(sSubMenuOption.equalsIgnoreCase(sSubOptionText))
							 {
								 Thread.sleep(3000);
								 objGenericFunctionLibrary.ClickByElement(eleSub, sSubOptionText, true);
								 Thread.sleep(4000);
								 break;
							 }
						 }
						 break;
					 }
					 //objGenericFunctionLibrary.HighlightElement(eleNavList.get(i).findElement(By.xpath("./div/span[2]")));
				 }

				 objGenericFunctionLibrary.fnLoadingPageWait();

			 } catch (Exception e) {
				 System.out.println("fnClickSubMenuElement --------------Failed");    
				 TestDriver.log.error("fnClickSubMenuElement failed",e);
			 }
		 }

		 public void fnSelectCheckBoxInTable(String sTablePath, int iMatchCol, String sMatchValue) throws Exception
		 {

			 try
			 {
				 WebElement eleTable = TestDriver.driver.findElement(By.xpath(sTablePath));
				 List<WebElement> arrTableRows = eleTable.findElements(By.xpath("./tr"));  //Get the table data rows
				 System.out.println("Data Rows Size>>>>"+arrTableRows.size());

				 for(int iRow=0;iRow<arrTableRows.size();iRow++)  //Exclude first header row 
				 {	
					 List<WebElement> arrTableColumns = arrTableRows.get(iRow).findElements(By.xpath("./td"));  //Get the table data rows
					 String sColValue = arrTableColumns.get(iMatchCol).getText();//.toString();
					 if(sColValue.equalsIgnoreCase(sMatchValue))
					 {
						 arrTableColumns.get(0).findElement(By.xpath("./input")).click();  //Select the checkbox
						 obj.repAddData( "Select '"+sMatchValue+"'", "'"+sMatchValue+"' should be selected", "'"+sMatchValue+"' selected successfully", "Pass");
					 }


				 }

			 } catch (Exception e) {
				 obj.repAddData( "Select '"+sMatchValue+"'", "'"+sMatchValue+"' should be selected", "'"+sMatchValue+"' not selected", "Fail");
				 System.out.println("fnSelectCheckBoxInTable --------------Failed");    
				 TestDriver.log.error("fnSelectCheckBoxInTable failed",e);
			 }


		 }

		 public void fnVerifyWIPforARCDraftandSuspense(String sTablePath, String sOption) throws Exception
		 {

			 try
			 {
				    WebDriverWait waitForTableLoad;	
					waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				    objGenericFunctionLibrary.ClickByXpath(sTablePath,sOption,true);
					
					WebElement eleTable = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_Aging_Table_xp));
					List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
					System.out.println("Rows Size>>>>"+arrHeaderColumns.size());
					
					HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(SphereModules.WIP_Aging_Table_xp);
					
					System.out.println(mTableDataUI.size());
					int RecordsSize=20;
					if(mTableDataUI.size()<=RecordsSize){
						obj.repAddData( "Verifying Records are displayed on the page",  RecordsSize+ " records should be displayed on the page ", RecordsSize+  " records displayed on the page", "Pass");	
					}else
					{
						obj.repAddData( "Verifying Records are displayed on the page", RecordsSize+  " records should be displayed on the page ", RecordsSize+   " records not displayed on the page", "Fail");	
					}
					objGenericFunctionLibrary.ClickByXpath(SphereModules.WIP_Aging_Table_CC_xp,"Cost Center on WIP Aging",true);
					
					waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereModules.WIP_Transaction_Detail_Title_xp)));
					WebElement Title1 = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_Transaction_Detail_Title_xp));
					objGenericFunctionLibrary.HighlightElement(Title1);
					//WIP_TransactionDetail_Table_xp
					
					WebElement eleTable1 = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_TransactionDetail_Table_xp));
					List<WebElement> arrHeaderColumns1 = eleTable1.findElements(By.xpath("../thead/tr/th"));  //Get the header
					System.out.println("Rows Size>>>>"+arrHeaderColumns1.size());
					
					HashMap<Integer, HashMap<Integer, String>> mTableDataUI1 = objGenericFunctionLibrary.fnGetTableData(SphereModules.WIP_TransactionDetail_Table_xp);
					
					System.out.println(mTableDataUI.size());
					
					if(mTableDataUI1.size()<=RecordsSize){
						obj.repAddData( "Verifying Records are displayed on the page",  RecordsSize+ " records should be displayed on the page ", RecordsSize+  " records displayed on the page", "Pass");	
					}else
					{
						obj.repAddData( "Verifying Records are displayed on the page", RecordsSize+  " records should be displayed on the page ", RecordsSize+   " records not displayed on the page", "Fail");	
					}
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Back_to_aging_xp,"Back to aging",true);
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Back_to_Summary_xp,"Back to Summary",true);
					

			 } catch (Exception e) {
				 //obj.repAddData( "Select '"+sMatchValue+"'", "'"+sMatchValue+"' should be selected", "'"+sMatchValue+"' not selected", "Fail");
				 System.out.println("fnVerifyWIPforARCDraftandSuspense --------------Failed");    
				 TestDriver.log.error("fnVerifyWIPforARCDraftandSuspense failed",e);
			 }


		 }
		 
		 public void fnVerifyWIPTotalforARCDraftandSuspense(String sTablePath, String sOption) throws Exception
		 {
			 String sTotal="";
			 try
			 {
				    WebDriverWait waitForTableLoad;	
					waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				    objGenericFunctionLibrary.ClickByXpath(sTablePath,sOption,true);
					
					WebElement eleTable = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_Aging_Table_xp));
					List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
					System.out.println("Rows Size>>>>"+arrHeaderColumns.size());
					
					HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(SphereModules.WIP_Aging_Table_xp);
					
					System.out.println(mTableDataUI.size());
					int RecordsSize=20;
					if(mTableDataUI.size()<=RecordsSize)
					{
						obj.repAddData( "Verifying Records are displayed on the page",  RecordsSize+ " records should be displayed on the page ", RecordsSize+  " records displayed on the page", "Pass");	
					}else
					{
						obj.repAddData( "Verifying Records are displayed on the page", RecordsSize+  " records should be displayed on the page ", RecordsSize+   " records not displayed on the page", "Fail");	
					}
					objGenericFunctionLibrary.ClickByXpath(SphereModules.WIP_Aging_Table_CC_xp,"Cost Center on WIP Aging",true);
					
					waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereModules.WIP_Transaction_Detail_Title_xp)));
					WebElement Title1 = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_Transaction_Detail_Title_xp));
					objGenericFunctionLibrary.HighlightElement(Title1);
					
					
					WebElement eleTable1 = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_TransactionDetail_Table_xp));
					List<WebElement> arrHeaderColumns1 = eleTable1.findElements(By.xpath("../thead/tr/th"));  //Get the header
					System.out.println("Rows Size>>>>"+arrHeaderColumns1.size());
					
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,0,"Deal");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,1,"Order");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,2,"Perf CC");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,3,"Mng CC");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,4,"Description");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,5,"Transaction Date");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,6,"PO Number");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,7,"Amount");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,8,"Source Code");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,9,"Origin");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,10,"Billable");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns1,11,"Status");
					
					HashMap<Integer, HashMap<Integer, String>> mTableDataUI1 = objGenericFunctionLibrary.fnGetTableData(SphereModules.WIP_TransactionDetail_Table_xp);
					
					System.out.println(mTableDataUI.size());
					
					if(mTableDataUI1.size()<=RecordsSize)
					{
						obj.repAddData( "Verifying Records are displayed on the page",  RecordsSize+ " records should be displayed on the page ", RecordsSize+  " records displayed on the page", "Pass");	
					}else
					{
						obj.repAddData( "Verifying Records are displayed on the page", RecordsSize+  " records should be displayed on the page ", RecordsSize+   " records not displayed on the page", "Fail");	
					}
					Thread.sleep(4000);
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Back_to_aging_xp,"Back to aging",true);
					Thread.sleep(3000);
					WebElement eleTotalTable = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_TransactionDetail_Total_Table_xp1));
					List<WebElement> arrHeaderColumns2= eleTotalTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
					System.out.println("Rows Size>>>>"+arrHeaderColumns2.size());
						
					if(arrHeaderColumns2.size()>=1)
					{
						objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns2,1,"Totals");
						
						 sTotal = TestDriver.driver.findElement(By.xpath(SphereModules.WIP_TransactionDetail_Total_Table_Amount_td_xp)).getText();
						obj.repAddData( "Verifying Total amount",  sTotal+ " amount is displayed on the page ", sTotal+  " amount displayed on the page", "Pass");
						System.out.println(sTotal);
					
					}else{
						obj.repAddData( "Verifying Total table amount", "Total table should displayed on the page ", " Total table is not displayed on the page", "Fail");
					}
					Thread.sleep(4000);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Back_to_Summary_xp,"Back to Summary",true);
					

			 } catch (Exception e) {
				 //obj.repAddData( "Select '"+sMatchValue+"'", "'"+sMatchValue+"' should be selected", "'"+sMatchValue+"' not selected", "Fail");
				 System.out.println("fnVerifyWIPforARCDraftandSuspense --------------Failed");    
				 TestDriver.log.error("fnVerifyWIPforARCDraftandSuspense failed",e);
			 }


		 }

		 public void fnSelectandapprove(String sTablePath, int iMatchCol, String sMatchValue) throws Exception
		 {

			 try
			 {
				 WebElement eleTable = TestDriver.driver.findElement(By.xpath(sTablePath));
				 List<WebElement> arrTableRows = eleTable.findElements(By.xpath(sTablePath));
				 int iColNum=8;
				 //List<WebElement> arrTableRows = eleTable.findElements(By.xpath("./tr"));
				 //Get the table data rows
				 System.out.println("Data Rows Size>>>>"+arrTableRows.size());
				 
				 for(int iRow=0;iRow<arrTableRows.size();iRow++)  //Exclude first header row 
				 {	
					 List<WebElement> arrTableColumns = arrTableRows.get(iRow).findElements(By.xpath("./td"));  //Get the table data rows
					 String sColValue = arrTableColumns.get(iMatchCol).getText();//.toString();
					 
					 //WebElement Ele=TestDriver.driver.findElement(By.xpath(sTablePath+"["+iRow+"]/td["+iColNum+"]"));
					
					 if(sColValue.equalsIgnoreCase(sMatchValue))
					 {
						 iRow=iRow+1;
						 WebElement Ele=TestDriver.driver.findElement(By.xpath(sTablePath+"["+iRow+"]/td["+iColNum+"]"));
						 Ele.click();
						 obj.repAddData( "Select '"+sMatchValue+"'", "'"+sMatchValue+"' should be selected", "'"+sMatchValue+"' selected successfully", "Pass");
					 }


				 }

			 } catch (Exception e) {
				 obj.repAddData( "Select '"+sMatchValue+"'", "'"+sMatchValue+"' should be selected", "'"+sMatchValue+"' not selected", "Fail");
				 System.out.println("fnSelectCheckBoxInTable --------------Failed");    
				 TestDriver.log.error("fnSelectCheckBoxInTable failed",e);
			 }

		 }


	public void fnSelectCostCenter(int iCostCenter,String sCostCenter) throws Exception
	{
		//String sCostCenter = String.valueOf(iCostCenter);
		try
		{/*
			 List<WebElement> lsCostCenters = TestDriver.driver.findElements(By.xpath(SphereModules.Users_AddUser_SelectCostCenters_xp));
			 //List<WebElement> lsCostCenters = TestDriver.driver.findElements(By.xpath(SphereModules.Deals_AddDeal_UseCostCenter_xp));
			  
			 lsCostCenters.get(iCostCenter).click(); //Select first cost center //li starts with blank and cost center 1, cost center 2 and so on 
			 
			 obj.repAddData( "Select Cost Center "+sCostCenter+"'", "Cost Center '"+sCostCenter+"' should be selected", "Cost Center '"+sCostCenter+"' selected successfully", "Pass");
*/
	            objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_AddEditModules_InputSearchCostCenter_xp, sCostCenter, "Search Cost Center");
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_InputSearchCostCenter_xp,  "Search Cost Center",true);
	            objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_ListSearchedCostCenter_xp, "Searched "+sCostCenter, true);
	            
		
		
		} catch (Exception e) {
			 obj.repAddData( "Select Cost Center "+sCostCenter+"'", "Cost Center '"+sCostCenter+"' should be selected", "Cost Center '"+sCostCenter+"' not selected", "Fail");
	   System.out.println("fnSelectCostCenter --------------Failed");    
	   TestDriver.log.error("fnSelectCostCenter failed",e);
	   }
		
	}
	
	public void fnSelectDeactivateChangeRoleOption(int iComboOption, String sOptionValue) throws Exception
	{
	
		try
		{
			 List<WebElement> lsComboOptions = TestDriver.driver.findElements(By.xpath(SphereModules.Users_ViewUser_ComboDeactivateChangeRole_xp));
			 lsComboOptions.get(iComboOption).click(); //Select first cost center //li starts with blank and cost center 1, cost center 2 and so on
			 obj.repAddData( "Select '"+sOptionValue+"'", "'"+sOptionValue+"' should be selected", "'"+sOptionValue+"' selected successfully", "Pass");
			
		} catch (Exception e) {
			obj.repAddData( "Select '"+sOptionValue+"'", "'"+sOptionValue+"' should be selected", "'"+sOptionValue+"' not selected", "Fail");
	   System.out.println("fnSelectDeactivateChangeRoleOption --------------Failed");    
	   TestDriver.log.error("fnSelectDeactivateChangeRoleOption failed",e);
	   }
		
	}
	
	public String fnAddUser(String sRoleUI, int iCostCenter, String sCostCenterUI) throws Exception
	{
		String sSSOIdUI ="";
		try
		{
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			sSSOIdUI = sRandom;
			String sFirstNameUI = "AutoFName"+sRandom;
			String sLastNameUI = "AutoLName"+sRandom;
			
			//objBusinessLib.fnClickMainMenuElement("Administration");
			fnClickSubMenuElement("Administration","Users");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewUserModule_Table_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Users_AddUser_LinkAddPlusSign_xp, "Add User Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
		     	
		    objGenericFunctionLibrary.SendKeyById(SphereModules.Users_AddUser_InputSSO_id, sSSOIdUI, "SSO Id");
		    objGenericFunctionLibrary.SendKeyById(SphereModules.Users_AddUser_InputFirstName_id, sFirstNameUI, "First Name");
		    objGenericFunctionLibrary.SendKeyById(SphereModules.Users_AddUser_InputLastName_id, sLastNameUI, "Last Name");
		    
		    objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Users_AddUser_ComboRole_xp, sRoleUI);
		    fnSelectCostCenter(iCostCenter, sCostCenterUI);
		    objGenericFunctionLibrary.ClickById(SphereModules.Users_AddUser_InputSSO_id, "SSO Id", true);
		    fnSelectPerformingCostCenter(iCostCenter, sCostCenterUI);
		    
		   // objGenericFunctionLibrary.ClickById(SphereModules.Users_AddUser_InputSSO_id, "SSO Id", true);
		    
		    WebElement ele = TestDriver.driver.findElement(By.xpath(SphereModules.Users_AddUser_BtnAdd_xp));
		    
		    TestDriver.log.info(TestDriver.driver.getPageSource().toString());
		    
		    if(TestDriver.driver.getPageSource().contains("Success! A new user has been created."))
		    {
		    	System.out.println("Before Add Found");
		    }
		    else
		    {
		    	System.out.println("Before Add Not Found");
		    }
		    
		   // objGenericFunctionLibrary.SendKeyById(SphereModules.Users_AddUser_InputSSO_id, sSSOIdUI, "SSO Id");
		    objGenericFunctionLibrary.ClickById(SphereModules.Users_AddUser_InputSSO_id, "SSO Id", false);
		    
		    objGenericFunctionLibrary.ClickByXpath(SphereModules.Users_AddUser_BtnAdd_xp, "Add Button", true);
		    Thread.sleep(8000);
		    TestDriver.log.info("--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------");
		    TestDriver.log.info(TestDriver.driver.getPageSource().toString());
		    if(TestDriver.driver.getPageSource().contains("Success! A new user has been created."))
		    {
		    	System.out.println("After Add Found");
		    }
		    else
		    {
		    	System.out.println("After Add Not Found");
		    }
		    //objGenericFunctionLibrary.fnLoadingPageWait();
		    
		    /*try {
				//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Users_AddUser_MsgSuccess_xp)));
		    	waitForTableLoad.until(ExpectedConditions.presenceOfElementLocated(By.xpath(SphereModules.Users_AddUser_MsgSuccess_xp)));
				String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Users_AddUser_MsgSuccess_xp)).getText();
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Users_AddUser_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Users_AddUser_Success_msg, sSuccessMsg.trim());
			} catch (Exception e) {
				// TODO Auto-generated catch block
				obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
				e.printStackTrace();
				//throw(e);
			}*/
		    objGenericFunctionLibrary.fnLoadingPageWait();
		    
		    String sQuery = objSQLConfig.sUsers_AddUser_Query;
		    sQuery = sQuery.replaceAll("sso_id_param",sRandom);
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sSSOIdDB = mTableDataDB.get(1).get(1).toString();
			String sFirstNameDB = mTableDataDB.get(1).get(2).toString();
			String sLastNameDB = mTableDataDB.get(1).get(3).toString();
			String sRoleDB = mTableDataDB.get(1).get(6).toString();
			String sCostCenterDB = mTableDataDB.get(1).get(7).toString();
			
			if(sSSOIdUI.equalsIgnoreCase(sSSOIdDB) && sFirstNameUI.equalsIgnoreCase(sFirstNameDB) && sLastNameUI.equalsIgnoreCase(sLastNameDB) && sRoleUI.equalsIgnoreCase(sRoleDB) && sCostCenterUI.equalsIgnoreCase(sCostCenterDB))
			{	
				obj.repAddData( "Compare user record for SSO Id : "+ sSSOIdUI, "User record on UI and DB should match for SSO Id : "+ sSSOIdUI, "Validation successful for SSO Id : "+ sSSOIdUI, "Pass");
			}
			else
			{
				obj.repAddData( "Compare user record for SSO Id : "+ sSSOIdUI, "User record on UI and DB should match for SSO Id : "+ sSSOIdUI, "Validation failed for SSO Id : "+ sSSOIdUI, "Fail");
			}
			
		} catch (Exception e) {
	   System.out.println("fnAddUser --------------Failed");    
	   TestDriver.log.error("fnAddUser failed",e);
	   }
		
		return sSSOIdUI;
		
	}
	
	public String fnAddNationalAccount() throws Exception
	{
		String sAccountNameUI ="";
		try
		{
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			sAccountNameUI = "AUTOTESTACCOUNTNAME_"+sRandom;
			String sEmailUI = "AutoEmail_"+sRandom+"@nbcuni.com";
			/*String sAddr1UI = "AutoAddr1_"+sRandom;
			String sAddr2UI = "AutoAddr2_"+sRandom;
			String sAddr3UI = "AutoAddr3_"+sRandom;
			String sCityUI = "AutoCity_"+sRandom;
			String sZipUI = sRandom;*/
			
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			//String sStateUI = "CA";
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
		
			
			//objBusinessLib.fnClickMainMenuElement("Administration");
			fnClickSubMenuElement("Customers Master","Parent Companies");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewNationalAccountModule_Table_xp)));
		    
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Customers_AddNationalAccount_LinkAddPlusSign_xp, "Add Parent Company Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Customers_AddNationalAccount_LabelTitle_msg, SphereModules.Customers_AddNationalAccount_LabelAddNationalAccountTitle_xp);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Customers_AddNationalAccount_InputName_id, sAccountNameUI, "Name");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Customers_AddNationalAccount_InputEmail_id, sEmailUI, "Email");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Customers_AddNationalAccount_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Customers_AddNationalAccount_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Customers_AddNationalAccount_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_AddNationalAccount_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_AddNationalAccount_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Customers_AddNationalAccount_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Customers_AddNationalAccount_InputZip_id, sZipUI, "Zip");  
			
		   			    
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Customers_AddNationalAccount_BtnAdd_xp, "Add Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
		    /*try {
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Customers_AddNationalAccount_MsgSuccess_xp)));
				String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Customers_AddNationalAccount_MsgSuccess_xp)).getText();
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Customers_AddNationalAccount_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Customers_AddNationalAccount_Success_msg, sSuccessMsg.trim());
				objGenericFunctionLibrary.fnLoadingPageWait();
			} catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
				obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
				//throw(e);
			}*/
		   
		    String sQuery = objSQLConfig.sCustomers_AddNationalAccount_Query;
		    sQuery = sQuery.replaceAll("account_name_param",sAccountNameUI);
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sAccountNameDB = mTableDataDB.get(1).get(1).toString().trim();
			String sEmailDB = mTableDataDB.get(1).get(2).toString().trim();
			String sAddr1DB = mTableDataDB.get(1).get(3).toString().trim();
			String sAddr2DB = mTableDataDB.get(1).get(4).toString().trim();
			String sAddr3DB = mTableDataDB.get(1).get(5).toString().trim();
			
			String sCityDB = mTableDataDB.get(1).get(6).toString().trim();
			String sStateDB = mTableDataDB.get(1).get(7).toString().trim();
			String sZipDB = mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			
			String sCustomerTypeDB = mTableDataDB.get(1).get(10).toString().trim();
			String sProductionTypeDB = mTableDataDB.get(1).get(11).toString().trim();
			
			if(sAccountNameUI.equalsIgnoreCase(sAccountNameDB) && sEmailUI.equalsIgnoreCase(sEmailDB) &&
					sAddr1UI.equalsIgnoreCase(sAddr1DB) && sAddr2UI.equalsIgnoreCase(sAddr2DB) &&
					sAddr3UI.equalsIgnoreCase(sAddr3DB) && sCityUI.equalsIgnoreCase(sCityDB) &&
					sStateUI.equalsIgnoreCase(sStateDB) && sZipUI.equalsIgnoreCase(sZipDB) && 
					sCountryUI.equalsIgnoreCase(sCountryDB) && sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
					sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB))
			{	
				obj.repAddData( "Compare national account record for account name : "+ sAccountNameUI, "National account record on UI and DB should match for account name : "+ sAccountNameUI, "Validation successful for account name : "+ sAccountNameUI, "Pass");
			}
			else
			{
				obj.repAddData( "Compare national account record for account name : "+ sAccountNameUI, "National account record on UI and DB should match for account name : "+ sAccountNameUI, "Validation failed for account name : "+ sAccountNameUI, "Fail");
			}
			
			
		} catch (Exception e) {
	   System.out.println("fnAddNationalAccount --------------Failed");    
	   TestDriver.log.error("fnAddNationalAccount failed",e);
	   }
		
		return sAccountNameUI;
		
	}
	
	
	public String fnAddCustomer(String sCustomerNameUI, String sOperation) throws Exception
	{
	
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));

            String sCustomerTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sCustomerTitleRandom);
			

			sCustomerNameUI = "AUTOTESTCUSTOMER_"+sCustomerTitleRandom;
			
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
			
				sCustomerNameUI = "AUTOTESTCUSTOMER_"+sCustomerTitleRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			//Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			
			Date dTomorrow = DateUtils.addDays(new Date(), +1);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");
			String sStartDateUI1 = sdf.format(dTomorrow);
			sdf.applyPattern("yyyy-MM-dd");
			String sStartDateUIDBpattern=sdf.format(dTomorrow);
		/*	Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);*/
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			//String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
		
			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, "2487678989", "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
			
			String sCreditLimitUI=sRandom+".00";
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
			}
			
			 if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
			    {
			    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    	 int iRow = 1; //for add 
					    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
						TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
						if(sOperation.equalsIgnoreCase("Duplicate"))
						{
							iRow = 1; //for duplicate, now checking descending, so no need to set it to 2
						}
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
						String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
						String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
						String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
						String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
						String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
						String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
						String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
						String sCreditExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
						
						String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
						
						String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
						String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
						String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
						String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
						String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
						String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
						String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
						String sMultEmailDB = mTableDataDB.get(iRow).get(17).toString().trim();
						String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(18).toString().trim();
						
						String sCustomerStatusDB = mTableDataDB.get(iRow).get(24).toString().trim();//isactive field in DB
						String sCustomerPhoneNumberDB = mTableDataDB.get(iRow).get(25).toString().trim();
						
						if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&                    
								sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) && 
								sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB)&&
								sStartDateUIDBpattern.equalsIgnoreCase(sStartDateDB) && 
								sCreditPermanentDB.equalsIgnoreCase("1") && 
								sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
								sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
							//sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB)
						{	
							//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
							TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sCountryDB+","+sZipDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
							//bw2.write("Test Case Id,Test Case Name,CustomerNumber,Name,CustomerStatus,Type,CustomerAddress1,CustomerAddress2,CustomerCity,CustomerState,CustomerZip,CustomerCountry,CustomerPhoneNo,CreditStatus,Through,Amount,DealNumber,Dealname,Dealtype,Address1,Address2,Status,City,State,Zip,Country,MainPhone,Status,CreditThrough,Certification,ValidThrough,TaxStatus,Department,PoNumber");
							//TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameUI+","+sCustomerStatusDB+","+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
							TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameDB+",,"+sCustomerStatusDB+","+sCustomerTypeDB+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
							obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
						}
						else
						{
							obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
						}
						
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && 
							sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
							//sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
							sCountryUI.equalsIgnoreCase(sCountryDB) && 
							sStateUI.equalsIgnoreCase(sStateDB) && 
							sCityUI.equalsIgnoreCase(sCityDB) && 
							sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
		} catch (Exception e) {
	   System.out.println("fnAddCustomer --------------Failed");    
	   TestDriver.log.error("fnAddCustomer failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	public String fnAddCustomerWithAltAddressSearch(String sCustomerNameUI, String sOperation, String sAltAddressLine1 ) throws Exception
	{ 
		
		
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerNameUI = "AutoTestCustomer_"+sRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			Date date = new Date();
			String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			//SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2= new SimpleDateFormat("yyyy-MM-dd").format(date);
			
			/*Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);*/
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			//String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			
			//String sSearchAltAddress = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim();
			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
			
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, "2487678989", "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			/////////////////Adding Customer Address Start//////////////////
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Customers_AltAddress_SearchBar_xp, sAltAddressLine1, "Alternate address seach");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Customers_Search_Alt_Address_First_Row_xp, "Selected Address", true);
			
			String sCreditLimitUI=sRandom+".00";
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			
		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&
						sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
						sTaxIdUI.equalsIgnoreCase(sTaxIDDB) &&
						sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) && 
						sStartDateUI2.equalsIgnoreCase(sStartDateDB) &&
						//sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB) &&
						sCreditPermanentDB.equalsIgnoreCase("1") && 
						sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
					
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && 
							sAddr2UI.equalsIgnoreCase(sAddr2DB) &&
							//sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
							sCountryUI.equalsIgnoreCase(sCountryDB) && 
							sStateUI.equalsIgnoreCase(sStateDB) && 
							sCityUI.equalsIgnoreCase(sCityDB) && 
							sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
		} catch (Exception e) {
	   System.out.println("fnAddCustomerWithAltAddressSearch --------------Failed");    
	   TestDriver.log.error("fnAddCustomerWithAltAddressSearch failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	
	public void fnVerifyDeactivatedRecord(String sSSOId) throws Exception
	{
	
		try
		{
			String sQuery = objSQLConfig.sUsers_DeactivateUser_Query;
		    sQuery = sQuery.replaceAll("sso_id_param",sSSOId);
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			System.out.println("Hello");
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sActive = mTableDataDB.get(1).get(1).toString();
			
			if(Integer.valueOf(sActive)==0)
			{
				obj.repAddData( "Verify deactivation for SSO Id : "+ sSSOId, "User should be deactivated for SSO Id : "+ sSSOId, "User deactivation successful for SSO Id : "+ sSSOId, "Pass");
			}
			else
			{
				obj.repAddData( "Verify deactivation for SSO Id : "+ sSSOId, "User should be deactivated for SSO Id : "+ sSSOId, "User deactivation failed for SSO Id : "+ sSSOId, "Fail");
			}
		} catch (Exception e) {
	   System.out.println("fnVerifyDeactivatedRecord --------------Failed");    
	   TestDriver.log.error("fnVerifyDeactivatedRecord failed",e);
	   }
		
	}
	
	public void fnSelectDynamicFilters(String sOption, String sValue, int i) throws Exception
	{
	
		try
		{
			if(i==2)
			{
				List<WebElement> lstDynamicFilterOptions = TestDriver.driver.findElements(By.xpath(SphereModules.CustomersMaster_ViewCustomer_ListDynamicFilters_xp));
				for (WebElement ele : lstDynamicFilterOptions) {
					if (ele.getText().trim().equalsIgnoreCase(sOption)) {
						Thread.sleep(500);
						objGenericFunctionLibrary.HighlightElement(ele);
						objGenericFunctionLibrary.ClickByElement(ele, sOption, true);
						Thread.sleep(2000);
						objGenericFunctionLibrary.fnLoadingPageWait();
						break;
					}
				}
			}
			
			List<WebElement> lstDynamicFilterValues = TestDriver.driver.findElements(By.xpath(SphereModules.CustomersMaster_ViewCustomer_ListDynamicFiltersContent_xp));
			for (WebElement eleData : lstDynamicFilterValues) {
				String sTempValue = eleData.findElement(By.xpath("./span[2]")).getText().trim();
				if (sTempValue.equalsIgnoreCase(sValue)) {
					WebElement eleCheckbox = eleData.findElement(By.xpath("./span[1]"));
					objGenericFunctionLibrary.HighlightElement(eleCheckbox);
					objGenericFunctionLibrary.ClickByElement(eleCheckbox, sValue+" Checkbox", true);
					Thread.sleep(2000);
					objGenericFunctionLibrary.fnLoadingPageWait();
					break;
				}
			}
			
		} catch (Exception e) {
	   System.out.println("fnSelectDynamicFilters --------------Failed");    
	   TestDriver.log.error("fnSelectDynamicFilters failed",e);
	   }
		
	}
	
	public void fnSelectInvoiceStatementFilters(String sOption, String sValue, int i,String sContentXpath) throws Exception
	{
	
		try
		{
			if(i==2)
			{
				List<WebElement> lstDynamicFilterOptions = TestDriver.driver.findElements(By.xpath(SphereModules.CustomersMaster_ViewCustomer_ListDynamicFilters_xp));
				for (WebElement ele : lstDynamicFilterOptions) {
					if (ele.getText().trim().equalsIgnoreCase(sOption)) {
						Thread.sleep(500);
						objGenericFunctionLibrary.HighlightElement(ele);
						objGenericFunctionLibrary.ClickByElement(ele, sOption, true);
						Thread.sleep(2000);
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.InvoiceStatement_Deal_SearchBar_Filter_xp, sValue, "Deal");
		 				Thread.sleep(3000);
						
						objGenericFunctionLibrary.fnLoadingPageWait();
						break;
					}
				}
			}
			
			List<WebElement> lstDynamicFilterValues = TestDriver.driver.findElements(By.xpath(sContentXpath));
			for (WebElement eleData : lstDynamicFilterValues) {
				String sTempValue = eleData.findElement(By.xpath("./span[2]")).getText().trim();
				if (sTempValue.contains(sValue)) {
					WebElement eleCheckbox = eleData.findElement(By.xpath("./span[1]"));
					objGenericFunctionLibrary.HighlightElement(eleCheckbox);
					objGenericFunctionLibrary.ClickByElement(eleCheckbox, sValue+" Checkbox", true);
					Thread.sleep(2000);
					objGenericFunctionLibrary.fnLoadingPageWait();
					break;
				}
			}
			
		} catch (Exception e) {
	   System.out.println("fnSelectInvoiceStatementFilters --------------Failed");    
	   TestDriver.log.error("fnSelectInvoiceStatementFilters failed",e);
	   }
		
	}
	
	
	@SuppressWarnings("static-access")
	public void fnVerifyViewMenuOption(String sMainOptionText, String sSubOptionText) throws Exception {
		 
		 WebElement eleMain = null;
		 WebElement eleSub = null;
		 boolean bMenuFlag = false;
		 boolean bSubMenuFlag = false;
		 
		    try {
		    	
		    	
		    	List<WebElement> eleNavList = TestDriver.driver.findElements(By.xpath(objSphereCommon.Main_HomeNavigationLinks_xp));
				Integer iNavListSize = eleNavList.size();
		    		for(int i=0;i<iNavListSize; i++)
					{
		    			eleMain = eleNavList.get(i).findElement(By.xpath("./div/span[2]"));
		    			String sMainMenuOption = eleMain.getText();
		    			if(sMainMenuOption.equalsIgnoreCase(sMainOptionText))
		    			{	
		    				bMenuFlag = true;
		    				objGenericFunctionLibrary.ClickByElement(eleMain, sMainOptionText, true);
		    				
		    				List<WebElement> eleSubNavList = eleNavList.get(i).findElements(By.xpath("./ul/li"));
							Integer iSubNavListSize = eleSubNavList.size();
							for(int j=0;j<iSubNavListSize; j++)
							{
								eleSub = eleSubNavList.get(j).findElement(By.xpath("./div/span[2]"));
								String sSubMenuOption = eleSub.getText();
								if(sSubMenuOption.equalsIgnoreCase(sSubOptionText))
								{
									bSubMenuFlag = true;
									TestDriver.log.info(sSubMenuOption+" sub menu found - test failed");
									/*objGenericFunctionLibrary.ClickByElement(eleSub, sSubOptionText, true);
									break;*/
								}
							}
							break;
		    			}
		    			//objGenericFunctionLibrary.HighlightElement(eleNavList.get(i).findElement(By.xpath("./div/span[2]")));
					}
		    		if(!sMainOptionText.equalsIgnoreCase("") && sSubOptionText.equalsIgnoreCase(""))
		    		{
		    			if(bMenuFlag == true)
		    			{
		    				obj.repAddData( "Verify : "+ sMainOptionText, sMainOptionText + " should not be displayed in menu option.", sMainOptionText + " displayed in menu option.", "Fail");
		    			}
		    			else
		    			{
		    				obj.repAddData( "Verify : "+ sMainOptionText, sMainOptionText + " should not be displayed in menu option.", sMainOptionText + " not displayed in menu option.", "Pass");
		    			}
		    		}
		    		
		    		if(!sMainOptionText.equalsIgnoreCase("") && !sSubOptionText.equalsIgnoreCase(""))
		    		{
		    			if(bSubMenuFlag == true)
		    			{
		    				obj.repAddData( "Verify : "+ sSubOptionText, sSubOptionText + " should not be displayed in menu option.", sSubOptionText + " displayed in menu option.", "Fail");
		    			}
		    			else
		    			{
		    				obj.repAddData( "Verify : "+ sSubOptionText, sSubOptionText + " should not be displayed in menu option.", sSubOptionText + " not displayed in menu option.", "Pass");
		    			}
		    		}
		    		

		    	
		    } catch (Exception e) {
		    	 System.out.println("fnClickSubMenuElement --------------Failed");    
				    TestDriver.log.error("fnClickSubMenuElement failed",e);
		    }
		}
	
	@SuppressWarnings("static-access")
	public void fnCheckSubMenudisplay(String sMainOptionText, String sSubOptionText) throws Exception {
		 
		 WebElement eleMain = null;
		 WebElement eleSub = null;
		    try {
		    	
		    	
		    	List<WebElement> eleNavList = TestDriver.driver.findElements(By.xpath(objSphereCommon.Main_HomeNavigationLinks_xp));
				Integer iNavListSize = eleNavList.size();
		    		for(int i=0;i<iNavListSize; i++)
					{
		    			eleMain = eleNavList.get(i).findElement(By.xpath("./div/span[2]"));
		    			String sMainMenuOption = eleMain.getText();
		    			if(sMainMenuOption.equalsIgnoreCase(sMainOptionText))
		    			{
		    				objGenericFunctionLibrary.ClickByElement(eleMain, sMainOptionText, true);
		    				
		    				List<WebElement> eleSubNavList = eleNavList.get(i).findElements(By.xpath("./ul/li"));
							Integer iSubNavListSize = eleSubNavList.size();
							for(int j=0;j<iSubNavListSize; j++)
							{
								eleSub = eleSubNavList.get(j).findElement(By.xpath("./div/span[2]"));
								String sSubMenuOption = eleSub.getText();
								if(sSubMenuOption.equalsIgnoreCase(sSubOptionText))
								{
									objGenericFunctionLibrary.ClickByElement(eleSub, sSubOptionText, true);
									Thread.sleep(4000);
									break;
								}
							}
							break;
		    			}
		    			//objGenericFunctionLibrary.HighlightElement(eleNavList.get(i).findElement(By.xpath("./div/span[2]")));
					}
		    		
		    		objGenericFunctionLibrary.fnLoadingPageWait();
		    	
		    } catch (Exception e) {
		    	 System.out.println("fnClickSubMenuElement --------------Failed");    
				    TestDriver.log.error("fnClickSubMenuElement failed",e);
		    }
		}

	
	
	@SuppressWarnings("unused")
//	public void fnUpdateRole(String sParentModule, String sChildModule, String sOperation, String sStatus) throws Exception
	public void fnUpdateRole(String sParentModule, String sChildModule, String sOperation, String sStatus, String sRoleName) throws Exception
	{
		
		try
		{
			fnClickSubMenuElement("Administration","Roles");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);  //Enable after testing
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Roles_ViewRole_DivFirstRole_xp)));
		    
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, "Automation Role", "Search box");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sRoleName, "Search box");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, "Another Test Role", "Search box");
			

			//objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath("Automation Role", SphereModules.Roles_ViewRole_TextFirstRole_xp);			
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(sRoleName, SphereModules.Roles_ViewRole_TextFirstRole_xp);
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Roles_ViewRole_PlusSignFirstRole_xp, "Automation Role Link", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Roles_ViewRole_PlusSignFirstRole_xp, sRoleName+" Link", true);
			List<WebElement> lstRolesTable = TestDriver.driver.findElements(By.xpath(SphereModules.Roles_ViewRole_TableRoles_xp));

			List<WebElement> lstDivHeader = new ArrayList<WebElement>();
			List<WebElement> lstDivData = new ArrayList<WebElement>();
			List<WebElement> lstChildData = new ArrayList<WebElement>();
			String sName = "";
			String sViewFlag = "";
			String sCreateFlag = "";
			String sEditFlag = "";
			String sDeactivateFlag = "";
			
			String sCheckBox = "";
			String sCheckBoxAttribute = "";
			boolean bSaveRequired = false;
			
			int iOpertaion = 0;
			
			switch (sOperation) {
            case "View":  iOpertaion = 1;
                     break;
            case "Create":  iOpertaion = 2;
                     break;
            case "Edit":  iOpertaion = 3;
                     break;
            case "Deactivate":  iOpertaion = 4;
            		 break;
            
            default: iOpertaion = 0;
                     break;
			}
			
			for (int i=0; i<lstRolesTable.size();i++) 
			{
				if(i==0)
				{
					lstDivHeader = lstRolesTable.get(i).findElements(By.xpath("./div"));
				}
				else
				{
					lstDivData = lstRolesTable.get(i).findElements(By.xpath("./div"));
					for(int j=0;j<lstDivData.size();j++)
					{
						List<WebElement> lstActualData = new ArrayList<WebElement>();
						if(lstDivData.get(j).getAttribute("class").toString().contains("row"))
						{
							lstActualData  = lstDivData.get(j).findElements(By.xpath("./div"));
							sName = lstActualData.get(0).getText().trim();
							if(sName.contains(sParentModule) && !sParentModule.equalsIgnoreCase(""))
							{
								
								for(int x=1;x<lstActualData.size();x++)
								{
									sCheckBox = "";
									sCheckBoxAttribute = lstActualData.get(x).findElement(By.xpath("./input")).getAttribute("class");
									
									if(sStatus.equalsIgnoreCase("Off"))
									{
										if(sCheckBoxAttribute.contains("ng-empty") && sChildModule.equalsIgnoreCase("") && x==iOpertaion)
										{
											TestDriver.log.info(sOperation +" checkbox for "+sName + " already unchecked");
											break;
										}
										else if(sCheckBoxAttribute.contains("ng-not-empty") && sChildModule.equalsIgnoreCase("") && x==iOpertaion)
										{
											objGenericFunctionLibrary.ClickByElement(lstActualData.get(iOpertaion).findElement(By.xpath("./input")), sName, true);
											bSaveRequired = true;
											break;
										}
										else if(sCheckBoxAttribute.contains("ng-empty") && !sChildModule.equalsIgnoreCase("") && x==iOpertaion) //Parent need to be checked to edit child attributes
										{
											objGenericFunctionLibrary.ClickByElement(lstActualData.get(iOpertaion).findElement(By.xpath("./input")), sName, true);
											bSaveRequired = true;
											break;
										}
									}
									else
									{
										if(sCheckBoxAttribute.contains("ng-not-empty") && x==iOpertaion)
										{
											TestDriver.log.info(sOperation +" checkbox for "+sName + " already checked");
											break;
										}
										else 
										{
											objGenericFunctionLibrary.ClickByElement(lstActualData.get(iOpertaion).findElement(By.xpath("./input")), sName, true);
											bSaveRequired = true;
											break;
										}
										
									}
									
									
									/*if(sCheckBoxAttribute.contains("dirty"))
									{
										sCheckBox = "N";
									}
									else
									{
										sCheckBox = "Y";
									}
									if(x==1)
									{
										sViewFlag = sCheckBox;
									}
									else if(x==2)
									{
										sCreateFlag = sCheckBox;
									}
									else if(x==3)
									{
										sEditFlag = sCheckBox;
									}
									else if(x==4)
									{
										sDeactivateFlag = sCheckBox;
									}*/
								}  //End of For
							} //End of If
							
							System.out.println(sName+">"+ sViewFlag+sCreateFlag+sEditFlag+sDeactivateFlag);
							
						}
						else
						{
							for (WebElement ele : lstDivData.get(j).findElements(By.xpath("./div/div")))
							{
								lstChildData = ele.findElements(By.xpath("./div"));
								for(int iChild=0; iChild<lstChildData.size();iChild++)
								{
									sName = lstChildData.get(0).getText().trim();
									if(sName.equalsIgnoreCase(sChildModule) && !sChildModule.equalsIgnoreCase(""))
									{	
										for(int x=1;x<lstChildData.size();x++)
										{
											sCheckBox = "";
											sCheckBoxAttribute = lstChildData.get(x).findElement(By.xpath("./input")).getAttribute("class");
											
											if(sStatus.equalsIgnoreCase("Off"))
											{
												if(sCheckBoxAttribute.contains("ng-empty") && x==iOpertaion)
												{
													TestDriver.log.info(sOperation +"checkbox for "+sName + " already unchecked");
													break;
												}
												else if(sCheckBoxAttribute.contains("ng-not-empty") && x==iOpertaion)
												{
													objGenericFunctionLibrary.ClickByElement(lstChildData.get(iOpertaion).findElement(By.xpath("./input")), sName, true);
													bSaveRequired = true;
													break;
												}
											}
											else
											{
												if(sCheckBoxAttribute.contains("ng-not-empty") && x==iOpertaion)
												{
													TestDriver.log.info(sOperation +"checkbox for "+sName + " already checked");
													break;
												}
												else
												{
													objGenericFunctionLibrary.ClickByElement(lstChildData.get(iOpertaion).findElement(By.xpath("./input")), sName, true);
													bSaveRequired = true;
													break;
												}
											}
											
	
											
											/*	if(sCheckBoxAttribute.contains("ng-empty"))
											{
												sCheckBox = "N";
											}
											else
											{
												sCheckBox = "Y";
											}
											if(x==1)
											{
												sViewFlag = sCheckBox;
											}
											else if(x==2)
											{
												sCreateFlag = sCheckBox;
											}
											else if(x==3)
											{
												sEditFlag = sCheckBox;
											}
											else if(x==4)
											{
												sDeactivateFlag = sCheckBox;
											}*/
										} //End of For
									} //End of If
									
								}
								
								System.out.println(sName+">"+ sViewFlag+sCreateFlag+sEditFlag+sDeactivateFlag);
							}
						}
					}
				}
			}
			
			if(bSaveRequired == true)
			{
				TestDriver.log.info("Roles changed, Save required");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Roles_EditRole_BtnSave_xp, "Save button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				/*waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Roles_EditRole_MsgSuccess_xp)));
			    String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Roles_EditRole_MsgSuccess_xp)).getText();
			    objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Roles_EditRole_MsgSuccess_xp);
			    System.out.println(sSuccessMsg);
			    objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Roles_EditRole_Success_msg, sSuccessMsg.trim());*/
			}
			else
			{
				TestDriver.log.info("Roles not changed, Save not required");
			}

			fnClickSubMenuElement("Dashboard","");
		    
		} catch (Exception e) {
	
	   System.out.println("fnUpdateRole --------------Failed");    
	   TestDriver.log.error("fnUpdateRole failed",e);
	   }
		
	}
	
	
	public void fnVerifyCustSearchFilterData(String sTableXPath, String sSearchText, String sTextToBeVerified, int iVerifyColLoc) throws Exception
	{
		
		try
		{
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sSearchText , "Search Box");
			objGenericFunctionLibrary.fnLoadingPageWait();
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
			Thread.sleep(4000);
			HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(sTableXPath);
			boolean bResultFlag = false;
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				String sName = mTableDataUI.get(i).get(iVerifyColLoc).toString().trim();
				//if(sName.equalsIgnoreCase(sTextToBeVerified))
				//if(sName.equalsIgnoreCase(sTextToBeVerified)||
				//sName.toUpperCase().contains(sTextToBeVerified.toUpperCase()))
				if(sName.contains(sTextToBeVerified))
				{
					bResultFlag = true;
					obj.repAddData( "Verify record after applying search criteria", "Records for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " successfully displayed on the screen", "Pass");
					break;
				}
				
				//System.out.println(mTableDataUI.get(i).get(2));
				//System.out.println(mTableDataUI.get(i).get(3));
			}
			
			if(bResultFlag == false)
			{
				obj.repAddData( "Verify record after applying search criteria", "Record for "+sTextToBeVerified+ " should be displayed on the screen", "Record for "+sTextToBeVerified+ " not displayed on the screen", "Fail");
			}
			
		} catch (Exception e) {
			
	   System.out.println("fnVerifyCustSearchFilterData --------------Failed");    
	   TestDriver.log.error("fnVerifyCustSearchFilterData failed",e);
	   }
		
	}
	
	public String fnAddCustomerMultiAddressesContacts(String sCustomerNameUI, String sOperation, boolean bMultiContact, int iContactCount, boolean bMultiAddress, int iAddressCount) throws Exception
	{
		
		String sCreditLimitUI=null;
		try
		{
			
			HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			HashMap<Integer, HashMap<Integer, String>> mAltAddressDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			Date date = new Date();
			
			String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			
			Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			String sPhoneUI="7349977788";

			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			if(TestDriver.sProfileName.equalsIgnoreCase("Biller")){
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, "Tax Id");
			}
                         else
			{
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
			}
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_xp,sParentCompanyUI);
			
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			
			TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sPhoneUI, "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		   
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			
			if(bMultiContact==true)
			{
				//HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				for(int i=1;i<=iContactCount;i++)
				{
					//String sContactPhone = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sContactPhone ="7346788899";
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle_"+i, "Title");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "Automail"+sContactFax+"@nbcuni.com", "Email");
					//Below two not implemented yet
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxMainContact_xp,"Main Contact Checkbox",true);
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxRecInvoice_xp,"Receive Invoice Checkbox",true);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////

					mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
					mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
					mContactDataUI.get(i).put(3,"AutoTitle_"+i);
					mContactDataUI.get(i).put(4,sContactPhone);
					mContactDataUI.get(i).put(5,"AutoEmail"+sContactFax+"@nbcuni.com");
					
					////////////////////////////////////////////////////////////////////////////////////////
				}
				
			}
			
			String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
			String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
			String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
			String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
			String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
			
			String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
			
			if(bMultiAddress==true)
			{		
				for(int i=1;i<=iAddressCount;i++)
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc_"+i, "Alternate Address Description");
				
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAltAddr1UI, "Alternate Address Line 1");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAltAddr2UI+" "+i+"00", "Alternate Address Line 2");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAltAddr3UI+" "+i+"00", "Alternate Address Line 3");
					
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sAltCountryUI);
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sAltStateUI);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sAltCityUI, "Alt City");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sAltZipUI, "Alt Zip");
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////
					
					mAltAddressDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mAltAddressDataUI.get(i).put(1,"AUTOALTADDRDESC_"+i);
					mAltAddressDataUI.get(i).put(2,sAltAddr1UI.toUpperCase());
					mAltAddressDataUI.get(i).put(3,sAltAddr2UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(4,sAltAddr3UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(5,sAltCountryUI.toUpperCase());
					mAltAddressDataUI.get(i).put(6,sAltStateUI.toUpperCase());
					mAltAddressDataUI.get(i).put(7,sAltCityUI.toUpperCase());
					mAltAddressDataUI.get(i).put(8,sAltZipUI.toUpperCase());
					////////////////////////////////////////////////////////////////////////////////////////
					
				}
			}
			
			/////////////////Adding Customer Address End//////////////////
			
			//Add group code here
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			if(TestDriver.sProfileName.equalsIgnoreCase("Department_Biller")){
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button");
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerNo_id,"No radio button");
				//objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomerMaster_Customer_CreditExpiration_id,"Credit Expiration");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_EditCustomer_ButtonCreditLimit_xp, "Credit Limit Button", true);
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id,"Credit Limit");
			}else
			{
			 sCreditLimitUI=sRandom+".00";
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			
			}
			
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				//objGenericFunctionLibrary.fnLoadingPageWait();
				
			
			}
			
			objGenericFunctionLibrary.fnLoadingPageWait();
		    
		    

		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sCreditExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
					
					String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
					String sMultEmailDB = mTableDataDB.get(iRow).get(17).toString().trim();
					String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(18).toString().trim();
					
					String sCustomerStatusDB = mTableDataDB.get(iRow).get(24).toString().trim();//isactive field in DB
					String sCustomerPhoneNumberDB = mTableDataDB.get(iRow).get(25).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&
							sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
							sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
							sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) && 
							sStartDateUI2.equalsIgnoreCase(sStartDateDB) && 
							sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB) && 
							sCreditPermanentDB.equalsIgnoreCase("1") && 
							sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
						TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sCountryDB+","+sZipDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
						TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameDB+",,"+sCustomerStatusDB+","+sCustomerTypeDB+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) &&
							sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
							sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
							sCountryUI.equalsIgnoreCase(sCountryDB) && 
							sStateUI.equalsIgnoreCase(sStateDB) && 
							sCityUI.equalsIgnoreCase(sCityDB) &&
							sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		    
		    ///////////////////////////////////////Verifying Contacts Start//////////////////////////////////////////////////////
		    if(bMultiContact==true)
		    {
		    String sQuery = objSQLConfig.sMasterCustomers_MultiContacts_Query;
		    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
		    fnVerifyMultiContactsAddresses(sQuery,mContactDataUI,"Contacts");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mContactTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
		    }
			/////////////////////////////////////Verifying Contacts End//////////////////////////////////////////////////////
			
			
			///////////////////////////////////////Verifying Alternate Addresses Start//////////////////////////////////////////////////////
		    if(bMultiAddress==true)
		    {
			String sQuery = objSQLConfig.sMasterCustomers_MultiAddresses_Query;
			sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			fnVerifyMultiContactsAddresses(sQuery,mAltAddressDataUI,"Alternate Addresses");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mAltAddressTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
		    }
			/////////////////////////////////////Verifying Alternate Addresses End//////////////////////////////////////////////////////
		
		} catch (Exception e) {
	   System.out.println("fnAddCustomer --------------Failed");    
	   TestDriver.log.error("fnAddCustomer failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	
	public String fnAddCustomerSSPLogin(String sCustomerNameUI) throws Exception
	{
		
		String sCreditLimitUI=null;
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			
			sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			Date date = new Date();
			String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			
			Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			String sPhoneUI="7349977788";

			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			if(TestDriver.sProfileName.equalsIgnoreCase("Biller")){
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, "Tax Id");
			}
              else
			{
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
			}
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_xp,sParentCompanyUI);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sPhoneUI, "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		   
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			String sContactPhone ="7346788899";
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoFirstName", "First Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoLastName", "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle", "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "automail"+sRandom+"@email.com", "Email");
					
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			if(TestDriver.sProfileName.equalsIgnoreCase("Department_Biller")){
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button");
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerNo_id,"No radio button");
				//objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomerMaster_Customer_CreditExpiration_id,"Credit Expiration");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_EditCustomer_ButtonCreditLimit_xp, "Credit Limit Button", true);
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id,"Credit Limit");
			}else
			{
			 sCreditLimitUI=sRandom+".00";
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			
			}
			
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
		   
		    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sParentCompanyDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sAddr1DB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sMultEmailDB = mTableDataDB.get(iRow).get(16).toString().trim();
					String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(17).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) && 
							sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB))
							/*&& 
							sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
							sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) && 
							sStartDateUI2.equalsIgnoreCase(sStartDateDB) &&
							sCreditPermanentDB.equalsIgnoreCase("1") && 
							sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))*/
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
				/*	if(sAddr1UI.equalsIgnoreCase(sAddr1DB) &&
							sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
							sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
							sCountryUI.equalsIgnoreCase(sCountryDB) && 
							sStateUI.equalsIgnoreCase(sStateDB) && 
							sCityUI.equalsIgnoreCase(sCityDB) &&
							sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    */
		    		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		    
		   
		} catch (Exception e) {
	   System.out.println("fnAddCustomerSSPLogin --------------Failed");    
	   TestDriver.log.error("fnAddCustomerSSPLogin failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	
	public String fnAddCustomerWithContactToLoginSspPortal() throws Exception
	{
		String sCustomerNameUI ="";
		String sCreditLimitUI=null;
		String Email="";
		try
		{
			HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			sCustomerNameUI ="AUTOTESTCUSTOMER_"+sRandom;
		    Email="automail"+sRandom+"@email.com";
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			Date date = new Date();
			String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			
			Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);
				
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			String sPhoneUI="7349977788";

			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_xp,sParentCompanyUI);
			
		
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			
			TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp,sRandom+sRandom, "Phone Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sPhoneUI, "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
		    objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			
					
					String sContactPhone ="7346788899";
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle", "Title");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
				   
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp,Email, "Email");
					
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////
			
			       //Add group code here
			       objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			       objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
			       objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			       objGenericFunctionLibrary.fnLoadingPageWait();
			       sCreditLimitUI=sRandom+".00";
			       objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
			       //objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
			       objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			
			      objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				//objGenericFunctionLibrary.fnLoadingPageWait();
			
			      objGenericFunctionLibrary.fnLoadingPageWait();
		    
		           String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	    int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sParentCompanyDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sAddr1DB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sMultEmailDB = mTableDataDB.get(iRow).get(16).toString().trim();
					String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(17).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) && 
						sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) && 
						sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
						sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) &&
						sStartDateUI2.equalsIgnoreCase(sStartDateDB) && 
						sCreditPermanentDB.equalsIgnoreCase("1") && 
						sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) &&
							sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
							sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
							sCountryUI.equalsIgnoreCase(sCountryDB) && 
							sStateUI.equalsIgnoreCase(sStateDB) &&
							sCityUI.equalsIgnoreCase(sCityDB) &&
							sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    
		    
				
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		   
		    
			/////////////////////////////////////Verifying Contacts End//////////////////////////////////////////////////////
		    WebDriverWait wait = new WebDriverWait(TestDriver.driver,35);
			obj.repAddData( "Sign In to the application - Pre Condition","", "", "");
			
			String sAppLink="http://qa.studioopsportal.inbcu.com:8080/";
			TestDriver.driver.navigate().to(sAppLink);
			//wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereCommon.Main_HomePageLogo_xp)));
			wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.SelfServicePortal_Title)));
			
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_Login_Email,Email,"Email");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_Login_Password,"text","Password");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Ssp_Requests_User_Login_RequestAccess_Btn, "Request Access",true);
			
			//wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.SelfServicePortal_Title)));
			
			///////////////Request Access Page///////////////////
			//wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.SelfServicePortal_RequestAccess_Title_xp)));
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.SelfServicePortal_RequestAccess_Title_xp);
			
			String FirstName="FirstName";
			String LastName="LastName";
			String Title="Title";
			
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_RequestAccess_Login_Email,Email,"Email");
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_RequestAccess_Password,"test","Password");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_RequestAccess_Confirm_Password,"test","Confirm Password");
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_RequestAccess_Login_FirstName,FirstName,"FirstName");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_RequestAccess_Login_LastName,LastName,"LastName");
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Ssp_Requests_User_RequestAccess_Login_Title,Title,"Title");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Ssp_Requests_User_RequestAccess_Login_Continue,"Continue",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			/////////////////Customer Submit Started////////////////////////
			//wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.SelfServicePortal_RequestAccess_Title_xp)));
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.SelfServicePortal_Customer_Search_Box_xp,sCustomerNameUI,"Search box");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.SelfServicePortal_Customer_List,"CustomerName",true);
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.SelfServicePortal_Customer_Submit,"Submit",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.SelfServicePortal_ReasonForRequest,"Test Reason","Reason For Request");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.SelfServicePortal_Customer_Submit,"Submit",true);
			
			obj.repAddData( "Sign In to QA Server","", "", "");
			
			//Email="test44@email.com";
			//String FirstName="test1";
			//String LastName="test2";
		    //sCustomerNameUI="AUTOTESTCUSTOMER_84167";
			
		    TestDriver.driver.navigate().to("http://qa.sphere.inbcu.com:8080/index.html#/ssprequests");
			//objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Ssp_Requests_Title);
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Ssp_Requests_All_xp, "All Link", true);
			Thread.sleep(4000);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, Email, "Search Box");
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(3000);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Ssp_Requests_User_Approve_Btn_xp,"Approve",true,true);
			Thread.sleep(3000);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Ssp_Requests_User_Deny_xp,"Deny",true,true);
			Thread.sleep(3000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Ssp_Requests_User_Approve_Btn_xp,"Approve",true);
			Thread.sleep(3000);
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Ssp_Requests_Approve_PopUp_Title_xp);
			
			String sApproveConfirmText= TestDriver.driver.findElement(By.xpath(SphereModules.Ssp_Requests_Approve_PopUp_Text_xp)).getText().trim();			
			String ExpText="You are about to grant '"+FirstName+" "+LastName+"' access to " +sCustomerNameUI+". Are you sure that you want to do this?";
			
			objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpText, sApproveConfirmText.trim());
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Ssp_Requests_Approve_PopUp_No_Btn_xp,"No",true);
			Thread.sleep(3000);
		    
			if(TestDriver.driver.findElement(By.xpath(SphereModules.Ssp_Requests_User_Approve_Btn_xp)).getText().trim().equals("Approve"))
		    {
		    	obj.repAddData( "Verify Approve button text after clicking No", "Approve button should display text as Approve", "Approve button text displayed as Approve", "Pass");	
		    }
			else
		    {
		    	obj.repAddData( "Verify Approve button text after clicking No", "Approve button should display text as Approve", "Approve button text not displayed as Approve", "Fail");
		    }
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Ssp_Requests_User_Approve_xp,"Approve",true);
			Thread.sleep(3000);
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Ssp_Requests_Approve_PopUp_Title_xp);
		   
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Ssp_Requests_Approve_PopUp_Yes_Btn_xp,"Yes",true);
			Thread.sleep(3000);
			
			if(TestDriver.driver.findElement(By.xpath(SphereModules.Ssp_Requests_User_Approve_xp)).getText().trim().equals("Approved"))
			{
		    	obj.repAddData( "Verify Approve column text after clicking Yes", "Approve column should display text as Approved", "Approve column text displayed as Approved", "Pass");	
		    }
			else
		    {
		    	obj.repAddData( "Verify Approve column text after clicking Yes", "Approve column should display text as Approved", "Approve column text not displayed as Approved", "Fail");
		    }
	
			if(TestDriver.driver.findElement(By.xpath(SphereModules.Ssp_Requests_User_Deny_xp)).getText().trim().equals(""))
			{	
				obj.repAddData( "Verify Deny Column text after clicking Yes", "Deny column should be empty", "Deny column text is displayed empty", "Pass");	
		    }
			else
		    {
		    	obj.repAddData( "Verify Deny Column text after clicking Yes", "Deny column should be empty", "Deny column text not displayed empty", "Fail");
		    }
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp," ", "Search Box");
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(3000);
						
		}catch (Exception e)
	   
		{
			System.out.println("fnAddCustomerWithContactToLoginSspPortal --------------Failed");    
	        TestDriver.log.error("fnAddCustomerWithContactToLoginSspPortal failed",e);
	    }
		
		return Email;
		
		
	}
	
	
	public String fnAddCustomerMultiAddressesContactsDeptAdminBiller(String sCustomerNameUI, String sOperation, boolean bMultiContact, int iContactCount, boolean bMultiAddress, int iAddressCount) throws Exception
	{
		//sCustomerNameUI ="";
		String sCreditLimitUI=null;
		try
		{
			
			HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			HashMap<Integer, HashMap<Integer, String>> mAltAddressDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
			String sLegalEntityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Legal_Entity").trim();
			
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			
			String sPhoneUI="7349977788";
	
			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_xp,sParentCompanyUI);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sPhoneUI, "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			//Below line is temporary 
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,"ARUBA");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			//Support Multiple Addresses is by default feature now
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
			
			if(bMultiContact==true)
			{
				//HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				for(int i=1;i<=iContactCount;i++)
				{
					//String sContactPhone = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sContactPhone ="7346788899";
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle_"+i, "Title");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
					//Fax number depreciated
					//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFax_xp, sContactFax, "Fax");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email");
					//Below two not implemented yet
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxMainContact_xp,"Main Contact Checkbox",true);
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxRecInvoice_xp,"Receive Invoice Checkbox",true);
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////
					mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
					mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
					mContactDataUI.get(i).put(3,"AutoTitle_"+i);
					mContactDataUI.get(i).put(4,sContactPhone);
					mContactDataUI.get(i).put(5,"AutoEmail"+sContactFax+"@nbcuni.com");
					////////////////////////////////////////////////////////////////////////////////////////
				}
				
			}
			String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
			String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
			String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
			String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
			String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
			
			String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
			
			if(bMultiAddress==true)
			{		
				for(int i=1;i<=iAddressCount;i++)
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc_"+i, "Alternate Address Description");
					
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAltAddr1UI, "Alternate Address Line 1");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAltAddr2UI+" "+i+"00", "Alternate Address Line 2");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAltAddr3UI+" "+i+"00", "Alternate Address Line 3");
					
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sAltCountryUI);
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sAltStateUI);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sAltCityUI, "Alt City");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sAltZipUI, "Alt Zip");
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////
					
					mAltAddressDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mAltAddressDataUI.get(i).put(1,"AUTOALTADDRDESC_"+i);
					mAltAddressDataUI.get(i).put(2,sAltAddr1UI.toUpperCase());
					mAltAddressDataUI.get(i).put(3,sAltAddr2UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(4,sAltAddr3UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(5,sAltCountryUI.toUpperCase());
					mAltAddressDataUI.get(i).put(6,sAltStateUI.toUpperCase());
					mAltAddressDataUI.get(i).put(7,sAltCityUI.toUpperCase());
					mAltAddressDataUI.get(i).put(8,sAltZipUI.toUpperCase());
					////////////////////////////////////////////////////////////////////////////////////////
				}
			}
			/////////////////Adding Customer Address End//////////////////
			//Add group code here
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.fnCheckEnableByXPath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
			}
			/*objGenericFunctionLibrary.fnCloseOpenedForm();
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sCustomerNameUI , "Search Box");
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				if(TestDriver.driver.findElements(By.xpath(SphereModules.Customers_Name_xp)).size()>0==true)
				{
					obj.repAddData( "Verify customer record on customers page", "Customer record on UI should be displayed", "Customer record is displayed", "Pass");
				}else
				{
					obj.repAddData( "Verify customer record on customers page", "Customer record on UI should be displayed", "Customer record is not displayed", "Fail");
				}*/
			
						
			
			objGenericFunctionLibrary.fnLoadingPageWait();
		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sParentCompanyDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sAddr1DB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sMultEmailDB = mTableDataDB.get(iRow).get(16).toString().trim();
					String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(17).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&
							sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) && 
							sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
							sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) && 
							sCreditPermanentDB.equalsIgnoreCase("1") && 
							sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && sAddr2UI.equalsIgnoreCase(sAddr2DB) && sAddr3UI.equalsIgnoreCase(sAddr3DB) && sCountryUI.equalsIgnoreCase(sCountryDB) && sStateUI.equalsIgnoreCase(sStateDB) && sCityUI.equalsIgnoreCase(sCityDB) && sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		    
		    ///////////////////////////////////////Verifying Contacts Start//////////////////////////////////////////////////////
		    if(bMultiContact==true)
		    {
		    String sQuery = objSQLConfig.sMasterCustomers_MultiContacts_Query;
		    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
		    fnVerifyMultiContactsAddresses(sQuery,mContactDataUI,"Contacts");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mContactTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
		    }
			/////////////////////////////////////Verifying Contacts End//////////////////////////////////////////////////////
			
			
			///////////////////////////////////////Verifying Alternate Addresses Start//////////////////////////////////////////////////////
		    if(bMultiAddress==true)
		    {
			String sQuery = objSQLConfig.sMasterCustomers_MultiAddresses_Query;
			sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			fnVerifyMultiContactsAddresses(sQuery,mAltAddressDataUI,"Alternate Addresses");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mAltAddressTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
		    }
			/////////////////////////////////////Verifying Alternate Addresses End//////////////////////////////////////////////////////
		
		   
		
		} catch (Exception e) {
	   System.out.println("fnAddCustomer --------------Failed");    
	   TestDriver.log.error("fnAddCustomer failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	
	@SuppressWarnings("static-access")
	public void fnVerifyMultiContactsAddresses(String sQuery, HashMap<Integer, HashMap<Integer, String>> mDataUI, String sModule) throws Exception {
				 
				 WebElement eleMain = null;
				 boolean bResultFlag = true;
				 
				    try {
				    	
					    TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				    	//mTableDataDB.equals(mTableDataDB);
						for(int i=1;i<=mDataUI.size(); i++)
						{
							String sCustomerName = mDataUI.get(i).get(2).toString();
							System.out.println(mDataUI.get(i).equals(mTableDataDB.get(i)));
							if(!mDataUI.get(i).equals(mTableDataDB.get(i)))
							{
								bResultFlag = false;
								//obj.repAddData( "Compare "+sModule+" record for customer name : "+ sCustomerName, sModule+ " record on UI and DB should match for customer name : "+ sCustomerName, sModule+ " validation failed for customer name : "+ sCustomerName, "Fail");
								obj.repAddData( "Compare "+sModule+" record", sModule+ " record on UI and DB should match", sModule+ " "+i+" validation failed", "Fail");
							}
							//System.out.println(mTableDataUI.get(i).get(2));
							//System.out.println(mTableDataUI.get(i).get(3));
						}
						
						if(bResultFlag == true)
						{
							obj.repAddData( "Compare all ("+mTableDataDB.size()+") "+sModule+" displayed on the screen", "All "+sModule+" on UI should match with DB records", "UI and DB validation successful for all "+sModule, "Pass");
						}
						else
						{
							obj.repAddData( "Compare all ("+mTableDataDB.size()+") "+sModule+" displayed on the screen", "All "+sModule+" on UI should match with DB records", "UI and DB validation failed for all "+sModule, "Fail");
						}

				    	
				    } catch (Exception e) {
				    	 System.out.println("fnVerifyMultiContactsAddresses --------------Failed");    
						    TestDriver.log.error("fnVerifyMultiContactsAddresses failed",e);
				    }
				}
	@SuppressWarnings("static-access")
	public void fnVerifyDealsMultiContactsAddresses(String sQuery, HashMap<Integer, HashMap<Integer, String>> mDataUI, String sModule) throws Exception {
				 
				 WebElement eleMain = null;
				 boolean bResultFlag = true;
				 
				    try {
				    	
					    TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				    	//mTableDataDB.equals(mTableDataDB);
						for(int i=1;i<=mDataUI.size(); i++)
						{
							String sDealTitle = mDataUI.get(i).get(2).toString();
							System.out.println(mDataUI.get(i).equals(mTableDataDB.get(i)));
							if(!mDataUI.get(i).equals(mTableDataDB.get(i)))
							{
								bResultFlag = false;
								obj.repAddData( "Compare "+sModule+" record for : "+ sDealTitle, sModule+ " record on UI and DB should match for deal title : "+ sDealTitle, sModule+ " validation failed for customer name : "+ sDealTitle, "Fail");
							}
							//System.out.println(mTableDataUI.get(i).get(2));
							//System.out.println(mTableDataUI.get(i).get(3));
						}
						
						if(bResultFlag == true)
						{
							obj.repAddData( "Compare all ("+mTableDataDB.size()+") "+sModule+" displayed on the screen", "All "+sModule+" on UI should match with DB records", "UI and DB validation successful for all "+sModule, "Pass");
						}
						else
						{
							obj.repAddData( "Compare all ("+mTableDataDB.size()+") "+sModule+" displayed on the screen", "All "+sModule+" on UI should match with DB records", "UI and DB validation successful for all "+sModule, "Fail");
						}

				    	
				    } catch (Exception e) {
				    	 System.out.println("fnClickMainMenuElement --------------Failed");    
						    TestDriver.log.error("fnClickMainMenuElement failed",e);
				    }
				}
	
	
	
	public String fnAddCustomerAddressValidation(String sCustomerNameUI, String sOperation, String sAction) throws Exception
	{
		//sCustomerNameUI ="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerNameUI = "AutoTestCustomer_"+sRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
			String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			
			Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);
			//String sStartDateUI2= new SimpleDateFormat("yyyy-MM-dd").format(date);
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
			String sLegalEntityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Legal_Entity").trim();
				
	
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				
			
			//objBusinessLib.fnClickMainMenuElement("Administration");
			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
					
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
				
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
			/*objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
		    /*objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
			objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
						
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "06162016", "Production Start Date");
			TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sRandom+sRandom, "Phone Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, "2487678989", "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, "AutoAddr1", "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, "AutoAddr2", "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, "AutoAddr3", "Address Line 3");
		    
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
			/////////////////Adding Customer Address End//////////////////
			
			//Add group code here
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			
			String sCreditLimitUI=sRandom+".00";
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sCreditLimitUI, "Credit Limit");
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			
			
			
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_AddEditModules_BtnFormExitConfirmation_xp)));
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_BtnFormExitConfirmation_xp, "Confirmation Button", false);

				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				fnUSPSValidation(sAction);
				
				if(sAction.equalsIgnoreCase("EDIT"))
				{
					Thread.sleep(1000);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
				}
				else if(sAction.equalsIgnoreCase("SAVE"))  
				{
					try {
						Thread.sleep(2000);
						
						//Now no need to click on Add button
						//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
					} catch (Exception e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
					objGenericFunctionLibrary.fnLoadingPageWait();
					
					//Resetting variables for DB validation
					sAddr1UI = "AutoAddr1";
					sAddr2UI = "AutoAddr2";
					sAddr3UI = "AutoAddr3";
				}
				
				
				
			/*	try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)).getText();
					
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
					
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.CustomersMaster_AddCustomer_Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
					e.printStackTrace();
					//throw(e);
				}*/
			}
			
			objGenericFunctionLibrary.fnLoadingPageWait();
		    
		    
		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sCreditExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
					
					String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
					String sMultEmailDB = mTableDataDB.get(iRow).get(17).toString().trim();
					String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(18).toString().trim();
					
					String sCustomerStatusDB = mTableDataDB.get(iRow).get(24).toString().trim();//isactive field in DB
					String sCustomerPhoneNumberDB = mTableDataDB.get(iRow).get(25).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&
							sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
							sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
							sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) &&//sCreditPermanentDB.equalsIgnoreCase("1")//sStartDateUI2.equalsIgnoreCase(sStartDateDB) &&//sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB) && 
							sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
					{	
						TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && 
							sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
							sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
							sCountryUI.equalsIgnoreCase(sCountryDB) && 
							sStateUI.equalsIgnoreCase(sStateDB) && 
							sCityUI.equalsIgnoreCase(sCityDB) && 
							sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
		} catch (Exception e) {
	   System.out.println("fnAddCustomer --------------Failed"); 
	   obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Fail");
	   TestDriver.log.error("fnAddCustomer failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	
	
	public void fnUSPSValidation(String sAction) throws Exception
	{
		
		try
		{

			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_USPSValidationWindow_Title_xp)));
			
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_USPSValidationWindow_Title_msg,SphereModules.CustomersMaster_USPSValidationWindow_Title_xp);
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_USPSValidationWindow_LabelResponse_msg,SphereModules.CustomersMaster_USPSValidationWindow_LabelResponse_xp);
			if(sAction.equalsIgnoreCase("SAVE"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_USPSValidationWindow_BtnSave_xp, "Save Button",true);
			}
			else if(sAction.equalsIgnoreCase("EDIT"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_USPSValidationWindow_BtnEdit_xp, "Edit Button",true);
			}
			
		} catch (Exception e) {
			 obj.repAddData( "Verify UPS address validation window","UPS address validation window should pop-up","UPS address validation window not poped up", "Fail");
	   System.out.println("fnUSPSValidation --------------Failed");    
	   TestDriver.log.error("fnUSPSValidation failed",e);
	   }
		
	}

	public void fnGotoLastPage() throws Exception
	{
		
		try
		{
			List<WebElement> elePaginationList = TestDriver.driver.findElements(By.xpath(SphereModules.Common_ViewModules_ListPagination_Xp));
			Integer iNavListSize = elePaginationList.size();
			
			if(iNavListSize>1)
			{
				elePaginationList.get(iNavListSize-2).findElement(By.xpath("./span")).click();
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				System.out.println("Current page is already the last page");  
			}
			
		} catch (Exception e) {
	   System.out.println("fnGotoLastPage --------------Failed");    
	   TestDriver.log.error("fnGotoLastPage failed",e);
	   }
		
	}
	
	

	@SuppressWarnings("static-access")
	public String fnAddIntegrationDealAccount(int iCostCenter, String sCostCenterUI) throws Exception
	{
		String sDealTitleUI ="";
		
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			sDealTitleUI = "AUTOTESTDEAL"+sRandom;
			if(sCostCenterUI.equalsIgnoreCase("Office Services"))
			{
				sDealTitleUI = "AUTOTESTDEALOFFICESERVICES50OFFICESERVICES50_"+sRandom;
			}
			//sDealTitleUI = "Deal update validation";
			Date date = new Date();
		    String sDuplicateDate= new SimpleDateFormat("MMddyyyy").format(date);
			if(TestDriver.iTC_ID==15151)
			{
				sDealTitleUI = "DuplicateDeal_"+sDuplicateDate;
			}
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			if(TestDriver.iTC_ID==15152)
			{
				sDealTitleUI = sCustomerUI;
			}
			
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			//String sAddr1UI = "AutoAddr1_"+sRandom;
			//String sAddr2UI = "AutoAddr2_"+sRandom;
			//String sAddr3UI = "AutoAddr3_"+sRandom;
			String sSalesForceID=sRandom;
			//String sCreditLimitUI=sRandom+".00";
			//String sProjectName="BATES MOTEL";
			//String sProjectNameUI="AutoTestProject_"+sRandom;
			//String sProjectClusterUI="AutoTestProjectCluster_"+sRandom;
			//String sCustomerUI="custdeal";
			
			String sFirstName="AutoTestFirstName"+sRandom;
			String sLastName="AutoTestLastName"+sRandom;
			String sContactTitleUI="AutoTitle"+sRandom;
			String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
			//String sCityUI = "AutoCity_"+sRandom;
			//String sStateUI = "CA";
			//String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			//String sZipUI = sRandom;
			//String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			//String sCountryUI = "United States of America (USA)";
			//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
			//String sDealMakerUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("DealMaker").trim();
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		    String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   // String sCreditApproverUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Credit_Approver").trim();
		    
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
			
		   String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			
			
			//objBusinessLib.fnClickMainMenuElement("Administration");
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			objGenericFunctionLibrary.fnLoadingPageWait();
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp)));
			 

			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboDealMaker_id,sDealMakerUI);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_ComboCostCenter_xp,sCostCenterUI);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			//No need to select below check-box as Multi-Department would be automatically selected
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxMultipleDepartment_id, "Multiple Department", true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			Thread.sleep(2000);
			//objGenericFunctionLibrary.ToClickOnEnter(SphereModules.Deals_AddDeal_SearchCustomers_xp, sCustomerUI); 
			objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp,sCustomerUI);
			//Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxMultipleDepartment_id, "Multiple Department", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxInternal_id, "Internal", true);	
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddCustomer_xp, "Add New Customer", true);
			
			
			//String sCustomer="";
			//sCustomer=fnAddCustomer(sCustomer, "Add");
			//System.out.println(sCustomer);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			
			//////////////////////////
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			/////////////////////////////
			*/
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
				
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, sPoNumberUI, "PO Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
			
			
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
			
			/*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
			Thread.sleep(10000);*/
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "Test Title Name", "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "7344621245", "Phone Number");
			//Fax Number depreciated
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
			///objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealCheckboxInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"04/23/2018","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			
		
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio, "Studio", true);//Removed from Deal page
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboCreditApprover_id,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			
			//if(TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_ComboCustomerCode_id)).isDisplayed())
			if(TestDriver.driver.findElements(By.id(SphereModules.Deals_AddDeal_ComboCustomerCode_id)).size()>0)
			{
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCustomerCode_id,"CENTL");
			}
			
			////For non-permanent customers////
			
	/*		if(TestDriver.driver.findElements(By.id(SphereModules.Deals_AddDeal_CheckboxDepartmentCrdeit_id)).size()>0)
			{
				//click Deals_AddDeal_CheckboxDepartmentCrdeit_id
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboCreditApprover_id,sCreditApproverUI);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			}*/
			
			
			////
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
		   /* try {
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
				String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
   
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				
				if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
				}
				else
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				}
				
				//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
			} catch (Exception e) {
				// TODO Auto-generated catch block
				//obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				e.printStackTrace();
			}*/
	        
						
		    String sQuery = objSQLConfig.sDeals_RegAddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(6).toString().trim();
			//String sMainAddressLine3DB=mTableDataDB.get(1).get(7).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(9).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(10).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(11).toString().trim();
			//String srevenueDB=mTableDataDB.get(1).get(12).toString().trim();
			//String slot=mTableDataDB.get(1).get(13).toString().trim();
			//String scostplusDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(15).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(16).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(17).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(18).toString().trim();
			//String sSalesForceProjectDB=mTableDataDB.get(1).get(19).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(20).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(21).toString().trim();
			String sinvoiceformatCodeidDB=mTableDataDB.get(1).get(22).toString().trim();
			String scredit_limitDB=mTableDataDB.get(1).get(23).toString().trim();
			String is_credit_approvedDB=mTableDataDB.get(1).get(24).toString().trim();
			String is_credit_permanentDB=mTableDataDB.get(1).get(25).toString().trim();
			String credit_expirationDB=mTableDataDB.get(1).get(26).toString().trim();
			String is_Department_CreditDB=mTableDataDB.get(1).get(27).toString().trim();
			String Department_credit_limitDB=mTableDataDB.get(1).get(28).toString().trim();
			
			String PhoneNumberDB=mTableDataDB.get(1).get(29).toString().trim();		
			String sCustomerNumberDB=mTableDataDB.get(1).get(30).toString().trim();
			String sCustomerisActiveDB=mTableDataDB.get(1).get(31).toString().trim();
			String sCustomerTypeDB=mTableDataDB.get(1).get(32).toString().trim();
			
			//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&
					sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
					sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal");
				String sDeptSystemsStatus = BusinessFunctionLibrary.fnVerifyDeptSystems(sDealTitleUI);
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,,,,"+sDeptSystemsStatus);
				TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,"+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sCountryDB+","+sMainZipcodeDB+","+is_credit_permanentDB+","+credit_expirationDB+","+scredit_limitDB+","+sPoNumberDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+",,"+sDeptSystemsStatus+","+sCostCenterUI+","+sDealTypeDB+","+Department_credit_limitDB);
				//TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",,,,,,,,,,,,,,,"+sDealNumberDB+",\'"+sDealTitleDB+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_permanentDB+","+credit_expirationDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sCostCenterUI+","+sPoNumberDB);
				TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNumberDB+","+sCustomerNameDB+","+sCostCenterUI+","+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_permanentDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_permanentDB+","+credit_expirationDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sCostCenterUI+","+sPoNumberDB);
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccount --------------Failed");    
	   obj.repAddData( "Verify Deal", "New deal should be created", "New deal not created", "Fail");
	   TestDriver.log.error("fnAddDealAccount failed",e);
	   }
		
		return sDealTitleUI;
		
		
	}
	
	
	public String fnAddIntegrationCustomersMultiCountries(String sCustomerNameUI, String sOperation) throws Exception
	{
		//sCustomerNameUI ="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
			String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			
			Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);
			
			//String sStartDateUI2= new SimpleDateFormat("yyyy-MM-dd").format(date);
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
			String sLegalEntityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Legal_Entity").trim();
			
			
			
		//	String sEmailUI = "AutoEmail_"+sRandom+"@nbcuni.com";
			/*String sAddr1UI = "AutoAddr1_"+sRandom;
			String sAddr2UI = "AutoAddr2_"+sRandom;
			String sAddr3UI = "AutoAddr3_"+sRandom;
			String sCityUI = "AutoCity_"+sRandom;
			String sZipUI = sRandom;*/
			
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			String[] arrCountry = sCountryUI.split(";");
			
		
			
			//objBusinessLib.fnClickMainMenuElement("Administration");
			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			
			
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
			/*objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
		    
			/*objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
			objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
			
			
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "06162016", "Production Start Date");
			
			
			TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sRandom+sRandom, "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			//Below line is temporary 
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,"ARUBA");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			if(!sStateUI.equalsIgnoreCase(""))
			{
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			}
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			
			//Support Multiple Addresses is by default feature now
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
			/////////////////Adding Customer Address End//////////////////
			
			//Add group code here
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			
			String sCreditLimitUI=sRandom+".00";
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit"); //Code already handled .00
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sCreditLimitUI, "Credit Limit");
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			
			
			
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				/*try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)).getText();
					
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
					
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.CustomersMaster_AddCustomer_Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
					e.printStackTrace();
					//throw(e);
				}*/
			}
			
			//objGenericFunctionLibrary.fnLoadingPageWait();
		    
		    
		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sParentCompanyDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sAddr1DB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sMultEmailDB = mTableDataDB.get(iRow).get(16).toString().trim();
					String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(17).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) && sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) && sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) && sStartDateUI2.equalsIgnoreCase(sStartDateDB) && sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB) && sCreditPermanentDB.equalsIgnoreCase("1") && sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
					{	
						TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && sAddr2UI.equalsIgnoreCase(sAddr2DB) && sAddr3UI.equalsIgnoreCase(sAddr3DB) && sCountryUI.equalsIgnoreCase(sCountryDB) && sStateUI.equalsIgnoreCase(sStateDB) && sCityUI.equalsIgnoreCase(sCityDB) && sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
		} catch (Exception e) {
	   System.out.println("fnAddCustomer --------------Failed");    
	   TestDriver.log.error("fnAddCustomer failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	
	public String fnAddDealAccountWithCustomer(int iCostCenter, String sCostCenterUI,boolean AddCustomer, boolean SearchCustomer,String AltAddressLine1) throws Exception
	{
		String sDealTitleUI ="";
		String sCustomerName="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sDealTitleRandom);
			
			sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;

			//sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			String sProjectName="SCRIPTED WORLD";
			//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
			//String sAltaddress=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim();//customer name is provided from test data
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		   
			//String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		   //String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		   //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   
		    Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			String sMultiDepartmentText= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MultiDepartment_text_xp)).getText().trim();			
			String ExpDepartmentText="No";
			objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpDepartmentText, sMultiDepartmentText.trim());

			if(AddCustomer==true)
			{				
			sCustomerName=fnDealAddCustomer(sCustomerName, "Add",false,0,false,0);
			System.out.println(sCustomerName);
			}
			else if(SearchCustomer==true)
			{
			  objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			  objGenericFunctionLibrary.fnLoadingPageWait();
			  objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			}
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Customers_CreditApprovalNotification_Deal_customer_xp,sCustomerUI,true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_Edit_Customer_Pencil, "Edit Link", true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_Edit_Customer_Delete_icon_xp, "Delete Link", true,true);
			
			obj.repAddData( "Verifying Customer main address ", "", "", "");
			fnVerifyDealCustomerAddress(sCustomerName,objSQLConfig.sNewcustomer_MainAddress_Query);
			//fnVerifyDealCustomerAddress(sCustomerName);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp," Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,"Search Alternate Address",true,true);
			
			obj.repAddData( "adding alternate address and verify the values  ", "", "", "");
			fnAddandVerifyFields("AddAddress");
			///////////////////////////adding new alternate address//////////////////////////////////////////
			/*String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
			String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
			String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
			String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
			String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
			String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
			String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
            
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc", "Alternate Address Description");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine1_id, sAltAddr1UI, "Alternate Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine2_id, sAltAddr2UI, "Alternate Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine3_id, sAltAddr3UI, "Alternate Address Line 3");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCountry_xp,sAltCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboState_xp,sAltStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputCity_xp, sAltCityUI, "Alt City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputZipId_id, sAltZipUI, "Alt Zip");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Save_xp,"Save Alternate Address",true);
			objGenericFunctionLibrary.fnLoadingPageWait();*/
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditAltAddress_Pencil_xp, "Edit Alt address Link", true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditAltAddress_Delete_xp, "Delete Link", true,true);
			
			/////////////////////////Searching for existing address/////////////////////
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,AltAddressLine1, "Search Address");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddressListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			                              /////////Add Project and Verify Fields////////
			obj.repAddData( "adding project and verify the values  ", "", "", "");
			fnAddandVerifyFields("AddProject");
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EdditProject_Pencil_xp,"Edit link",true,true); 
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EdditProject_Delete_xp,"Delete link",true,true);
			/*objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);*/
	        
			                              /////////Add Contact and Verify Fields////////
			obj.repAddData( "adding contact and verify the values  ", "", "", "");
			fnAddandVerifyFields("AddContact");
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil,"Edit Pencil",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_DeleteContact,"Delete Contact",true,true);
			/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "Test Title Name", "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "2484621245", "Phone Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
			///objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			objGenericFunctionLibrary.fnLoadingPageWait();*/
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnOnLotYes_id,"On Lot Yes",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnOnLotNo_id,"On Lot No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnTaxYes_id,"Tax",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnTaxNo_id,"Tax No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnRevenueShareNo_id,"Revenue Share No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnRevenueShareYes_id,"Revenue Share Yes",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnCostPlusYes_id,"Cost Plus",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnCostPlusNo_id,"Cost Plus No",true,true);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotNo_id, "On Lot No", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxNo_id, "Tax No", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,"Invoice Format",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,"Billing Schedule",true,true);
			//objGenericFunctionLibrary.fnCheckfieldDisbleByXPath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,"Invoice Format");
            /////////////////////Verifying Billing Schedule and Invoice Format drop down Values///////////////////////////////
			obj.repAddData( "Verifying Billing Schedule default value and Invoice format,Billing Schedule drop down values ", "", "", "");
			
			objGenericFunctionLibrary.fnVerifyCombolist("Billing_Schedule_list","Billing Schedule" ,SphereModules.Deals_AddDealComboBillingSchedule_id);
			objGenericFunctionLibrary.fnVerifyCombolist("Invoice_Format_List","Invoice Format" ,SphereModules.Deals_AddDealComboInvoiceFormat_id);
			
			String sInvoiceFormatUI="DCS - Direct Charge Summary";
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			String sActBillingSchedule=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Add_Deal_Biling_Request_Selected_Value_xp)).getText().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Add_Deal_Biling_Request_Selected_Value_xp);
			System.out.println(sActBillingSchedule);
			
			String sExpBillingSchedule ="R - On Request";
			objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpBillingSchedule, sActBillingSchedule.trim());
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			
			obj.repAddData( "Verifying status field default value and drop down values ", "", "", "");
			
			String sStatusField=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Add_Deal_Status_Open_xp)).getText().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Add_Deal_Status_Open_xp);
			System.out.println(sStatusField);
			String sExpStatusField ="Open";
			objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpStatusField, sStatusField.trim());
			//String actuallist=fnComboBoxDataList(SphereModules.Deals_Add_Deal_Status_id,"Status",true,true);//
			objGenericFunctionLibrary.fnVerifyCombolist("Status_Field_list","Status",SphereModules.Deals_Add_Deal_Status_id );
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnInsuranceCertified_id,"Insurance Certified",true,true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
				
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"Insurance Expiration",true,true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			Thread.sleep(3000);
			
			obj.repAddData( "Verifying deal record in the first row ", "", "", "");
			
			if(TestDriver.driver.findElement(By.xpath(SphereModules.Common_View_Modules_Table_FirstRow_xp)).getText().equals(sDealTitleUI))
		    {
				obj.repAddData("Verify Deal displayed in the first Row", "Deal Should display in the first row in table","Deal is succesfully displayed in the first row", "Pass");
				
				String ActualColor=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_GreenColor_xp)).getAttribute("class");
				
				String [] arrClassName = ActualColor.split(" ");
		        
				String sStatus = arrClassName[arrClassName.length-1].toString().trim();
		        
				if(sStatus.equalsIgnoreCase("activeRecord"))
		        {
		        	obj.repAddData("Verify Green Color is displayed ", "Green Color should display next to the newly created deal","Green color is displayed", "Pass");
		        }				  
		        else
		        {
		        	obj.repAddData("Verify Green Color is displayed ", "Green Color should display next to the newly created deal","Green color is not displayed", "Fail");
		        }
		    
		    }else
			{
				obj.repAddData("Verify Deal displayed in the first Row", "Deal Should display in the first row in table","Deal is not displayed in the first row", "Fail");
			}
			
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
			if(SearchCustomer==true)
			{
			
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
			
			}
			if(AddCustomer==true)
			{
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB)&& 
				sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
				sCustomerName.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
			}
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccountwithcustomer --------------Failed");    
	   TestDriver.log.error("fnAddDealAccountwithcustomer failed",e);
	   }
		
		return sDealTitleUI;
}
	
	public String fnAddDCSDealAccountWithCustomerforBilling(int iCostCenter, String sCostCenterUI,boolean AddCustomer, boolean SearchCustomer,String AltAddressLine1,String sInvoiceFormatUI) throws Exception
	{
		String sDealTitleUI ="";
		String sCustomerName="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sDealTitleRandom);
			
			sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;

			//sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			String sProjectName="SCRIPTED WORLD";
			//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
			//String sAltaddress=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim();//customer name is provided from test data
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		   
			//String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		   //String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		   //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   
		    Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			String sMultiDepartmentText= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MultiDepartment_text_xp)).getText().trim();			
			String ExpDepartmentText="No";
			objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpDepartmentText, sMultiDepartmentText.trim());

			if(AddCustomer==true)
			{				
			sCustomerName=fnDealAddCustomerwithNoEmail(sCustomerName, "Add",false,0,false,0);
			System.out.println(sCustomerName);
			}
			else if(SearchCustomer==true)
			{
			  objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			  objGenericFunctionLibrary.fnLoadingPageWait();
			  objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			}
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Customers_CreditApprovalNotification_Deal_customer_xp,sCustomerUI,true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_Edit_Customer_Pencil, "Edit Link", true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_Edit_Customer_Delete_icon_xp, "Delete Link", true,true);
			
			obj.repAddData( "Verifying Customer main address ", "", "", "");
			fnVerifyDealCustomerAddress(sCustomerName,objSQLConfig.sNewcustomer_MainAddress_Query);
			//fnVerifyDealCustomerAddress(sCustomerName);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddressListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
					
			//objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EdditProject_Pencil_xp,"Edit link",true,true); 
			//objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EdditProject_Delete_xp,"Delete link",true,true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
	        
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnOnLotYes_id,"On Lot Yes",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnOnLotNo_id,"On Lot No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnTaxYes_id,"Tax",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnTaxNo_id,"Tax No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnRevenueShareNo_id,"Revenue Share No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnRevenueShareYes_id,"Revenue Share Yes",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnCostPlusYes_id,"Cost Plus",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnCostPlusNo_id,"Cost Plus No",true,true);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotNo_id, "On Lot No", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxNo_id, "Tax No", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,"Invoice Format",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,"Billing Schedule",true,true);
			//objGenericFunctionLibrary.fnCheckfieldDisbleByXPath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,"Invoice Format");
            /////////////////////Verifying Billing Schedule and Invoice Format drop down Values///////////////////////////////
			//obj.repAddData( "Verifying Billing Schedule default value and Invoice format,Billing Schedule drop down values ", "", "", "");
			
			//objGenericFunctionLibrary.fnVerifyCombolist("Billing_Schedule_list","Billing Schedule" ,SphereModules.Deals_AddDealComboBillingSchedule_id);
			//objGenericFunctionLibrary.fnVerifyCombolist("Invoice_Format_List","Invoice Format" ,SphereModules.Deals_AddDealComboInvoiceFormat_id);
			
			//String sInvoiceFormatUI="DCS - Direct Charge Summary";
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			String sActBillingSchedule=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Add_Deal_Biling_Request_Selected_Value_xp)).getText().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Add_Deal_Biling_Request_Selected_Value_xp);
			System.out.println(sActBillingSchedule);
			
			String sExpBillingSchedule ="R - On Request";
			objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpBillingSchedule, sActBillingSchedule.trim());
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			
			obj.repAddData( "Verifying status field default value and drop down values ", "", "", "");
			
			//String sStatusField=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Add_Deal_Status_Open_xp)).getText().trim();
			//objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Add_Deal_Status_Open_xp);
			//System.out.println(sStatusField);
			//String sExpStatusField ="Open";
			//objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpStatusField, sStatusField.trim());
			//String actuallist=fnComboBoxDataList(SphereModules.Deals_Add_Deal_Status_id,"Status",true,true);//
			//objGenericFunctionLibrary.fnVerifyCombolist("Status_Field_list","Status",SphereModules.Deals_Add_Deal_Status_id );
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnInsuranceCertified_id,"Insurance Certified",true,true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
				
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"Insurance Expiration",true,true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			Thread.sleep(3000);
			
			obj.repAddData( "Verifying deal record in the first row ", "", "", "");
			
			if(TestDriver.driver.findElement(By.xpath(SphereModules.Common_View_Modules_Table_FirstRow_xp)).getText().equals(sDealTitleUI))
		    {
				obj.repAddData("Verify Deal displayed in the first Row", "Deal Should display in the first row in table","Deal is succesfully displayed in the first row", "Pass");
				
				String ActualColor=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_GreenColor_xp)).getAttribute("class");
				
				String [] arrClassName = ActualColor.split(" ");
		        
				String sStatus = arrClassName[arrClassName.length-1].toString().trim();
		        
				if(sStatus.equalsIgnoreCase("activeRecord"))
		        {
		        	obj.repAddData("Verify Green Color is displayed ", "Green Color should display next to the newly created deal","Green color is displayed", "Pass");
		        }				  
		        else
		        {
		        	obj.repAddData("Verify Green Color is displayed ", "Green Color should display next to the newly created deal","Green color is not displayed", "Fail");
		        }
		    
		    }else
			{
				obj.repAddData("Verify Deal displayed in the first Row", "Deal Should display in the first row in table","Deal is not displayed in the first row", "Fail");
			}
			
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
			if(SearchCustomer==true)
			{
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
			
			}
			if(AddCustomer==true)
			{
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB)&& 
				sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
				sCustomerName.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
			}
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccountwithcustomer --------------Failed");    
	   TestDriver.log.error("fnAddDealAccountwithcustomer failed",e);
	   }
		
		return sDealTitleUI;
}
	
	public String fnAddDETDealAccountWithCustomerforBilling(int iCostCenter, String sCostCenterUI,boolean AddCustomer, boolean SearchCustomer,String AltAddressLine1,String sInvoiceFormatUI) throws Exception
	{
		String sDealTitleUI ="";
		String sCustomerName="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sDealTitleRandom);
			
			sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;

			//sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			String sProjectName="SCRIPTED WORLD";
			//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
			//String sAltaddress=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim();//customer name is provided from test data
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		   
			//String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		   //String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		   //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   
		    Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			String sMultiDepartmentText= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MultiDepartment_text_xp)).getText().trim();			
			String ExpDepartmentText="No";
			objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpDepartmentText, sMultiDepartmentText.trim());

			if(AddCustomer==true)
			{				
			sCustomerName=fnDealAddCustomerwithNoEmail(sCustomerName, "Add",false,0,false,0);
			System.out.println(sCustomerName);
			}
			else if(SearchCustomer==true)
			{
			  objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			  objGenericFunctionLibrary.fnLoadingPageWait();
			  objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			}
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Customers_CreditApprovalNotification_Deal_customer_xp,sCustomerUI,true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_Edit_Customer_Pencil, "Edit Link", true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_Edit_Customer_Delete_icon_xp, "Delete Link", true,true);
			
			obj.repAddData( "Verifying Customer main address ", "", "", "");
			fnVerifyDealCustomerAddress(sCustomerName,objSQLConfig.sNewcustomer_MainAddress_Query);
			//fnVerifyDealCustomerAddress(sCustomerName);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddressListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
					
			//objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EdditProject_Pencil_xp,"Edit link",true,true); 
			//objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EdditProject_Delete_xp,"Delete link",true,true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
	        
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnOnLotYes_id,"On Lot Yes",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnOnLotNo_id,"On Lot No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnTaxYes_id,"Tax",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnTaxNo_id,"Tax No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnRevenueShareNo_id,"Revenue Share No",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnRevenueShareYes_id,"Revenue Share Yes",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnCostPlusYes_id,"Cost Plus",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnCostPlusNo_id,"Cost Plus No",true,true);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotNo_id, "On Lot No", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxNo_id, "Tax No", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,"Invoice Format",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,"Billing Schedule",true,true);
			//objGenericFunctionLibrary.fnCheckfieldDisbleByXPath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,"Invoice Format");
            /////////////////////Verifying Billing Schedule and Invoice Format drop down Values///////////////////////////////
			//obj.repAddData( "Verifying Billing Schedule default value and Invoice format,Billing Schedule drop down values ", "", "", "");
			
			//objGenericFunctionLibrary.fnVerifyCombolist("Billing_Schedule_list","Billing Schedule" ,SphereModules.Deals_AddDealComboBillingSchedule_id);
			//objGenericFunctionLibrary.fnVerifyCombolist("Invoice_Format_List","Invoice Format" ,SphereModules.Deals_AddDealComboInvoiceFormat_id);
			
			//String sInvoiceFormatUI="DCS - Direct Charge Summary";
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			String sActBillingSchedule=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Add_Deal_Biling_Request_Selected_Value_xp)).getText().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Add_Deal_Biling_Request_Selected_Value_xp);
			System.out.println(sActBillingSchedule);
			
			String sExpBillingSchedule ="R - On Request";
			objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpBillingSchedule, sActBillingSchedule.trim());
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			
			obj.repAddData( "Verifying status field default value and drop down values ", "", "", "");
			
			//String sStatusField=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Add_Deal_Status_Open_xp)).getText().trim();
			//objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Add_Deal_Status_Open_xp);
			//System.out.println(sStatusField);
			//String sExpStatusField ="Open";
			//objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpStatusField, sStatusField.trim());
			//String actuallist=fnComboBoxDataList(SphereModules.Deals_Add_Deal_Status_id,"Status",true,true);//
			//objGenericFunctionLibrary.fnVerifyCombolist("Status_Field_list","Status",SphereModules.Deals_Add_Deal_Status_id );
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDealBtnInsuranceCertified_id,"Insurance Certified",true,true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
				
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"Insurance Expiration",true,true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			Thread.sleep(3000);
			
			obj.repAddData( "Verifying deal record in the first row ", "", "", "");
			
			if(TestDriver.driver.findElement(By.xpath(SphereModules.Common_View_Modules_Table_FirstRow_xp)).getText().equals(sDealTitleUI))
		    {
				obj.repAddData("Verify Deal displayed in the first Row", "Deal Should display in the first row in table","Deal is succesfully displayed in the first row", "Pass");
				
				String ActualColor=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_GreenColor_xp)).getAttribute("class");
				
				String [] arrClassName = ActualColor.split(" ");
		        
				String sStatus = arrClassName[arrClassName.length-1].toString().trim();
		        
				if(sStatus.equalsIgnoreCase("activeRecord"))
		        {
		        	obj.repAddData("Verify Green Color is displayed ", "Green Color should display next to the newly created deal","Green color is displayed", "Pass");
		        }				  
		        else
		        {
		        	obj.repAddData("Verify Green Color is displayed ", "Green Color should display next to the newly created deal","Green color is not displayed", "Fail");
		        }
		    
		    }else
			{
				obj.repAddData("Verify Deal displayed in the first Row", "Deal Should display in the first row in table","Deal is not displayed in the first row", "Fail");
			}
			
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
			if(SearchCustomer==true)
			{
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
			
			}
			if(AddCustomer==true)
			{
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB)&& 
				sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
				sCustomerName.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
			}
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccountwithcustomer --------------Failed");    
	   TestDriver.log.error("fnAddDealAccountwithcustomer failed",e);
	   }
		
		return sDealTitleUI;
}
	public String fnAddDealAccountWithAddressSearch(int iCostCenter, String sCostCenterUI,String sAltAddressLine1) throws Exception
	
	{
		String sDealTitleUI ="";
		try
		{
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		    String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
		    //String sContactDetailsUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Contact").trim();
		   // String sAltaddress=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim();
		    //String sAddressLine1UI="1136 OAK VALLEY DR";
		    String sAltcity="ANN ARBOR";
			String sAltCountry="UNITED STATES";
			String sAltState="MICHIGAN";
			String sZip="48109";
		    
		    Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp," Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,"Search Alternate Address",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,sAltAddressLine1, "Search Address");
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddressListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,"Search Projects",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp,"Project Add Button",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
			
			//objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Add Contact Button",true,true);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,sContactDetailsUI, "Search Contact");
			//objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ContactListSearch_xp, "First customer Row", true);
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_Search_Contact_Save_Btn_xp,"Save Button", true);
			//objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
			if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
					sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
					sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
				    
			        String sQuery2 = objSQLConfig.sDealUpdtAddress_Query;
					//String sQuery2 = objSQLConfig.sDealAddress_Query;
				    sQuery2 = sQuery2.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
					String sAddr1DB = mTableDataDB2.get(1).get(1).toString().trim();
					//String sAddr2DB = mTableDataDB.get(1).get(3).toString().trim();
					//String sAddr3DB = mTableDataDB.get(1).get(4).toString().trim();
					String CountryDB = mTableDataDB2.get(1).get(2).toString().trim();
					String StateDB = mTableDataDB2.get(1).get(3).toString().trim();
					String sCityDB = mTableDataDB2.get(1).get(4).toString().trim();
					String sZipDB = mTableDataDB2.get(1).get(5).toString().trim();

					if(sAltAddressLine1.equalsIgnoreCase(sAddr1DB) && 
							//sAltAddressLine2.equalsIgnoreCase(sAddr2DB) &&
							//sAltAddressLine3.equalsIgnoreCase(sAddr3DB) &&
							sAltCountry.equalsIgnoreCase(CountryDB) &&
							sAltState.equalsIgnoreCase(StateDB) &&
							sAltcity.equalsIgnoreCase(sCityDB) &&
							sZip.equalsIgnoreCase(sZipDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
						obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Address Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
					}
					else
					{
						obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Address Validation failed for deal title : "+ sDealTitleUI, "Fail");
					}
					
					    String sQuery3 = objSQLConfig.sDeals_AddDealProject_Query;
					    sQuery3 = sQuery3.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
						TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
						
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
						String sProjectNameDB = mTableDataDB3.get(1).get(1).toString().trim();
						//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
						String sDealTitle = mTableDataDB3.get(1).get(6).toString().trim();
						
						if(sProjectName.equalsIgnoreCase(sProjectNameDB)&& sDealTitleUI.equalsIgnoreCase(sDealTitle))
						{	
							//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
						}
						else
						{
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation failed for deal title : "+ sDealTitleUI, "Fail");
						}
					
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccountWithSearchScenario --------------Failed");    
	   TestDriver.log.error("fnAddDealAccountWithSearchScenario failed",e);
	   }
		
		return sDealTitleUI;
 }
public String fnAddDealAccountWithSearchScenario(int iCostCenter, String sCostCenterUI) throws Exception
	
	{
		String sDealTitleUI ="";
		try
		{
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			//String sCreditLimitUI=sRandom+".00";
			String sProjectName="SCRIPTED WORLD";
			//String sCustomerUI="ABC TELEVISION CENTER";
			//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		    //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		    String sContactDetailsUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Contact").trim();
		    String sAltaddress=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim();
		    String sContactFirstName="AutoTestFirstName";
		    String sContactLastName="AutoTestLastName";
		    String sAddressLine1UI="1136 OAK VALLEY DR";
		    String sAltcity="ANN ARBOR";
			String sAltCountry="UNITED STATES";
			String sAltState="MICHIGAN";
			String sZip="48108";
		    //String sAddressLine1UI="1136 OAK";
		    Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp," Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,"Search Alternate Address",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,sAltaddress, "Search Address");
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddressListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,"Search Projects",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp,"Project Add Button",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Add Contact Button",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,sContactDetailsUI, "Search Contact");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ContactListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_Search_Contact_Save_Btn_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
		   
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
			if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
				    
			        String sQuery1 = objSQLConfig.sDealContact_Query;
				    sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sContactFirstNameDB = mTableDataDB1.get(1).get(1).toString().trim();
					String sContactLaststNameDB = mTableDataDB1.get(1).get(2).toString().trim();
					String DealTitleDB = mTableDataDB1.get(1).get(6).toString().trim();
				    
					if(sDealTitleUI.equalsIgnoreCase(DealTitleDB) && sContactFirstName.equalsIgnoreCase(sContactFirstNameDB) && sContactLastName.equalsIgnoreCase(sContactLaststNameDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
						obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
					}
					else
					{
						obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
					String sQuery2 = objSQLConfig.sDealAddress_Query;
				    sQuery2 = sQuery2.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
					String sAddr1DB = mTableDataDB.get(1).get(2).toString().trim();
					String sAddr2DB = mTableDataDB.get(1).get(3).toString().trim();
					String sAddr3DB = mTableDataDB.get(1).get(4).toString().trim();
					String CountryDB = mTableDataDB.get(1).get(5).toString().trim();
					String StateDB = mTableDataDB.get(1).get(6).toString().trim();
					String sCityDB = mTableDataDB.get(1).get(7).toString().trim();
					String sZipDB = mTableDataDB.get(1).get(8).toString().trim();

					if(sAddressLine1UI.equalsIgnoreCase(sAddr1DB) && 
							//sAltAddressLine2.equalsIgnoreCase(sAddr2DB) &&
							//sAltAddressLine3.equalsIgnoreCase(sAddr3DB) &&
							sAltCountry.equalsIgnoreCase(sCountryDB) &&
							sAltState.equalsIgnoreCase(sStateDB) &&
							sAltcity.equalsIgnoreCase(sCityDB) &&
							sZip.equalsIgnoreCase(sZipDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
						obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Address Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
					}
					else
					{
						obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Address Validation failed for deal title : "+ sDealTitleUI, "Fail");
					}
					
					    String sQuery3 = objSQLConfig.sDeals_AddDealProject_Query;
					    sQuery3 = sQuery3.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
						TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
						
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
						String sProjectNameDB = mTableDataDB3.get(1).get(1).toString().trim();
						//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
						String sDealTitle = mTableDataDB3.get(1).get(6).toString().trim();
						
						if(sProjectName.equalsIgnoreCase(sProjectNameDB)&& sDealTitleUI.equalsIgnoreCase(sDealTitle))
						{	
							//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
						}
						else
						{
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation failed for deal title : "+ sDealTitleUI, "Fail");
						}
					
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccountWithSearchScenario --------------Failed");    
	   TestDriver.log.error("fnAddDealAccountWithSearchScenario failed",e);
	   }
		
		return sDealTitleUI;
 }
public String fnAddDealAccountWithSearchProject(int iCostCenter, String sCostCenterUI) throws Exception

{
	String sDealTitleUI ="";
	try
	{
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
		sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
		String sPoNumberUI = "AutoPONumber_"+sRandom;
		String sSalesForceID=sRandom;
		
		String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
		String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
		String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
	    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
	    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
	    //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
	    
	    Date date = new Date();

	    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
		
		Date dexpiredday = DateUtils.addDays(new Date(), +5);
		SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
		String sEndDateUI2 = sdf.format(dexpiredday);
		fnClickMainMenuElement("Deals");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
		fnSelectCostCenter(iCostCenter,sCostCenterUI);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
		
		//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
		objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
		objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
		
		objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,"Search Projects",true,true);
		objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp,"Project Add Button",true,true);
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
		
		objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
		objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Add Contact Button",true,true);
		
		
		//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
		//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
		///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
		//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
		//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
		//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
		//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
		//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
		//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
		//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
		//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
			
	    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
		String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
		String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
		String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
	    
		String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
		String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
		String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
		String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
		String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
		String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
		String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
		String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
		String slot=mTableDataDB.get(1).get(12).toString().trim();
		String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
		String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
		String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
		String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
		String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
		String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
		String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
		String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
		
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
		{	
			//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
			obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
		}
			    
		        
				    String sQuery3 = objSQLConfig.sDeals_AddDealProject_Query;
				    sQuery3 = sQuery3.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				
					String sProjectNameDB = mTableDataDB3.get(1).get(1).toString().trim();
					//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
					String sDealTitle = mTableDataDB3.get(1).get(6).toString().trim();
					
					if(sProjectName.equalsIgnoreCase(sProjectNameDB)&& sDealTitleUI.equalsIgnoreCase(sDealTitle))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
						obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
					}
					else
					{
						obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation failed for deal title : "+ sDealTitleUI, "Fail");
					}
				
		
		
	} catch (Exception e) {
   System.out.println("fnAddDealAccountWithSearchProject --------------Failed");    
   TestDriver.log.error("fnAddDealAccountWithSearchProject failed",e);
   }
	
	return sDealTitleUI;
}
public String fnAddDealAccountWithSearchContact(int iCostCenter, String sCostCenterUI) throws Exception
	
	{
		String sDealTitleUI ="";
		try
		{
			
			obj.repAddData( "Adding a contact is pre condition", "", "", "");
			String sContactFirstName= fnContactsearchPrecondition();///////it will add 1 contact on add deal form/////
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			String sDate = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
			System.out.println(sDate);
			
			sDealTitleUI = "AUTOTESTDEAL_"+sDate;
			
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			//String sCreditLimitUI=sRandom+".00";
			//String sProjectName="SCRIPTED WORLD";
			//String sCustomerUI="ABC TELEVISION CENTER";
			//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
			
			String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		    //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   // String sContactDetailsUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Contact").trim();
		   // String sAltaddress=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim();
		   
		  /*  String sContactDetailsUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Contact").trim();
			String [] arrContact = sContactDetailsUI.split(";");
			
			String sContactLastNameUI= arrContact[0].toString();
			String sContactTitleUI= arrContact[1].toString();*/////include these steps if using test data values
			
			String sContactLastNameUI="TestLastName";
			String sContactTitleUI="TestTitle";
		    
			Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp," Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,"Search Alternate Address",true,true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,sAltaddress, "Search Address");
			//objGenericFunctionLibrary.fnLoadingPageWait();
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddressListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,"Search Projects",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp,"Project Add Button",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact Button",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,sContactFirstName, "Search Contact");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ContactListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_Search_Contact_Save_Btn_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
			if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
					sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
					sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
				    
			        String sQuery1 = objSQLConfig.sDealContact_Query;
				    sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sContactFirstNameDB = mTableDataDB1.get(1).get(1).toString().trim();
					String sContactLaststNameDB = mTableDataDB1.get(1).get(2).toString().trim();
					String DealTitleDB = mTableDataDB1.get(1).get(6).toString().trim();
				    
					if(sDealTitleUI.equalsIgnoreCase(DealTitleDB)&&
							sContactFirstName.equalsIgnoreCase(sContactFirstNameDB)&&
							sContactLastNameUI.equalsIgnoreCase(sContactLaststNameDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
						obj.repAddData( "Compare contact details for Deal Title : "+ sDealTitleUI, "Deal contact details on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare contact details for Deal Title : "+ sDealTitleUI, "Deal contact details on UI and DB should match for Deal Title : "+ sDealTitleUI, "Contact Validation failed for deal title : "+ sDealTitleUI, "Fail");
					}
					   objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
					   /* String sQuery3 = objSQLConfig.sDeals_AddDealProject_Query;
					    sQuery3 = sQuery3.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
						TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
						
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
						String sProjectNameDB = mTableDataDB3.get(1).get(1).toString().trim();
						//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
						String sDealTitle = mTableDataDB3.get(1).get(6).toString().trim();
						
						if(sProjectName.equalsIgnoreCase(sProjectNameDB)&& 
								sDealTitleUI.equalsIgnoreCase(sDealTitle))
						{	
							//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
						}
						else
						{
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation failed for deal title : "+ sDealTitleUI, "Fail");
						}*/
					
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccountWithSearchScenario --------------Failed");    
	   TestDriver.log.error("fnAddDealAccountWithSearchScenario failed",e);
	   }
		
		return sDealTitleUI;
 }
	
public String fnAddDealMultiContactSearch(int iCostCenter, String sCostCenterUI,boolean MultiSearch,int SearchContactCount) throws Exception
	
	{
		String sDealTitleUI ="";
		HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
		
		try
		{
			String sNameRandom=fnAddMultiContactForsearchScenario();
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			String sProjectName="SCRIPTED WORLD";
			String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();//customer name is provided from test data
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		    //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		    
		    Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id,"Main Address Radio Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Alternate Address Radio Button",true,true);
			
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			//objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp," Address Radio Button",true,true);
			//objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,"Search Alternate Address",true,true);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,sAltaddress, "Search Address");
			//objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddressListSearch_xp, "First customer Row", true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,"Search Projects",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp,"Project Add Button",true,true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id,"Add Contact Button",true,true);
			if(MultiSearch==true)
			{
			//int isearchContactCount=4;
			for(int i=1;i<=SearchContactCount;i++)
			{
				String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
				String sContactPhone="2487898989";
	 			String sDealContactPhoneUI="(248) 789-8989";
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"AutoContactFirstName"+i+"_"+sNameRandom, "Search Contact");
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ContactListSearch_xp, "First customer Row", true);
				
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_Search_Contact_FirstName_xp,"FirstName",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_MainContact_CheckBox_xp,"Main Contact",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoice_CheckBox_xp,"Receive Invoice",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_Search_Contact_Cancel_Btn_xp,"Cancel",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_Search_Contact_Save_Btn_xp,"Save",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_Search_Contact_ToolTip_Icon_xp,"Tool Tip",true,true);
				if(i==1)
				{
				objGenericFunctionLibrary.ClickByXpath(SphereModules. Deals_AddDeal_MainContact_CheckBox_xp, "Main Contact", true);
				}
				if(i==4)
				{
				objGenericFunctionLibrary.fnCheckfieldDisbleByXPath(SphereModules.Deals_AddDeal_ReceiveInvoice_CheckBox_xp,"Receives Invoice");
				}else
				{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ReceiveInvoice_CheckBox_xp, "Receives Invoice", true);
				}
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_Search_Contact_Save_Btn_xp,"Save Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
				mContactDataUI.get(i).put(1,"AutoContactFirstName"+i+"_"+sNameRandom);
				mContactDataUI.get(i).put(2,"AutoContactLastName"+i);
				//mContactDataUI.get(i).put(3,"AutoTitle"+i);
				//mContactDataUI.get(i).put(4,sContactPhone);
				//Fax Number depreciated
				//mContactDataUI.get(i).put(5,sContactFax);
				//mContactDataUI.get(i).put(5,"automail"+i+"@email.com");
				mContactDataUI.get(i).put(3,sDealTitleUI.toUpperCase());
				if(i==1)
				{
					
			   objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_MainIdentifier_1_xp,"Main Contact",true,true);
			   objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_1,"Receive Invoice",true,true);
			   objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil,"Edit Pencil",true,true);
			   objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_DeleteIcon_1_xp,"Delete Contact",true,true);
			
			   objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil,"Edit Pencil",true);
 			   String FirstNameValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp)).getAttribute("value");
 			   objGenericFunctionLibrary.fnVerifyLabelMsgText("AutoContactFirstName"+i+"_"+sNameRandom,FirstNameValue);
 			   String LastNameValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp)).getAttribute("value");
 			   objGenericFunctionLibrary.fnVerifyLabelMsgText("AutoContactLastName1",LastNameValue);
 			   String TitleValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp)).getAttribute("value");
 			   objGenericFunctionLibrary.fnVerifyLabelMsgText("AutoTitle1",TitleValue);
 			   //String PhoneValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_Phone_xp)).getAttribute("value");
 			   //objGenericFunctionLibrary.fnVerifyLabelMsgText("(248) 789-8989",PhoneValue);
 			   String EmailValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_email_xp)).getAttribute("value");
 			   objGenericFunctionLibrary.fnVerifyLabelMsgText("automail1@email.com",EmailValue);
 			   objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_cancel_xp,"Cancel", true);
 			   Thread.sleep(4000);
		
		      }
		     if(i==2)
		    {
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_2,"Receive Invoice",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_MainIdentifier_2_xp,"Main Contact2",true,false);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil_2,"Edit Pencil",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_DeleteIcon_2_xp,"Delete Contact",true,true);
		    }if(i==3)
		    {
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil_3,"Edit Pencil",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_DeleteIcon_3_xp,"Delete Contact",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_3,"Receive Invoice",true,true);
		    }
		     if(i==4)
		    {
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil_4,"Edit Pencil",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_DeleteIcon_4_xp,"Delete Contact",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_4,"Receive Invoice",true,false);
		    }
		
			  }
			     }
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2019","Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
		   
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
				
				
			if(MultiSearch==true)
			      {
					    {
					    String sQuery4 = objSQLConfig.sDealSearchContact_Query;
					    sQuery4 = sQuery4.replaceAll("deal_title_param",sDealTitleUI);
					    fnVerifyMultiContactsAddresses(sQuery4,mContactDataUI,"Contacts");
						/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
						HashMap<Integer, HashMap<Integer, String>> mContactTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
					    }   
			       }  
					
					    String sQuery3 = objSQLConfig.sDeals_AddDealProject_Query;
					    sQuery3 = sQuery3.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
						TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
						
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
						String sProjectNameDB = mTableDataDB3.get(1).get(1).toString().trim();
						//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
						String sDealTitle = mTableDataDB3.get(1).get(6).toString().trim();
						
						if(sProjectName.equalsIgnoreCase(sProjectNameDB)&& sDealTitleUI.equalsIgnoreCase(sDealTitle))
						{	
							//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
						}
						else
						{
							obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation failed for deal title : "+ sDealTitleUI, "Fail");
						}
					
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealMultiSearchScenario --------------Failed");    
	   TestDriver.log.error("fnAddDealMultiSearchScenario failed",e);
	   }
		
		return sDealTitleUI;
 }
	public String fnAddDealAccount(int iCostCenter, String sCostCenterUI) throws Exception
	
	{
		String sDealTitleUI ="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));

            String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sDealTitleRandom);
			
			sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;
			//sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			
			String sProjectName= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
			//String sCustomerUI="AUTOTESTDEALCUSTOMER";
			String sFirstName="AutoTestFirstName"+sRandom;
			String sLastName="AutoTestLastName"+sRandom;
			String sContactTitleUI="AutoTitle"+sRandom;
			String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
			String sphoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
			String sContactPhone ="248"+sphoneRandom;
			String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		  
		    Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 

			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
						
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			
			/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			
			//////////////////////////
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			/////////////////////////////
			*/
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
			/*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
			Thread.sleep(10000);*/
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle", "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
			objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
		   /* try {
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
				String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
   
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				
				if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
				}
				else
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				}
				
				//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
			} catch (Exception e) {
				// TODO Auto-generated catch block
				obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				e.printStackTrace();
			}*/
	        
		/*	HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
			System.out.println("Hello");
			String sTempDealnumber= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText().trim();
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				String sDealNumberUI = mTableDataUI.get(i).get(2).toString();
				
				if(sDealNumberUI.equalsIgnoreCase(sTempDealnumber))
				{
					obj.repAddData( "Verify :" +sTempDealnumber,   " should  be displayed in table.", sTempDealnumber + " displayed in table.", "Pass");
					 System.out.println("success");
					 break;
				}
				
			}	
		*/
				
		   
			
			String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
			
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccount --------------Failed");    
	   TestDriver.log.error("fnAddDealAccount failed",e);
	   }
		
		return sDealTitleUI;
}
public String fnAddDealAccountWithCustomerCode(int iCostCenter, String sCostCenterUI) throws Exception
	
	{
		String sDealTitleUI ="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));

            String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sDealTitleRandom);
			
			sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;
			//sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			
			String sProjectName= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
			//String sCustomerUI="AUTOTESTDEALCUSTOMER";
			String sFirstName="AutoTestFirstName"+sRandom;
			String sLastName="AutoTestLastName"+sRandom;
			String sContactTitleUI="AutoTitle"+sRandom;
			String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
			String sphoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
			String sContactPhone ="248"+sphoneRandom;
			String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		  
		    Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 

			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
						
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			
			/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			
			//////////////////////////
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			/////////////////////////////
			*/
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_CustomerCodexpath,"CENTL");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
			/*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
			Thread.sleep(10000);*/
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle", "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
			objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
		   /* try {
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
				String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
   
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				
				if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
				}
				else
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				}
				
				//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
			} catch (Exception e) {
				// TODO Auto-generated catch block
				obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				e.printStackTrace();
			}*/
	        
		/*	HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
			System.out.println("Hello");
			String sTempDealnumber= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText().trim();
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				String sDealNumberUI = mTableDataUI.get(i).get(2).toString();
				
				if(sDealNumberUI.equalsIgnoreCase(sTempDealnumber))
				{
					obj.repAddData( "Verify :" +sTempDealnumber,   " should  be displayed in table.", sTempDealnumber + " displayed in table.", "Pass");
					 System.out.println("success");
					 break;
				}
				
			}	
		*/
				
		   
			
			String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
			
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccount --------------Failed");    
	   TestDriver.log.error("fnAddDealAccount failed",e);
	   }
		
		return sDealTitleUI;
}
public String fnAddBulkDealAccount(int iCostCenter, String sCostCenterUI,String sDealsize,boolean AddCustomer, boolean SearchCustomer, boolean CreditNotification,String department) throws Exception
	
	{
		String sDealTitleUI ="";
		String sCustomerName ="";
		String sSuccessMsg="";
		String sCustomer ="";
		try
		{
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			//sDealTitleUI = "AutoTestDeal_"+sRandom;
			sDealTitleUI = "AUTOTESTDEAL_"+"AUTOTESTCOUNT_"+"DEALS"+"AUTOTESTDEAL_"+sRandom;
			String sSingleErrorDealTitleUI = "AUTOTESTDEAL_"+"AUTOTESTCOUNT_"+"DEALS"+"AUTOTESTDEALS_"+sRandom;
			
			String sbulkErrorDealTitle="AUTOTESTDEAL_"+"AUTOTESTCOUNT_"+"DEALS"+"AUTOTESTDEALS";
			String sBulkDealTitle="AutoTestDeal_"+sRandom;
			//sDealTitleUI = "Deal update validation";
			String sProjectNameUI="AutoProject"+sRandom;
			String sProjectClusterUI="Cluster";
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			//String sCreditLimitUI=sRandom+".00";
			//String sCustomerUI="AUTOTESTDEALCUSTOMER";
			String sFirstName="AutoTestFirstName"+sRandom;
			String sLastName="AutoTestLastName"+sRandom;
			String sContactTitleUI="AutoTitle"+sRandom;
			String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
			String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
			String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
			String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		    String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
		   
			Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			
			if(CreditNotification==true)
			{
			sCustomer= fnAddCustomer(sCustomer, "Add");
			System.out.println(sCustomer);
			fnClickSubMenuElement("Customers Master","Customers");
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_ViewCustomersModule_Table_xp)));
			Thread.sleep(3000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
			Thread.sleep(4000);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sCustomer, "Search Box");
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(3000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row",true);
			Thread.sleep(3000);	
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_EditCustomer_LabelEditCustomerTitle_xp)));
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_EditCustomer_LabelEditCustomerTitle_xp);
		    
			String sCustomerLabel =TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_EditCustomer_LabelEditCustomerTitle_xp)).getText().trim();
			String []arrCustomer = sCustomerLabel.split(" ");
	        String ActualTitle = arrCustomer[1].toString().replace("Customer","").trim();
	        System.out.println(ActualTitle);
	       
	        objGenericFunctionLibrary.fnVerifyLabelMsgText(sCustomer, ActualTitle.trim());
			
	        objGenericFunctionLibrary.ClickByXpath(SphereModules.Customers_CreditApprovalNotification_View_Btn_xp,"View",true);
	        objGenericFunctionLibrary.fnLoadingPageWait();
	        objGenericFunctionLibrary.fnCloseOpenedForm();
			WebElement ele =TestDriver.driver.findElement(By.xpath(SphereCommon.Customers_CreditApprovalNotification_Title_xp));
			objGenericFunctionLibrary.HighlightElement(ele);
			Thread.sleep(2000);
			String sCreditApprovalTitleMessage = AppMessages.Customers_CreditApprovalNotification_Title_msg.toString().trim();
			
			if( objGenericFunctionLibrary.CheckTextOnPage(sCreditApprovalTitleMessage))
			{
				obj.repAddData( "Verify Credit Approval notification page", "Credit Approval notification page should be loaded", "Credit Approval notification page loaded successfully with Title : "+sCreditApprovalTitleMessage, "Pass");
			}
			 objGenericFunctionLibrary.ClickByXpath(objSphereModules.Customers_CreditApprovalNotification_CreateDeal_xp,"Create Deal",true);				
			 System.out.println("Hello");
			 objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			}
			else
			{
			fnClickMainMenuElement("Deals");
			WebDriverWait wait = new WebDriverWait(TestDriver.driver, 80);
			//wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			}
			
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
			
			if(department.equalsIgnoreCase("NonMultiDept"))
			{
				
				objGenericFunctionLibrary.fnCheckFieldDoesNotExistByXpath(objSphereModules.Deals_DealNumber_xp, "Deal Number", true);	
			}
			
			if(AddCustomer==true)
			{				
			sCustomerName=fnDealAddCustomer(sCustomerName, "Add",false,0,false,0);
			System.out.println(sCustomerName);
			}
			if(SearchCustomer==true)
			{
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			}
			if(CreditNotification==true)
			{
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_Deal_customer_xp,sCustomer,true,true);
    			Thread.sleep(3000);
			
			}
			Thread.sleep(3000);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			Thread.sleep(3000);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			Thread.sleep(3000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine1_id, sAddr1UI, "Alternate Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine2_id, sAddr2UI, "Alternate Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine3_id, sAddr3UI, "Alternate Address Line 3");
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCountry_xp,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboState_xp,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputCity_xp, sCityUI, "Alt City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputZipId_id, sZipUI, "Alt Zip");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Save_xp,"Add Alternate Address Button",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_NumberOfDeals_ToolTip,"Tool Tip",true,true);
			/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_NumberOfDeals_ToolTip,"Tool Tip",true);
			String sToolTipMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_NumberOfDeals_ToolTip)).getText().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_NumberOfDeals_ToolTip);
			System.out.println(sToolTipMsg);
			String sExpTipMsg = AppMessages.Deals_AddDeal_NumberOfDeals_ToolTip_Msg;
			objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpTipMsg, sToolTipMsg.trim());*/
			
			////////////Verify Default Deal Number//////////////
			
			String ExpDealNumber="1";
			String NumberOfDeals=TestDriver.driver.findElement(By.id(SphereModules.Deals_NumberOfDeals_id)).getAttribute("value");
			objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpDealNumber,NumberOfDeals);
			
			//////////////Validating error message for more than 50 number selection////////////////////
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_NumberOfDeals_id, "51", "Number of Deals");
			String sDealErrorMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_NumberOfDeals_ErrorMessage)).getText().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_NumberOfDeals_ErrorMessage);
			Thread.sleep(4000);
			String sExpDealErrorMsg = AppMessages.Deals_AddDeal_NumberOfDeals_Error_Msg;
			objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpDealErrorMsg, sDealErrorMsg.trim());
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_NumberOfDeals_id, sDealsize, "Number of Deals"); 
			Thread.sleep(4000); 
			
			////////////////////////Validating Deal Title Error Message for deal size more than 2/////////////////////////////////
			
			if(Integer.valueOf(sDealsize)!=1 && Integer.valueOf(sDealsize)>1)
			{
				if(department.equalsIgnoreCase("MultiDept"))
				{
					objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Deals_DealNumber_xp, "Deal Number", true,true);
					objGenericFunctionLibrary.fnCheckfieldDisbleByXPath(SphereModules.Deals_DealNumber_xp, "Deal Number");
				
				}

			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sbulkErrorDealTitle, "Deal Title");
			String sBulkDealTitleErrorMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Title_Length_ErrorMessage)).getText().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Title_Length_ErrorMessage);
			Thread.sleep(4000);
			String sExpBulkDealTitleErrorMsg = AppMessages.BulkDeals_Title_Length_ErrorMessage_Msg;
			objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpBulkDealTitleErrorMsg, sBulkDealTitleErrorMsg.trim());
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, " ", "Deal Title");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sBulkDealTitle, "Deal Title");
			}
			else
				if(sDealsize.equals("1"))
			{
					
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sSingleErrorDealTitleUI, "Deal Title");
					String singleDealTitleErrorMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Title_Length_ErrorMessage)).getText().trim();
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Title_Length_ErrorMessage);
					Thread.sleep(4000);
					String sExpSingleDealTitleErrorMsg = AppMessages.SingleDeal_Title_Length_ErrorMessage_Msg;
					objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpSingleDealTitleErrorMsg, singleDealTitleErrorMsg.trim());
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, " ", "Deal Title");
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sBulkDealTitle, "Deal Title");
			}
			
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);*/
			Thread.sleep(10000);
			
			/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle", "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "2484621245", "Phone Number");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
			objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			objGenericFunctionLibrary.fnLoadingPageWait();*/
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");*/
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
		    if(sDealsize.equals("1"))
			{

			if(TestDriver.driver.findElement(By.xpath(SphereModules.Common_View_Modules_Table_FirstRow_xp)).getText().equals(sBulkDealTitle))
		    {
			 
			if(!sBulkDealTitle.contains("EP"))
			{
				
				obj.repAddData("Verify Deal title Text", "Deal title text should not contain EP","Deal title not contains EP", "Pass");
		    }
			else
		    {
		    	obj.repAddData("Verify Deal title Text", "Deal title text should not contain EP","Deal title contains EP", "Fail");
		    }
		    
		    } 
		   
			String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		   
			sQuery = sQuery.replaceAll("deal_title_param",sBulkDealTitle);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			
			String sDealNumber = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitle = mTableDataDB.get(1).get(2).toString().trim();
			String sDealType = mTableDataDB.get(1).get(3).toString().trim();
			String CustomerName = mTableDataDB.get(1).get(4).toString().trim();
			
			//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			if(sBulkDealTitle.equalsIgnoreCase(sDealTitle)&&
				sDeal_TypeUI.equalsIgnoreCase(sDealType)&&
				sCustomerUI.equalsIgnoreCase(CustomerName))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitle, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitle +" and Deal Number : "+sDealNumber, "Validation successful for deal title : "+ sDealTitle+" and Deal Number : "+sDealNumber, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitle, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitle, "Validation failed for deal title : "+ sDealTitle, "Fail");
			}
			
            
			obj.repAddData( "QueueLogging page Validation", "", "", "");
			
			fnClickSubMenuElement("Administration","Queue Logging");
			WebDriverWait wait = new WebDriverWait(TestDriver.driver, 60);
			wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_ViewQueueLogging_Table_xp)));
			
			Boolean bResultFlag = false;
			int failedsystems=0;
			
			String ExpStatus="COMPLETE";
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sDealNumber , "Search Box");
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
			Thread.sleep(4000);
			if(TestDriver.driver.findElements(By.xpath(SphereModules.Queuelogging_DealNumber_xp)).size()>0==true)
			{
				System.out.println(TestDriver.driver.findElements(By.xpath(SphereModules.Queuelogging_DealNumber_xp)).size());
			String TableXPath=objSphereModules.Common_ViewQueueLogging_Table_xp;
			HashMap<Integer, HashMap<Integer, String>> mTableData = objGenericFunctionLibrary.fnGetQueueTableData(TableXPath);
			
			String sQuery1 = objSQLConfig.sBulkDealsQueuelogging_Query;
			sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumber);
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			
			for(int i=1;i<=mTableData.size(); i++)
			{
				bResultFlag = false;
				//String sTimestampUI = mTableDataUI.get(i).get(1).toString().trim();
				//System.out.println("UI Timestampvalue\t:"+ sTimestampUI);
				
				String sStatusUI = mTableData.get(i).get(1).toString().trim();
				System.out.println("UI statusvalue\t:"+ sStatusUI);
				
				String Customer = mTableData.get(i).get(2).toString().trim();
				System.out.println("UI customervalue\t:"+ Customer);
				
				String sSystemDealUI=mTableData.get(i).get(3).toString();
				System.out.println("UI Deal value\t:"+ sSystemDealUI);
				
				String sSystemnameUI=mTableData.get(i).get(5).toString();
				System.out.println("UI Systemname value\t:"+ sSystemnameUI);
				
				if(sStatusUI.equals(ExpStatus))
				{
					obj.repAddData( "Verify Deal Status for  Deal Number: "+sSystemDealUI, " Deal Status should be complete for: "+sSystemnameUI, " Deal Status is " +sStatusUI  , "Pass");
				}
				else
				{
					obj.repAddData( "Verify Deal Status for Deal Number : "+sSystemDealUI,  " Deal Status should be complete for: "+sSystemnameUI," Deal Status is " +sStatusUI , "Fail");
				}
				
				
				for(int k=1; k<=mTableDataDB.size();k++)
                {
					String sTimestampDB = mTableDataDB1.get(k).get(1).toString().trim();
					System.out.println("DB Timestampvalue\t:"+ sTimestampDB);
					
					String sStatusDB = mTableDataDB1.get(k).get(2).toString().trim();
					System.out.println("DB statusvalue\t:"+ sStatusDB);
					
					String sCustomerDB = mTableDataDB1.get(k).get(3).toString().trim();
					System.out.println("DB customervalue\t:"+ sCustomerDB);
					
					String sSystemDealDB=mTableDataDB1.get(k).get(4).toString();
					System.out.println("DB Deal value\t:"+ sSystemDealDB);
					
					String sSystemnameDB = mTableDataDB1.get(k).get(6).toString().trim();
					System.out.println("DB systemNamevalue\t:"+ sSystemnameDB);
					
					if((sSystemnameUI.equalsIgnoreCase(sSystemnameDB))
						&&(sSystemDealUI.equalsIgnoreCase(sSystemDealDB))
						//&&(sCustomerUI.equalsIgnoreCase(sCustomerDB))
						//&&(sTimestampUI.equalsIgnoreCase(sTimestampDB))
						&&(sStatusUI.equalsIgnoreCase(sStatusDB)))
					
					{
						bResultFlag = true;
					    System.out.println(i+" record matched");
					    break;
					}
                } //End of i loop
				//break;
				if(bResultFlag == false)
				{
					failedsystems++;
					System.out.println(i+" record not matched");
					System.out.println(sSystemnameUI+ " "+ sSystemDealUI);
					obj.repAddData( "Compare record for Queue logging record : ", "Record on UI and DB should match for Queue logging : ", "Validation failed for  : \t systemname: "+sSystemnameUI, "Fail");
				}
			      
			}
			 //End of j loop
			
			if(failedsystems==0)
			{
				{
					obj.repAddData( "Compare all "+mTableData.size()+" queuelogging records displayed on the screen", "All queuelogging records on UI should match with DB records", "UI and DB validation successful for all queuelogging  records", "Pass");
				}
				
			}
			else if(failedsystems>0)
			{
					
				{
					obj.repAddData( "Compare all "+mTableData.size()+" queuelogging records displayed on the screen", "All queuelogging records on UI should match with DB records", "UI and DB validation failed for all queuelogging  records", "Fail");
				}
					
			}
			  
			         objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		      
	    	}//added new loop
			else
			{
				obj.repAddData( "Verify deal details on queuelogging screen", "Queuelogging table is not populated with deal details", "Queuelogging screen validation failed", "Fail");
			}
			
			
		}
		    else if(Integer.parseInt(sDealsize)>1)
				{
				
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_BulkDeal_yes,"Yes Button", true);
				WebElement yesBtnele=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_BulkDeal_yes));
				yesBtnele.click();		
				
				//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
				//sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
				sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Common_AddEditModules_MsgSuccess_xp)).getText();
				
				String [] arrClassName = sSuccessMsg.split(" ");
		        String sfirstDealNumber = arrClassName[2].toString().trim();
		        String slastDealNumber = arrClassName[4].toString().trim();
				//objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Common_AddEditModules_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				List<String> lsExpDealNumbersUI = new ArrayList<String>();
				
				while (!lsExpDealNumbersUI.contains(slastDealNumber))
				{
					   lsExpDealNumbersUI.add(sfirstDealNumber);
					   sfirstDealNumber=String.valueOf((Integer.parseInt(sfirstDealNumber)+1));
				}
				
				/*if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
				}
				else
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				}*/
				
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp,"Success Message", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_MsgSuccess_xp,"Success Message", true);
			
			//WebElement successMsgele=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp));
			//successMsgele.click();
			
			//objGenericFunctionLibrary.fnVerifyClickSuccessMessage();/////added to click on error message on UI
			
			HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
			System.out.println("Hello");
			WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_ViewDealModule_Table_xp));
			List<WebElement> arrTableRows = eleTable.findElements(By.xpath("./tr"));  //Get the table data rows
			String sTableXPath=objSphereModules.Common_ViewDealModule_Table_xp;
			System.out.println("Data Rows Size>>>>"+arrTableRows.size());
			
			List<String> lsDealNumbersUI = new ArrayList<String>();
			
			for(int i=1;i<arrTableRows.size();i++)  //Exclude first header row 
			{	
			
				String sColValue=TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+2+"]")).getText().trim();
				
				if(lsExpDealNumbersUI.contains(sColValue)==true)
				{
				lsDealNumbersUI.add(sColValue);
				}
			 
			}
			Collections.sort(lsDealNumbersUI);
			Collections.sort(lsExpDealNumbersUI);
	
			
			System.out.println(lsDealNumbersUI);
			System.out.println(lsExpDealNumbersUI);
			int actdealsize=lsExpDealNumbersUI.size();
			
			
			if(lsDealNumbersUI.equals(lsExpDealNumbersUI)==true)
			{
				obj.repAddData( "Verify created Deal Numbers in Table", " Dealnumbers should  be displayed in table."," DealNumbers displayed in table.", "Pass");	
			}
			
			else
			{
				obj.repAddData( "Verify created Deal Numbers in Table", " Dealnumbers should  be displayed in table."," DealNumbers not displayed in table.", "Fail");
			}
		      ///////////////////////////////Verifying the Deal Title Text//////////////////////	
			
			
			obj.repAddData( "Bulk created Deal Title text Validation", "", "", "");
			
			for(int j=0;j<=lsExpDealNumbersUI.size()-1;j++)
	    	{
	    		
			String sExpDealNumber = lsExpDealNumbersUI.get(j);
	    		
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				boolean bDealValidation = false;
				
				String sDealNumberUI = mTableDataUI.get(i).get(1).toString();
				String DealTitle=mTableDataUI.get(i).get(2).toString();
				
		    		if(sDealNumberUI.equals(sExpDealNumber))
				   
		    		{
		    			bDealValidation = true;
		    			System.out.println(mTableDataUI.get(i).get(2));
		    			if(mTableDataUI.get(i).get(2).trim().contains("EP "+i))
		    				
		    			{
		    				obj.repAddData( "Verify Deal title text for: "+sDealNumberUI, " Deal Title should contain text : EP "+i, "Deal Title dislayed text EP "+i , "Pass");
		    				System.out.println("record matched for Deal Title");
		    			}
		    			else
		    			{
		    				bDealValidation = false;
		    				obj.repAddData( "Verify Deal title text for: "+sDealNumberUI, "Deal Title should contain text  EP "+i, "Deal Title not displayed text EP "+i, "Fail");
		    			}
		    			
		    			break;	
				     }
					 //obj.repAddData( "Verify :" +sExpDealNumber,   " should  be displayed in table.", sExpDealNumber + " displayed in table.", "Pass");
					// System.out.println("success");
					 }
				
			}
			
		            //////////////////////////DB Validation///////////////////////////////////
			obj.repAddData( "DB validation for bulk created deals", "", "", "");
			
			for(int j=0;j<=lsDealNumbersUI.size()-1;j++)
	    	{
	    	
			String DealNumberUI = lsDealNumbersUI.get(j);
		   
			if(AddCustomer==true)
		    {
			   sCustomerUI=sCustomerName; 
		    }
			if(CreditNotification==true)
			{
				sCustomerUI=sCustomer;
			}
	       
			String sQuery1 = objSQLConfig.sDeals_BulkAddDeal_Query;
		    sQuery1 = sQuery1.replaceAll("deal_number_param",DealNumberUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB1.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB1.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB1.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB1.get(1).get(4).toString().trim();
			
			if(DealNumberUI.equalsIgnoreCase(sDealNumberDB)&& 
			   sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&&
			   sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Number : "+ DealNumberUI, "Deal account record on UI and DB should match for Deal Number : "+ DealNumberUI +" and Deal Number : "+DealNumberUI, "Validation successful for deal title : "+ DealNumberUI+" and Deal Number : "+DealNumberUI, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ DealNumberUI, "Deal account record on UI and DB should match for Deal Title : "+ DealNumberUI, "Validation failed for deal title : "+ DealNumberUI, "Fail");
			}
			
	   	}
			
			/////////////////////////Project Validation//////////////////////////
			
			for(int j=0;j<=lsDealNumbersUI.size()-1;j++)
	    	{
	    	
			String DealNumberUI = lsDealNumbersUI.get(j);
			
			String sQuery2 = objSQLConfig.sDeals_BulkDealProject_Query;
		    sQuery2 = sQuery2.replaceAll("deal_number_param",DealNumberUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
			String sProjectNameDB = mTableDataDB3.get(1).get(1).toString().trim();
			//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
			String sDealNumberDB = mTableDataDB3.get(1).get(7).toString().trim();
			
			if(sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&&
				DealNumberUI.equalsIgnoreCase(sDealNumberDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare project details for Deal Number : "+ DealNumberUI, "Deal project details on UI and DB should match for Deal Number : "+ DealNumberUI, "Project Validation successful for deal number : "+ DealNumberUI, "Pass");
			}
			else
			{
				obj.repAddData( "Compare project details for Deal Number : "+ DealNumberUI, "Deal project details on UI and DB should match for Deal Number : "+ DealNumberUI, "Project Validation failed for deal number : "+ DealNumberUI, "Fail");
			}
	    	
	    	}
			
			////////////////////////////Address Validation/////////////////////
			for(int j=0;j<=lsDealNumbersUI.size()-1;j++)
	    	{
	    	
			String DealNumberUI = lsDealNumbersUI.get(j);
			
			String sQuery3 = objSQLConfig.sBulkDealAddress_Query;
			sQuery3 = sQuery3.replaceAll("deal_number_param",DealNumberUI);
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
			String sAltAddress1DB = mTableDataDB3.get(1).get(2).toString().trim();
			String sAltAddress2DB = mTableDataDB3.get(1).get(3).toString().trim();
			String CityDB=mTableDataDB3.get(1).get(7).toString().trim();
			String ZipDB=mTableDataDB3.get(1).get(8).toString().trim();
			String StateDB=mTableDataDB3.get(1).get(6).toString().trim();		
			String CountryDB=mTableDataDB3.get(1).get(5).toString().trim(); 
			//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
			String DealNumber = mTableDataDB3.get(1).get(9).toString().trim();
					
			if(sAddr1UI.equalsIgnoreCase(sAltAddress1DB)&&
				sAddr2UI.equalsIgnoreCase(sAltAddress2DB)&&
				sCityUI.equalsIgnoreCase(CityDB)&&
				sZipUI.equalsIgnoreCase(ZipDB)&&
				sStateUI.equalsIgnoreCase(StateDB)&&
				sCountryUI.equalsIgnoreCase(CountryDB)&&
				DealNumberUI.equalsIgnoreCase(DealNumber))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare Alternate Address details for Deal Number : "+ DealNumberUI, "Deal Alternate Address details on UI and DB should match for Deal Number : "+ DealNumberUI, "Alternate Address Validation successful for deal number : "+ DealNumberUI, "Pass");
			}
			else
			{
				obj.repAddData( "Compare Alternate Address details for Deal Number : "+ DealNumberUI, "Deal Alternate Address details on UI and DB should match for Deal Number : "+ DealNumberUI, "Alternate Address Validation failed for deal number : "+ DealNumberUI, "Fail");
			}
	    	
	    	}
			
			/////////////////////////Queue logging page verification////////////////////////////////////
			
			obj.repAddData( "QueueLogging page Validation", "", "", "");
			
			fnClickSubMenuElement("Administration","Queue Logging");
			WebDriverWait wait = new WebDriverWait(TestDriver.driver, 60);
			wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_ViewQueueLogging_Table_xp)));
			Boolean bResultFlag = false;
			int failedsystems=0;
			
			for(int j=0;j<=lsDealNumbersUI.size()-1;j++)
	    	{
	    	
			String DealNumberUI = lsDealNumbersUI.get(j);
			String ExpStatus="COMPLETE";
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberUI , "Search Box");
			
			
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
			Thread.sleep(4000);
			if(TestDriver.driver.findElements(By.xpath(SphereModules.Queuelogging_DealNumber_xp)).size()>0==true)
			{
			String TableXPath=objSphereModules.Common_ViewQueueLogging_Table_xp;
			HashMap<Integer, HashMap<Integer, String>> mTableData = objGenericFunctionLibrary.fnGetQueueTableData(TableXPath);
			
			
			String sQuery = objSQLConfig.sBulkDealsQueuelogging_Query;
			sQuery = sQuery.replaceAll("deal_number_param",DealNumberUI);
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			
			for(int i=1;i<=mTableData.size(); i++)
			{
				bResultFlag = false;
				//String sTimestampUI = mTableDataUI.get(i).get(1).toString().trim();
				//System.out.println("UI Timestampvalue\t:"+ sTimestampUI);
				
				String sStatusUI = mTableData.get(i).get(2).toString().trim();
				System.out.println("UI statusvalue\t:"+ sStatusUI);
				
				String Customer = mTableData.get(i).get(3).toString().trim();
				System.out.println("UI customervalue\t:"+ Customer);
				
				String sSystemDealUI=mTableData.get(i).get(4).toString();
				System.out.println("UI Deal value\t:"+ sSystemDealUI);
				
				String sSystemnameUI=mTableData.get(i).get(6).toString();
				System.out.println("UI Systemname value\t:"+ sSystemnameUI);
				
				if(sStatusUI.equals(ExpStatus))
				{
					obj.repAddData( "Verify Deal Status for  Deal Number: "+sSystemDealUI, " Deal Status should be complete for: "+sSystemnameUI, " Deal Status is " +sStatusUI  , "Pass");
				}
				else
				{
					obj.repAddData( "Verify Deal Status for Deal Number : "+sSystemDealUI,  " Deal Status should be complete for: "+sSystemnameUI," Deal Status is " +sStatusUI , "Fail");
				}
				
				
				for(int k=1; k<=mTableDataDB.size();k++)
                {
					String sTimestampDB = mTableDataDB.get(k).get(1).toString().trim();
					System.out.println("DB Timestampvalue\t:"+ sTimestampDB);
					
					String sStatusDB = mTableDataDB.get(k).get(2).toString().trim();
					System.out.println("DB statusvalue\t:"+ sStatusDB);
					
					String sCustomerDB = mTableDataDB.get(k).get(3).toString().trim();
					System.out.println("DB customervalue\t:"+ sCustomerDB);
					
					String sSystemDealDB=mTableDataDB.get(k).get(4).toString();
					System.out.println("DB Deal value\t:"+ sSystemDealDB);
					
					String sSystemnameDB = mTableDataDB.get(k).get(5).toString().trim();
					System.out.println("DB systemNamevalue\t:"+ sSystemnameDB);
					
					if((sSystemnameUI.equalsIgnoreCase(sSystemnameDB))
							&&(sSystemDealUI.equalsIgnoreCase(sSystemDealDB))
							//&&(sCustomerUI.equalsIgnoreCase(sCustomerDB))
							//&&(sTimestampUI.equalsIgnoreCase(sTimestampDB))
							&&(sStatusUI.equalsIgnoreCase(sStatusDB)))
					
					{
						bResultFlag = true;
					    System.out.println(i+" record matched");
					    break;
					}
                } //End of i loop
				//break;
				if(bResultFlag == false)
				{
					failedsystems++;
					System.out.println(i+" record not matched");
					System.out.println(sSystemnameUI+ " "+ sSystemDealUI);
					obj.repAddData( "Compare record for Queue logging record : ", "Record on UI and DB should match for Queue logging : ", "Validation failed for  : \t systemname: "+sSystemnameUI, "Fail");
				}
			      
			}
			 //End of j loop
			
			if(failedsystems==0)
			{
				if(bResultFlag == true)
				{
					obj.repAddData( "Compare all "+mTableData.size()+" queuelogging records displayed on the screen", "All queuelogging records on UI should match with DB records", "UI and DB validation successful for all queuelogging  records", "Pass");
				}
				
			}
			else if(failedsystems>0)
					{
				if(bResultFlag == false)	
					
				{
					obj.repAddData( "Compare all "+mTableData.size()+" queuelogging records displayed on the screen", "All queuelogging records on UI should match with DB records", "UI and DB validation failed for all queuelogging  records", "Fail");
				}
					
			}
			  
			         objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		      
	    	}//added new loop
			else
			{
				obj.repAddData( "Verify deal status on queuelogging screen", "Deal record is not displayed on queuelogging screen", "Verifying Queuelogging screen validation failed", "Fail");
			}
	    	
	    	}
			
	   
			}
		    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, "" , "Search Box");
				
		
		
		
		} catch (Exception e) {
	   System.out.println("fnAddBulkDealAccount --------------Failed");    
	   TestDriver.log.error("fnAddBulkDealAccount failed",e);
	   }
		
		return sDealTitleUI;
}

public String fnAddNewBulkDealAccount(int iCostCenter, String sCostCenterUI,String sDealsize,boolean AddCustomer, boolean SearchCustomer, boolean CreditNotification,String department) throws Exception

{
	String sDealTitleUI ="";
	String sCustomerName ="";
	String sSuccessMsg="";
	String sCustomer ="";
	try
	{
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
		//sDealTitleUI = "AutoTestDeal_"+sRandom;
		sDealTitleUI = "AUTOTESTDEAL_"+"AUTOTESTCOUNT_"+"DEALS"+"AUTOTESTDEAL_"+sRandom;
		String sSingleErrorDealTitleUI = "AUTOTESTDEAL_"+"AUTOTESTCOUNT_"+"DEALS"+"AUTOTESTDEALS_"+sRandom;
		
		String sbulkErrorDealTitle="AUTOTESTDEAL_"+"AUTOTESTCOUNT_"+"DEALS"+"AUTOTESTDEALS";
		//String sBulkDealTitle="AutoTestDeal_"+sRandom;
		String sDate = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
		System.out.println(sDate);
		String sBulkDealTitle="Deal_"+sDate;
		//sDealTitleUI = "Deal update validation";
		String sProjectNameUI="AutoProject"+sRandom;
		String sProjectClusterUI="Cluster";
		String sPoNumberUI = "AutoPONumber_"+sRandom;
		//String sCreditLimitUI=sRandom+".00";
		//String sCustomerUI="AUTOTESTDEALCUSTOMER";
		String sFirstName="AutoTestFirstName"+sRandom;
		String sLastName="AutoTestLastName"+sRandom;
		String sContactTitleUI="AutoTitle"+sRandom;
		String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
		String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
		String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
		String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
	    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
	    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
	    String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
		String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
		String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
		String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
		String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
		String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
		String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
	   
		Date date = new Date();
	    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
		Date dexpiredday = DateUtils.addDays(new Date(), +5);
		SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
		String sEndDateUI2 = sdf.format(dexpiredday);
		
		if(CreditNotification==true)
		{
		sCustomer= fnAddCustomer(sCustomer, "Add");
		System.out.println(sCustomer);
		
		fnClickSubMenuElement("Customers Master","Customers");
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_ViewCustomersModule_Table_xp)));
		Thread.sleep(3000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sCustomer, "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(3000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row",true);
		Thread.sleep(3000);	
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_EditCustomer_LabelEditCustomerTitle_xp)));
		objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_EditCustomer_LabelEditCustomerTitle_xp);
	    
		String sCustomerLabel =TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_EditCustomer_LabelEditCustomerTitle_xp)).getText().trim();
		String []arrCustomer = sCustomerLabel.split(" ");
        String ActualTitle = arrCustomer[1].toString().replace("Customer","").trim();
        System.out.println(ActualTitle);
       
        objGenericFunctionLibrary.fnVerifyLabelMsgText(sCustomer, ActualTitle.trim());
		
        objGenericFunctionLibrary.ClickByXpath(SphereModules.Customers_CreditApprovalNotification_View_Btn_xp,"View",true);
        objGenericFunctionLibrary.fnLoadingPageWait();
        objGenericFunctionLibrary.fnCloseOpenedForm();
		WebElement ele =TestDriver.driver.findElement(By.xpath(SphereCommon.Customers_CreditApprovalNotification_Title_xp));
		objGenericFunctionLibrary.HighlightElement(ele);
		Thread.sleep(2000);
		String sCreditApprovalTitleMessage = AppMessages.Customers_CreditApprovalNotification_Title_msg.toString().trim();
		
		if( objGenericFunctionLibrary.CheckTextOnPage(sCreditApprovalTitleMessage))
		{
			obj.repAddData( "Verify Credit Approval notification page", "Credit Approval notification page should be loaded", "Credit Approval notification page loaded successfully with Title : "+sCreditApprovalTitleMessage, "Pass");
		}
		 objGenericFunctionLibrary.ClickByXpath(objSphereModules.Customers_CreditApprovalNotification_CreateDeal_xp,"Create Deal",true);				
		 System.out.println("Hello");
		 objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
		}
		else
		{
		fnClickMainMenuElement("Deals");
		WebDriverWait wait = new WebDriverWait(TestDriver.driver, 80);
		//wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
		}
		
		fnSelectCostCenter(iCostCenter,sCostCenterUI);
		
		if(department.equalsIgnoreCase("NonMultiDept"))
		{
			
			objGenericFunctionLibrary.fnCheckFieldDoesNotExistByXpath(objSphereModules.Deals_DealNumber_xp, "Deal Number", true);	
		}
		
		if(AddCustomer==true)
		{				
		sCustomerName=fnDealAddCustomer(sCustomerName, "Add",false,0,false,0);
		System.out.println(sCustomerName);
		}
		if(SearchCustomer==true)
		{
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
		}
		if(CreditNotification==true)
		{
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_Deal_customer_xp,sCustomer,true,true);
			Thread.sleep(3000);
		
		}
		
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine1_id, sAddr1UI, "Alternate Address Line 1");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine2_id, sAddr2UI, "Alternate Address Line 2");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine3_id, sAddr3UI, "Alternate Address Line 3");
		objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCountry_xp,sCountryUI);
		objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboState_xp,sStateUI);
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputCity_xp, sCityUI, "Alt City");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputZipId_id, sZipUI, "Alt Zip");
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Save_xp,"Add Alternate Address Button",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
		objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_NumberOfDeals_ToolTip,"Tool Tip",true,true);
		/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_NumberOfDeals_ToolTip,"Tool Tip",true);
		String sToolTipMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_NumberOfDeals_ToolTip)).getText().trim();
		objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_NumberOfDeals_ToolTip);
		System.out.println(sToolTipMsg);
		String sExpTipMsg = AppMessages.Deals_AddDeal_NumberOfDeals_ToolTip_Msg;
		objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpTipMsg, sToolTipMsg.trim());*/
		
		////////////Verify Default Deal Number//////////////
		
		String ExpDealNumber="1";
		String NumberOfDeals=TestDriver.driver.findElement(By.id(SphereModules.Deals_NumberOfDeals_id)).getAttribute("value");
		objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpDealNumber,NumberOfDeals);
		
		//////////////Validating error message for more than 50 number selection////////////////////
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_NumberOfDeals_id, "51", "Number of Deals");
		String sDealErrorMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_NumberOfDeals_ErrorMessage)).getText().trim();
		objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_NumberOfDeals_ErrorMessage);
		Thread.sleep(4000);
		String sExpDealErrorMsg = AppMessages.Deals_AddDeal_NumberOfDeals_Error_Msg;
		objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpDealErrorMsg, sDealErrorMsg.trim());
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_NumberOfDeals_id, sDealsize, "Number of Deals"); 
		Thread.sleep(4000); 
		
		////////////////////////Validating Deal Title Error Message for deal size more than 2/////////////////////////////////
		
		if(Integer.valueOf(sDealsize)!=1 && Integer.valueOf(sDealsize)>1)
		{
			if(department.equalsIgnoreCase("MultiDept"))
			{
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Deals_DealNumber_xp, "Deal Number", true,true);
				objGenericFunctionLibrary.fnCheckfieldDisbleByXPath(SphereModules.Deals_DealNumber_xp, "Deal Number");
			
			}

		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sbulkErrorDealTitle, "Deal Title");
		String sBulkDealTitleErrorMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Title_Length_ErrorMessage)).getText().trim();
		objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_Title_Length_ErrorMessage);
		Thread.sleep(4000);
		String sExpBulkDealTitleErrorMsg = AppMessages.BulkDeals_Title_Length_ErrorMessage_Msg;
		objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpBulkDealTitleErrorMsg, sBulkDealTitleErrorMsg.trim());
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, " ", "Deal Title");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sBulkDealTitle, "Deal Title");
		  
		}
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
		
		/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
		
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
		Thread.sleep(10000);*/
		
		/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle", "Title");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "2484621245", "Phone Number");
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
		objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
		objGenericFunctionLibrary.fnLoadingPageWait();*/
		//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
		//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");*/
		
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
		///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
		
		//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
		
		objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
		
		if(objGenericFunctionLibrary.ElementFound(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id))
		{
		objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
		}
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_BulkDeal_yes,"Yes Button", true);
			WebElement yesBtnele=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_BulkDeal_yes));
			yesBtnele.click();
			Thread.sleep(4000);

			objGenericFunctionLibrary.fnVerifyClickSuccessMessage();
			
			//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
			/*sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
			String [] arrClassName = sSuccessMsg.split(" ");
	        String sfirstDealNumber = arrClassName[2].toString().trim();
	        String slastDealNumber = arrClassName[4].toString().trim();
			objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
			System.out.println(sSuccessMsg);
			List<String> lsExpDealNumbersUI = new ArrayList<String>();
			
			while (!lsExpDealNumbersUI.contains(slastDealNumber))
			{
				   lsExpDealNumbersUI.add(sfirstDealNumber);
				   sfirstDealNumber=String.valueOf((Integer.parseInt(sfirstDealNumber)+1));
			}
			
			if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
			{
				obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
			}
			else
			{
				obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
			}*/
			
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp,"Success Message", true);
		//WebElement successMsgele=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp));
		//successMsgele.click();
		
		objGenericFunctionLibrary.fnVerifyClickSuccessMessage();/////added to click on error message on UI
		
		
	            //////////////////////////DB Validation///////////////////////////////////
		
		obj.repAddData( "DB validation for bulk created deals", "", "", "");
		
		List<String> lsDealAccount = new ArrayList<String>();
		List<String> lsDealNumber = new ArrayList<String>();
	 
		lsDealAccount.add(0,sBulkDealTitle+" EP 1");
		lsDealAccount.add(1,sBulkDealTitle+" EP 2");
		
		
		for(int j=0;j<=lsDealAccount.size()-1;j++)
    	{
    	
		String DealTitleUI = lsDealAccount.get(j);
	   
		if(AddCustomer==true)
	    {
		   sCustomerUI=sCustomerName; 
	    }
		if(CreditNotification==true)
		{
			sCustomerUI=sCustomer;
		}
       
		String sQuery1 = objSQLConfig.sDeals_BulkAddDeal_Query;
	    sQuery1 = sQuery1.replaceAll("deal_title_param",DealTitleUI);//use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealNumberDB = mTableDataDB1.get(1).get(1).toString().trim();
		String sDealTitleDB = mTableDataDB1.get(1).get(2).toString().trim();
		String sDealTypeDB = mTableDataDB1.get(1).get(3).toString().trim();
		String sCustomerNameDB = mTableDataDB1.get(1).get(4).toString().trim();
		
		if(DealTitleUI.equalsIgnoreCase(sDealTitleDB)&& 
		   sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&&
		   sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
		{	
			//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
			obj.repAddData( "Compare deal account record for Deal Number : "+ sDealTitleDB, "Deal account record on UI and DB should match for Deal Number : "+ sDealTitleDB +" and Deal Number : "+sDealTitleDB, "Validation successful for deal title : "+ sDealTitleDB+" and Deal Number : "+sDealTitleDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleDB, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleDB, "Validation failed for deal title : "+ sDealTitleDB, "Fail");
		}
		
		lsDealNumber.add(sDealNumberDB);
    	
    	}
		
		/////////////////////////Project Validation//////////////////////////
		
		for(int j=0;j<=lsDealAccount.size()-1;j++)
    	{
    	
		String DealtitleUI = lsDealAccount.get(j);
		
		String sQuery2 = objSQLConfig.sDeals_BulkDealProject_Query;
	    sQuery2 = sQuery2.replaceAll("deal_title_param",DealtitleUI);//use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	
		String sProjectNameDB = mTableDataDB3.get(1).get(1).toString().trim();
		//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
		String sDealNumberDB = mTableDataDB3.get(1).get(7).toString().trim();
		String sDealtitleDB = mTableDataDB3.get(1).get(6).toString().trim();
		
		if(sProjectName.equalsIgnoreCase(sProjectNameDB)&&
				DealtitleUI.equalsIgnoreCase(sDealtitleDB))
		{	
			//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
			obj.repAddData( "Compare project details for Deal title : "+ DealtitleUI, "Deal project details on UI and DB should match for Deal title : "+ DealtitleUI, "Project Validation successful for deal title : "+ DealtitleUI, "Pass");
		}
		else
		{
			obj.repAddData( "Compare project details for Deal title : "+ DealtitleUI, "Deal project details on UI and DB should match for Deal title : "+ DealtitleUI, "Project Validation failed for deal number : "+ DealtitleUI, "Fail");
		}
    	
    	}
		
		////////////////////////////Address Validation/////////////////////
		for(int j=0;j<=lsDealNumber.size()-1;j++)
    	{
    	
		String DealNumberUI = lsDealNumber.get(j);
		
		String sQuery3 = objSQLConfig.sBulkDealAddress_Query;
		sQuery3 = sQuery3.replaceAll("deal_number_param",DealNumberUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	
		String sAltAddress1DB = mTableDataDB3.get(1).get(2).toString().trim();
		String sAltAddress2DB = mTableDataDB3.get(1).get(3).toString().trim();
		String CityDB=mTableDataDB3.get(1).get(7).toString().trim();
		String ZipDB=mTableDataDB3.get(1).get(8).toString().trim();
		String StateDB=mTableDataDB3.get(1).get(6).toString().trim();		
		String CountryDB=mTableDataDB3.get(1).get(5).toString().trim(); 
		//String sProjectClusterDB = mTableDataDB3.get(1).get(2).toString().trim();
		String DealNumber = mTableDataDB3.get(1).get(9).toString().trim();
				
		if(sAddr1UI.equalsIgnoreCase(sAltAddress1DB)&&
			sAddr2UI.equalsIgnoreCase(sAltAddress2DB)&&
			sCityUI.equalsIgnoreCase(CityDB)&&
			sZipUI.equalsIgnoreCase(ZipDB)&&
			sStateUI.equalsIgnoreCase(StateDB)&&
			sCountryUI.equalsIgnoreCase(CountryDB)&&
			DealNumberUI.equalsIgnoreCase(DealNumber))
		{	
			//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
			obj.repAddData( "Compare Alternate Address details for Deal Number : "+ DealNumberUI, "Deal Alternate Address details on UI and DB should match for Deal Number : "+ DealNumberUI, "Alternate Address Validation successful for deal number : "+ DealNumberUI, "Pass");
		}
		else
		{
			obj.repAddData( "Compare Alternate Address details for Deal Number : "+ DealNumberUI, "Deal Alternate Address details on UI and DB should match for Deal Number : "+ DealNumberUI, "Alternate Address Validation failed for deal number : "+ DealNumberUI, "Fail");
		}
    	
    	}
		
		/////////////////////////Queue logging page verification////////////////////////////////////
		
		obj.repAddData( "QueueLogging page Validation", "", "", "");
		
		fnClickSubMenuElement("Administration","Queue Logging");
		WebDriverWait wait = new WebDriverWait(TestDriver.driver, 60);
		wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_ViewQueueLogging_Table_xp)));
		Boolean bResultFlag = false;
		int failedsystems=0;
		
		for(int j=0;j<=lsDealNumber.size()-1;j++)
		{

			String DealNumberUI = lsDealNumber.get(j);
			String ExpStatus="COMPLETE";

			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberUI , "Search Box");

			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
			Thread.sleep(4000);

			if(TestDriver.driver.findElements(By.xpath(SphereModules.Queuelogging_DealNumber_xp)).size()>0==true)
			{

				String TableXPath=objSphereModules.Common_ViewQueueLogging_Table_xp;
				HashMap<Integer, HashMap<Integer, String>> mTableData = objGenericFunctionLibrary.fnGetQueueTableData(TableXPath);


				String sQuery = objSQLConfig.sBulkDealsQueuelogging_Query;
				sQuery = sQuery.replaceAll("deal_number_param",DealNumberUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);


				for(int i=1;i<=mTableData.size(); i++)
				{
					bResultFlag = false;
					//String sTimestampUI = mTableDataUI.get(i).get(1).toString().trim();
					//System.out.println("UI Timestampvalue\t:"+ sTimestampUI);

					String sStatusUI = mTableData.get(i).get(2).toString().trim();
					System.out.println("UI statusvalue\t:"+ sStatusUI);

					String Customer = mTableData.get(i).get(3).toString().trim();
					System.out.println("UI customervalue\t:"+ Customer);

					String sSystemDealUI=mTableData.get(i).get(4).toString();
					System.out.println("UI Deal value\t:"+ sSystemDealUI);

					String sSystemnameUI=mTableData.get(i).get(6).toString();
					System.out.println("UI Systemname value\t:"+ sSystemnameUI);

					if(sStatusUI.equals(ExpStatus))
					{
						obj.repAddData( "Verify Deal Status for  Deal Number: "+sSystemDealUI, " Deal Status should be complete for: "+sSystemnameUI, " Deal Status is " +sStatusUI  , "Pass");
					}
					else
					{
						obj.repAddData( "Verify Deal Status for Deal Number : "+sSystemDealUI,  " Deal Status should be complete for: "+sSystemnameUI," Deal Status is " +sStatusUI , "Fail");
					}

				}

			}else
		{
			obj.repAddData( "Verify deal status on queuelogging screen", "Deal record is not displayed on queuelogging screen", "Verifying Queuelogging screen validation failed", "Fail");
		}
		
		         objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	      
    	}//added new loop
		
	    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, "" , "Search Box");
			
	} catch (Exception e) {
   System.out.println("fnAddNewBulkDealAccount --------------Failed");    
   TestDriver.log.error("fnAddNewBulkDealAccount failed",e);
   }
	
	return sDealTitleUI;
}

	
public String fnAddDealAccountWithProject(int iCostCenter, String sCostCenterUI) throws Exception
	
	{
		String sDealTitleUI ="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			//sDealTitleUI = "AutoTestDeal_"+sRandom;
			sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			//sDealTitleUI = "Deal update validation";
			
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sProjectNameUI="AutoProject"+sRandom;
			String sProjectClusterUI="AutoCluster"+sRandom;
			String sFirstName="AutoTestFirstName"+sRandom;
			String sLastName="AutoTestLastName"+sRandom;
			String sContactTitleUI="AutoTitle"+sRandom;
			String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
			String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		
			String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		    //String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
		    Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 

			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
		
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
						
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			
			
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			//objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp,"Project Add Button",true,true);
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddProject_InternalProject_xp,"Internal Project",true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddProject_InternalProject_xp,"Internal Project",true);//to uncheck Internal project
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
			Thread.sleep(10000);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
		   
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
				    String sQuery1 = objSQLConfig.sDeals_AddDealProject_Query;
				    sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				
					String sProjectNameDB = mTableDataDB1.get(1).get(1).toString().trim();
					String sProjectClusterDB = mTableDataDB1.get(1).get(2).toString().trim();
					
					if(sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
						obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Project Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
					}
					else
					{
						obj.repAddData( "Compare project details for Deal Title : "+ sDealTitleUI, "Deal project details on UI and DB should match for Deal Title : "+ sDealTitleUI, "Project Validation failed for deal title : "+ sDealTitleUI, "Fail");
					}
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccount --------------Failed");    
	   TestDriver.log.error("fnAddDealAccount failed",e);
	   }
		
		return sDealTitleUI;
}
			
	
	@SuppressWarnings("static-access")
	public void fnVerifyPaginationNumberOptionfields(String sTableXPath,String sFieldNumberXpath, int fieldValue, int expRowsize) throws Exception
	{
	try{
	WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
	waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(sTableXPath)));		
	//Thread.sleep(2000);
	WebElement ele=TestDriver.driver.findElement(By.xpath(sFieldNumberXpath));
	
	objGenericFunctionLibrary.ClickByXpath(sFieldNumberXpath,"Page Number Option " +fieldValue+"" ,true);
	//Thread.sleep(1000);
	waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(sTableXPath)));
	//Thread.sleep(1000);
	System.out.println("Hello");
	WebElement eleTable = TestDriver.driver.findElement(By.xpath(sTableXPath));
	List<WebElement> arrTableRows = eleTable.findElements(By.xpath("./tr"));  //Get the table data rows
	System.out.println("Data Rows Size>>>>"+arrTableRows.size());
	
	if(arrTableRows.size()<=expRowsize)
	{
	obj.repAddData( "Total "+arrTableRows.size()+" records displayed on the screen", " records count should match with " +fieldValue+ " page option", "UI validation  for total records count successful   ", "pass");
		    
	}
	else
	{
	obj.repAddData( "Total "+arrTableRows.size()+" records displayed on the screen", " records count should match with " +fieldValue+ " page option", "UI validation  for total records count not successful   ", "Fail");

	}
		
		}
    catch (Exception e) {
	 System.out.println("fnVerifyPaginationNumberOptionfields --------------Failed");    
	   TestDriver.log.error("fnVerifyPaginationNumberOptionfields failed",e);	
   }			
  
	}

	public String fnDealAddCustomer(String sCustomerName, String sOperation,boolean bMultiContact, int iContactCount, boolean bMultiAddress, int iAddressCount ) throws Exception
	{
		//sCustomerNameUI ="";
		try
		{
			HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			HashMap<Integer, HashMap<Integer, String>> mAltAddressDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sCustomerTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sCustomerTitleRandom);

			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerName = "AUTOTESTCUSTOMER_"+sCustomerTitleRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
				
				
			//String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
				
			
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			//String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddCustomer_xp, "Add Customer Link", true);			
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerName, "Name");
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.CustomersMaster_AddCustomer_CustomerTypeCombo_xp,sCustomerTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_DealCustomer_CustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sRandom+sRandom, "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_Edit_DealCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_Edit_DealCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_Edit_DealCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_Edit_DealCustomer_InputZipId_id, sZipUI, "Zip");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
			/////////////////Adding Customer Address End//////////////////
			if(bMultiContact==true)
			{
				//HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				for(int i=1;i<=iContactCount;i++)
				{
					String sContactPhone = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1000000001, 1999999999));
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle_"+i, "Title");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
					//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFax_xp, sContactFax, "Fax");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email");
					
					//Below two not implemented yet
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxMainContact_xp,"Main Contact Checkbox",true);
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxRecInvoice_xp,"Receive Invoice Checkbox",true);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////

					mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
					mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
					mContactDataUI.get(i).put(3,"AutoTitle_"+i);
					mContactDataUI.get(i).put(4,sContactPhone);
					mContactDataUI.get(i).put(5,sContactFax);
					mContactDataUI.get(i).put(6,"AutoEmail"+sContactFax+"@nbcuni.com");
					
				////////////////////////////////////////////////////////////////////////////////////////
									
				}
				
			}
			
			String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
			String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
			String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
			String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
			String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
			
			String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
			
			if(bMultiAddress==true)
			{		
				for(int i=1;i<=iAddressCount;i++)
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc_"+i, "Alternate Address Description");
					
					//Below two not implemented yet
					//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo1_id, "AutoAltAddnlInfo1_"+i, "Alternate Additional Info 1");
					//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo2_id, "AutoAltAddnlInfo2_"+i, "Alternate Additional Info 2");
					
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAltAddr1UI, "Alternate Address Line 1");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAltAddr2UI+" "+i+"00", "Alternate Address Line 2");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAltAddr3UI+" "+i+"00", "Alternate Address Line 3");
					
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sAltCountryUI);
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sAltStateUI);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sAltCityUI, "Alt City");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sAltZipUI, "Alt Zip");
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////
					
					mAltAddressDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mAltAddressDataUI.get(i).put(1,"AutoAltAddrDesc_"+i);
					mAltAddressDataUI.get(i).put(2,sAltAddr1UI);
					mAltAddressDataUI.get(i).put(3,sAltAddr2UI+" "+i+"00");
					mAltAddressDataUI.get(i).put(4,sAltAddr3UI+" "+i+"00");
					mAltAddressDataUI.get(i).put(5,sAltCountryUI);
					mAltAddressDataUI.get(i).put(6,sAltStateUI);
					mAltAddressDataUI.get(i).put(7,sAltCityUI);
					mAltAddressDataUI.get(i).put(8,sAltZipUI);
					////////////////////////////////////////////////////////////////////////////////////////
					
				}
			}
								
			//Add group code here
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			
			String sCreditLimitUI=sRandom+".00";
			//String sCreditLimitUI=sRandom;
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			
			
			
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				/*try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)).getText();
					
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
					
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.CustomersMaster_AddCustomer_Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
					e.printStackTrace();
					//throw(e);
				}*/
			}
			
			//objGenericFunctionLibrary.fnLoadingPageWait();
		    
		    
		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sDeals_DealsAddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerName);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(5).toString().trim();
						
					String sAddr1DB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(7).toString().trim();
					//String sAddr3DB = mTableDataDB.get(iRow).get(8).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(8).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(11).toString().trim();
					//String sMultEmailDB = mTableDataDB.get(iRow).get(13).toString().trim();
					
					if(sCustomerName.equalsIgnoreCase(sCustomerNameDB) &&
							sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
							sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) &&
							//sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB)&&
							sCreditPermanentDB.equalsIgnoreCase("1"))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerName, "Customer record on UI and DB should match for customer name : "+ sCustomerName, "Validation successful for customer name : "+ sCustomerName, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerName, "Customer record on UI and DB should match for customer name : "+ sCustomerName, "Validation failed for customer name : "+ sCustomerName, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && sAddr2UI.equalsIgnoreCase(sAddr2DB)&& sCountryUI.equalsIgnoreCase(sCountryDB) && sStateUI.equalsIgnoreCase(sStateDB) && sCityUI.equalsIgnoreCase(sCityDB) && sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerName, "Customer address on UI and DB should match for customer name : "+ sCustomerName, "Address validation successful for customer name : "+ sCustomerName, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerName, "Customer address on UI and DB should match for customer name : "+ sCustomerName, "Address Validation failed for customer name : "+ sCustomerName, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sDeals_DealsAddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerName);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerName, "Record should not be added for customer name : "+ sCustomerName, "Record added for customer name : "+ sCustomerName, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerName, "Record should not be added for customer name : "+ sCustomerName, "Record not added for customer name : "+ sCustomerName, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
		} catch (Exception e) {
	   System.out.println("fnDealAddCustomer --------------Failed");    
	   TestDriver.log.error("fnDealAddCustomer failed",e);
	   }
		
		return sCustomerName;
		
	}
	
	public String fnDealAddCustomerwithNoEmail(String sCustomerName, String sOperation,boolean bMultiContact, int iContactCount, boolean bMultiAddress, int iAddressCount ) throws Exception
	{
		//sCustomerNameUI ="";
		try
		{
			HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			HashMap<Integer, HashMap<Integer, String>> mAltAddressDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sCustomerTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
			System.out.println(sCustomerTitleRandom);

			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerName = "AUTOTESTCUSTOMER_"+sCustomerTitleRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
				
				
			//String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
				
			
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			//String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddCustomer_xp, "Add Customer Link", true);			
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerName, "Name");
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.CustomersMaster_AddCustomer_CustomerTypeCombo_xp,sCustomerTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_DealCustomer_CustomerType_id,sCustomerTypeUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sRandom+sRandom, "Phone Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_Edit_DealCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_Edit_DealCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_Edit_DealCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_Edit_DealCustomer_InputZipId_id, sZipUI, "Zip");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
			/////////////////Adding Customer Address End//////////////////
			if(bMultiContact==true)
			{
				//HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				for(int i=1;i<=iContactCount;i++)
				{
					String sContactPhone = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1000000001, 1999999999));
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle_"+i, "Title");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
					//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFax_xp, sContactFax, "Fax");
					//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email");
					
					//Below two not implemented yet
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxMainContact_xp,"Main Contact Checkbox",true);
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxRecInvoice_xp,"Receive Invoice Checkbox",true);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////

					mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
					mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
					mContactDataUI.get(i).put(3,"AutoTitle_"+i);
					mContactDataUI.get(i).put(4,sContactPhone);
					mContactDataUI.get(i).put(5,sContactFax);
					//mContactDataUI.get(i).put(6,"AutoEmail"+sContactFax+"@nbcuni.com");
					
				////////////////////////////////////////////////////////////////////////////////////////
									
				}
				
			}
			
			String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
			String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
			String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
			String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
			String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
			
			String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
			
			if(bMultiAddress==true)
			{		
				for(int i=1;i<=iAddressCount;i++)
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc_"+i, "Alternate Address Description");
					
					//Below two not implemented yet
					//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo1_id, "AutoAltAddnlInfo1_"+i, "Alternate Additional Info 1");
					//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo2_id, "AutoAltAddnlInfo2_"+i, "Alternate Additional Info 2");
					
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAltAddr1UI, "Alternate Address Line 1");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAltAddr2UI+" "+i+"00", "Alternate Address Line 2");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAltAddr3UI+" "+i+"00", "Alternate Address Line 3");
					
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sAltCountryUI);
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sAltStateUI);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sAltCityUI, "Alt City");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sAltZipUI, "Alt Zip");
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////
					
					mAltAddressDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mAltAddressDataUI.get(i).put(1,"AutoAltAddrDesc_"+i);
					mAltAddressDataUI.get(i).put(2,sAltAddr1UI);
					mAltAddressDataUI.get(i).put(3,sAltAddr2UI+" "+i+"00");
					mAltAddressDataUI.get(i).put(4,sAltAddr3UI+" "+i+"00");
					mAltAddressDataUI.get(i).put(5,sAltCountryUI);
					mAltAddressDataUI.get(i).put(6,sAltStateUI);
					mAltAddressDataUI.get(i).put(7,sAltCityUI);
					mAltAddressDataUI.get(i).put(8,sAltZipUI);
					////////////////////////////////////////////////////////////////////////////////////////
					
				}
			}
								
			//Add group code here
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			
			String sCreditLimitUI=sRandom+".00";
			//String sCreditLimitUI=sRandom;
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
			objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
			
			
			
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				/*try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)).getText();
					
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
					
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.CustomersMaster_AddCustomer_Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
					e.printStackTrace();
					//throw(e);
				}*/
			}
			
			//objGenericFunctionLibrary.fnLoadingPageWait();
		    
		    
		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sDeals_DealsAddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerName);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(5).toString().trim();
						
					String sAddr1DB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(7).toString().trim();
					//String sAddr3DB = mTableDataDB.get(iRow).get(8).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(8).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(11).toString().trim();
					//String sMultEmailDB = mTableDataDB.get(iRow).get(13).toString().trim();
					
					if(sCustomerName.equalsIgnoreCase(sCustomerNameDB) &&
							sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
							sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) &&
							//sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB)&&
							sCreditPermanentDB.equalsIgnoreCase("1"))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+",Create");
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerName, "Customer record on UI and DB should match for customer name : "+ sCustomerName, "Validation successful for customer name : "+ sCustomerName, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerName, "Customer record on UI and DB should match for customer name : "+ sCustomerName, "Validation failed for customer name : "+ sCustomerName, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && sAddr2UI.equalsIgnoreCase(sAddr2DB)&& sCountryUI.equalsIgnoreCase(sCountryDB) && sStateUI.equalsIgnoreCase(sStateDB) && sCityUI.equalsIgnoreCase(sCityDB) && sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerName, "Customer address on UI and DB should match for customer name : "+ sCustomerName, "Address validation successful for customer name : "+ sCustomerName, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerName, "Customer address on UI and DB should match for customer name : "+ sCustomerName, "Address Validation failed for customer name : "+ sCustomerName, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sDeals_DealsAddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerName);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerName, "Record should not be added for customer name : "+ sCustomerName, "Record added for customer name : "+ sCustomerName, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerName, "Record should not be added for customer name : "+ sCustomerName, "Record not added for customer name : "+ sCustomerName, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		
		} catch (Exception e) {
	   System.out.println("fnDealAddCustomerwithNoEmail --------------Failed");    
	   TestDriver.log.error("fnDealAddCustomerwithNoEmail failed",e);
	   }
		
		return sCustomerName;
		
	}
	public String fnAddDealWithMultiAdressesContacts(int iCostCenter, String sCostCenterUI,boolean bMultiContact,int iContactCount,boolean bMultiAddress,int iAddressCount) throws Exception
	{
		
		HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
		HashMap<Integer, HashMap<Integer, String>> mAltAddressDataUI = new HashMap<Integer,HashMap<Integer, String>>();
		
		String sDealTitleUI ="";
		//String sCustomerName="";
		try
		{

			String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
			System.out.println(sDealTitleRandom);
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sSalesForceID=sRandom;
			String sCreditLimitUI=sRandom+".00";
			
			String sProjectClusterUI="AutoCluster_"+sRandom;
			String sFirstName="AutoTestFirstName"+sRandom;
			String sLastName="AutoTestLastName"+sRandom;
			String sContactTitleUI="AutoTitle"+sRandom;
			String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
			
			String sProjectName = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
			String sCustomerUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		    String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
		   
		    Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
	
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 

			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
				
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			//////////////////////////
			String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
			String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
			String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
			String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
			String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
			
			String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
			//String sCountryUI = "United States of America (USA)";
			String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
			
			if(bMultiAddress==true)
			{		
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);

				for(int i=1;i<=iAddressCount;i++)

				{

					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);

					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc_"+i, "Alternate Address Description");
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine1_id, sAltAddr1UI, "Alternate Address Line 1");
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine2_id, sAltAddr2UI+" "+i+"00", "Alternate Address Line 2");
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine3_id, sAltAddr3UI+" "+i+"00", "Alternate Address Line 3");

					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCountry_xp,sAltCountryUI);
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboState_xp,sAltStateUI);
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputCity_xp, sAltCityUI, "Alt City");
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputZipId_id, sAltZipUI, "Alt Zip");

					objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Save_xp,"Add Alternate Address Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();

					mAltAddressDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mAltAddressDataUI.get(i).put(1,"AUTOALTADDRDESC_"+i);
					mAltAddressDataUI.get(i).put(2,sAltAddr1UI.toUpperCase());
					mAltAddressDataUI.get(i).put(3,sAltAddr2UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(4,sAltAddr3UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(5,sAltCountryUI.toUpperCase());
					mAltAddressDataUI.get(i).put(6,sAltStateUI.toUpperCase());
					mAltAddressDataUI.get(i).put(7,sAltCityUI.toUpperCase());
					mAltAddressDataUI.get(i).put(8,sAltZipUI.toUpperCase());

				}
			}
			/////////////////////////////
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectName, "Project Name ");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddProject_InternalProject_xp,"Internal",true);
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
			Thread.sleep(10000);
			if(bMultiContact==true)
			{
				//HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				for(int i=1;i<=iContactCount;i++)
				{
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sPhoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
					String sContactPhone ="248"+sPhoneRandom;

					objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "AutoContactFirstName_"+sRandom, "First Name ");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle_"+i, "Title");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
					//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email Address");
					//objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
					if(i==4)
					{
						String sReceiveInvoiceMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_Contact_ReceiveInvoice_Msg_xp)).getText().trim();
						objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_Contact_ReceiveInvoice_Msg_xp);
						System.out.println(sReceiveInvoiceMsg);
						String sExpConfMsg = AppMessages.Deals_AddDeal_Contact_ReceiveInvoice_Msg;
						objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpConfMsg, sReceiveInvoiceMsg.trim());
						objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.Deals_AddDeal_ReceivesInvoice_id,"Receives Invoice");

					}else
					{
						objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
					}

					objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
					mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
					mContactDataUI.get(i).put(3,"AutoTitle_"+i);
					mContactDataUI.get(i).put(4,sContactPhone);
					mContactDataUI.get(i).put(5,"AutoEmail"+sContactFax+"@nbcuni.com");
					mContactDataUI.get(i).put(6,sDealTitleUI.toUpperCase());
					////////////////////////////////////////////////////////////////////////////////////////
				}
			}
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(4000);
		   /* try {
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
				String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
   
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				
				if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
				}
				else
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				}
				
				//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
			} catch (Exception e) {
				// TODO Auto-generated catch block
				obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				e.printStackTrace();
			}
	        
		/*	HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
			System.out.println("Hello");
			String sTempDealnumber= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText().trim();
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				String sDealNumberUI = mTableDataUI.get(i).get(2).toString();
				
				if(sDealNumberUI.equalsIgnoreCase(sTempDealnumber))
				{
					obj.repAddData( "Verify :" +sTempDealnumber,   " should  be displayed in table.", sTempDealnumber + " displayed in table.", "Pass");
					 System.out.println("success");
					 break;
				}
				
			}	
		*/
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(6).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(7).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(9).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(10).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(11).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(12).toString().trim();
			String slot=mTableDataDB.get(1).get(13).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(15).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(16).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(17).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(18).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(19).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(20).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(21).toString().trim();
				
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
		
				if(bMultiContact==true)
				{
					String sQuery2 = objSQLConfig.sDealMultiContact_Query;
					sQuery2 = sQuery2.replaceAll("deal_number_param",sDealNumberDB);
					fnVerifyMultiContactsAddresses(sQuery2,mContactDataUI,"Contacts");
					/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mContactTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
				}
					/////////////////////////////////////Verifying Contacts End//////////////////////////////////////////////////////
					
					///////////////////////////////////////Verifying Alternate Addresses Start//////////////////////////////////////////////////////
				if(bMultiAddress==true)
				{
					
					String sQuery3 = objSQLConfig.sDealAddress_Query;
					sQuery3 = sQuery3.replaceAll("deal_number_param",sDealNumberDB);
					fnVerifyMultiContactsAddresses(sQuery3,mAltAddressDataUI,"Alternate Addresses");
					/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mAltAddressTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
				}	
			
				    
		} catch (Exception e) {
	   System.out.println("fnAddDealWithMultiAdressesContacts --------------Failed");
	   obj.repAddData( "Verify Deal", "New deal should be created", "New deal not created", "Fail");
	   TestDriver.log.error("fnAddDealWithMultiAdressesContacts failed",e);
	   }
		
		return sDealTitleUI;
}
	public String fnAddMultiContactsToExistDeal(int iContactCount,String sDealTitleUI) throws Exception
	
	{
		
		HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
		
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
			Thread.sleep(4000);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sDealTitleUI , "Search Box");
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(4000);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(10000);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact Button",true,true);
			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_ExistContact_First_Row_xp,"Exist Contact",true,true);
			for(int i=1;i<=iContactCount;i++)
			{
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sphoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
					String sContactPhone ="248"+sphoneRandom;
					
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "AutoContactFirstName_"+sRandom, "First Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle_"+i, "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email Address");
			//objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			if(i==1||i==2)
			{
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			}
			////innstead of icontactCount we can give i value as 3 in below if clause////////////
			if(i==3)
			{
				String sReceiveInvoiceMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_Contact_ReceiveInvoice_Msg_xp)).getText().trim();
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_Contact_ReceiveInvoice_Msg_xp);
				System.out.println(sReceiveInvoiceMsg);
				String sExpConfMsg = AppMessages.Deals_AddDeal_Contact_ReceiveInvoice_Msg;
				objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpConfMsg, sReceiveInvoiceMsg.trim());
				objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.Deals_AddDeal_ReceivesInvoice_id,"Receives Invoice");
			
			}/*else
			{
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			}*/
				
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
			mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
			mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
			mContactDataUI.get(i).put(3,"AutoTitle_"+i);
			mContactDataUI.get(i).put(4,sContactPhone);
			mContactDataUI.get(i).put(5,"AutoEmail"+sContactFax+"@nbcuni.com");
			mContactDataUI.get(i).put(6,sDealTitleUI.toUpperCase());
			////////////////////////////////////////////////////////////////////////////////////////
			}
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				Thread.sleep(4000);
					 String sQuery = objSQLConfig.sExistDealContact_Query;
					 sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);  
					 TestDriver.conn = objDBUtility.fnOpenDBConnection();
					 TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					 HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					 objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					 boolean bResultFlag=true;
					 for(int i=1;i<=mContactDataUI.size(); i++)
						{
							String sCustomerName = mContactDataUI.get(i).get(2).toString();
							System.out.println(mContactDataUI.get(i).equals(mTableDataDB.get(i)));
							if(!mContactDataUI.get(i).equals(mTableDataDB.get(i)))
							{
								 bResultFlag = false;
								//obj.repAddData( "Compare "+sModule+" record for customer name : "+ sCustomerName, sModule+ " record on UI and DB should match for customer name : "+ sCustomerName, sModule+ " validation failed for customer name : "+ sCustomerName, "Fail");
								obj.repAddData( "Compare deal contact record","contact on UI and DB should match", " "+i+" validation failed", "Fail");
							}
							
						}
						
						if(bResultFlag == true)
						{
							obj.repAddData( "Compare all "+mTableDataDB.size()+" contacts displayed on the screen", "All contacts on UI should match with DB records", "UI and DB validation successful for all records", "Pass");
						}
						else
						{
							obj.repAddData( "Compare all "+mTableDataDB.size()+" contacts displayed on the screen", "All contacts on UI should match with DB records", "UI and DB validation failed for all records", "Fail");
						}
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, " " , "Search Box");
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(4000);
				   
				    
					/////////////////////////////////////Verifying Contacts End//////////////////////////////////////////////////////
				    
		} catch (Exception e) {
	   System.out.println("fnAddDealWithMultiAdressesContacts --------------Failed");    
	   TestDriver.log.error("fnAddDealWithMultiAdressesContacts failed",e);
	   }
		
		return sDealTitleUI;
}
    public String fnAddDealToVerifyContactIdentifiers(int iContactCount) throws Exception
	
	{
		    HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			String sDealTitleUI ="";
			
			try
			{
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
				sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
				String sPoNumberUI = "AutoPONumber_"+sRandom;
				String sProjectName = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
				String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
				String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
				String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
			    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
			    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
			    //String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
			  
			    Date date = new Date();
			    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
				Date dexpiredday = DateUtils.addDays(new Date(), +5);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
				String sEndDateUI2 = sdf.format(dexpiredday);
		
				fnClickMainMenuElement("Deals");
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
				Thread.sleep(10000); 

				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
							
				fnSelectCostCenter(1,sCostCenterUI);
							
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
				
				
			    objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,"Contact Search Bar",true,true);
			    objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact Button",true,true);
			    
			    
			    for(int i=1;i<=iContactCount;i++)
				{
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sDealContactPhone="2484621245";
		 			String sDealContactPhoneUI="(248) 462-1245";
			   objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			   objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "AutoContactFirstName_"+sRandom, "First Name ");
			   objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
			   objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle_"+i, "Title");
			   objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sDealContactPhone, "Phone Number");
			  //objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			   objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email Address");
			   if(i==1||i==2)
			   {
			   
			   objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			   }
			   objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			   objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			   objGenericFunctionLibrary.fnLoadingPageWait();
			   
			  if(i==1)
			  {
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_MainIdentifier_1_xp,"Main Contact",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_1,"Receive Invoice",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil,"Edit Pencil",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_DeleteIcon_1_xp,"Delete Contact",true,true);
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil,"Edit Pencil",true);
	 			String FirstNameValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText("AutoContactFirstName_"+sRandom,FirstNameValue);
	 			String LastNameValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText("AutoContactLastName_"+sRandom,LastNameValue);
	 			String TitleValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText("AutoTitle_"+i,TitleValue);
	 			String PhoneValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_Phone_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sDealContactPhoneUI,PhoneValue);
	 			String EmailValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_email_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText("AutoEmail"+sContactFax+"@nbcuni.com",EmailValue);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_cancel_xp,"Cancel", true);
	 			Thread.sleep(4000);
			
			 }
			 if(i==2)
			 {
				//objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_1,"Receive Invoice",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_2,"Receive Invoice",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_MainIdentifier_1_xp,"Main Contact1",true,false);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_MainIdentifier_2_xp,"Main Contact2",true,true);
				/////////write code if main contact exist in 2nd contact/////
			
			 }
			 if(i==4)
			 {
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil_4,"Edit Pencil",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_DeleteIcon_4_xp,"Delete Contact",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_ReceiveInvoiceIdentifier_xp_4,"Receive Invoice",true,false);
				
			 }
			
			mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
			mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
			mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
			mContactDataUI.get(i).put(3,"AutoTitle_"+i);
			mContactDataUI.get(i).put(4,sDealContactPhone);
			mContactDataUI.get(i).put(5,"AutoEmail"+sContactFax+"@nbcuni.com");
			mContactDataUI.get(i).put(6,sDealTitleUI.toUpperCase());
			////////////////////////////////////////////////////////////////////////////////////////
			}
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
				
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
			  
					
			    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
			    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
				String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
				String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
				String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
			    
				String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
				String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
				String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
				String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
				String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
				String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
				String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
				String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
				String slot=mTableDataDB.get(1).get(12).toString().trim();
				String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
				String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
				String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
				String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
				String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
				String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
				String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
				String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
				
					//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
				
					if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
				
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
				//objGenericFunctionLibrary.fnLoadingPageWait();
				//Thread.sleep(4000);
				    
		} catch (Exception e) {
	   System.out.println("fnAddDealWithMultiAdressesContacts --------------Failed");    
	   TestDriver.log.error("fnAddDealWithMultiAdressesContacts failed",e);
	   }
		
		return sDealTitleUI;
}
	
	
	
	public String fnAddCustomerDepartmentBiller(String sCustomerNameUI, String sOperation, boolean bMultiContact, int iContactCount, boolean bMultiAddress, int iAddressCount) throws Exception
	{
		//sCustomerNameUI ="";
		String sCreditLimitUI=null;
		try
		{
			
			HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			HashMap<Integer, HashMap<Integer, String>> mAltAddressDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
			if(!sOperation.equalsIgnoreCase("Duplicate"))
			{
				sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
			}
			
			String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
			String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
			
			Date date = new Date();
			//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
			String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
			
			Date dYesterday = DateUtils.addDays(new Date(), -1);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			String sStartDateUI2 = sdf.format(dYesterday);
			
			//String sStartDateUI2= new SimpleDateFormat("yyyy-MM-dd").format(date);
			
			String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
			//String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
			//String sLegalEntityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Legal_Entity").trim();
		
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			
			String sPhoneUI="7349977788";
		
			
			//objBusinessLib.fnClickMainMenuElement("Administration");
			fnClickSubMenuElement("Customers Master","Customers");
			objGenericFunctionLibrary.fnLoadingPageWait();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
			
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
			
			//objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, "Tax Id");
			
			//fnCheckFieldDisplayByXpath(objSphereModules.CustomersMaster_EditCustomer_BtnSave_xp,"Save",true,false);
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
			/*objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
			//objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id, "Collector");
			/*objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
			objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
			
	        //objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "06162016", "Production Start Date");
			//TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp,sRandom+sRandom, "Phone Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sPhoneUI, "Phone Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
			
			/////////////////Adding Customer Address Start//////////////////
			//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
		    
			//Below line is temporary 
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,"ARUBA");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
			//Support Multiple Addresses is by default feature now
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
			
			if(bMultiContact==true)
			{
				//HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				for(int i=1;i<=iContactCount;i++)
				{
					//String sContactPhone = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
					String sContactPhone ="7346788899";
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle_"+i, "Title");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
					//Fax number depreciated
					//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFax_xp, sContactFax, "Fax");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email");
					
					//Below two not implemented yet
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxMainContact_xp,"Main Contact Checkbox",true);
					//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxRecInvoice_xp,"Receive Invoice Checkbox",true);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////

					mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
					mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
					mContactDataUI.get(i).put(3,"AutoTitle_"+i);
					mContactDataUI.get(i).put(4,sContactPhone);
					//Fax Number depreciated
					//mContactDataUI.get(i).put(5,sContactFax);
					mContactDataUI.get(i).put(5,"AutoEmail"+sContactFax+"@nbcuni.com");
					
					////////////////////////////////////////////////////////////////////////////////////////
					
					
				}
				
			}
			
			String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
			String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
			String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
			String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
			String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
			
			String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
			
			if(bMultiAddress==true)
			{		
				for(int i=1;i<=iAddressCount;i++)
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc_"+i, "Alternate Address Description");
					
					//Below two not implemented yet
					//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo1_id, "AutoAltAddnlInfo1_"+i, "Alternate Additional Info 1");
					//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo2_id, "AutoAltAddnlInfo2_"+i, "Alternate Additional Info 2");
					
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAltAddr1UI, "Alternate Address Line 1");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAltAddr2UI+" "+i+"00", "Alternate Address Line 2");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAltAddr3UI+" "+i+"00", "Alternate Address Line 3");
					
					//Below line is temporary
					//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,"ARUBA");
					
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sAltCountryUI);
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sAltStateUI);
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sAltCityUI, "Alt City");
					objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sAltZipUI, "Alt Zip");
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					///////////////////////////////////////////////////////////////////////////////////////
					
					mAltAddressDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
					mAltAddressDataUI.get(i).put(1,"AUTOALTADDRDESC_"+i);
					mAltAddressDataUI.get(i).put(2,sAltAddr1UI.toUpperCase());
					mAltAddressDataUI.get(i).put(3,sAltAddr2UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(4,sAltAddr3UI.toUpperCase()+" "+i+"00");
					mAltAddressDataUI.get(i).put(5,sAltCountryUI.toUpperCase());
					mAltAddressDataUI.get(i).put(6,sAltStateUI.toUpperCase());
					mAltAddressDataUI.get(i).put(7,sAltCityUI.toUpperCase());
					mAltAddressDataUI.get(i).put(8,sAltZipUI.toUpperCase());
					////////////////////////////////////////////////////////////////////////////////////////
					
				}
			}
			
			/////////////////Adding Customer Address End//////////////////
			
			//Add group code here
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button");
			objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerNo_id,"No radio button");
			
			//objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomerMaster_Customer_CreditExpiration_id,"Credit Expiration");
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_EditCustomer_ButtonCreditLimit_xp, "Credit Limit Button", true);
			objGenericFunctionLibrary.fnCheckfieldDisbleById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id,"Credit Limit");
			
			
			if(sOperation.equalsIgnoreCase("Cancel"))
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
			}
			else
			{
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
				//objGenericFunctionLibrary.fnLoadingPageWait();
				
			/*try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)).getText();
					
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.CustomersMaster_AddCustomer_Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
					e.printStackTrace();
					//throw(e);
				}*/
			}
			
			objGenericFunctionLibrary.fnLoadingPageWait();
		    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
		    {
		    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
		    	 int iRow = 1; //for add 
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					if(sOperation.equalsIgnoreCase("Duplicate"))
					{
						iRow = 2; //for duplicate
					}
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
					String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
					String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
					String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
					String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
					String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
					String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
					String sParentCompanyDB = mTableDataDB.get(iRow).get(8).toString().trim();
					
					String sAddr1DB = mTableDataDB.get(iRow).get(9).toString().trim();
					String sAddr2DB = mTableDataDB.get(iRow).get(10).toString().trim();
					String sAddr3DB = mTableDataDB.get(iRow).get(11).toString().trim();
					String sCountryDB = mTableDataDB.get(iRow).get(12).toString().trim();
					String sStateDB = mTableDataDB.get(iRow).get(13).toString().trim();
					String sCityDB = mTableDataDB.get(iRow).get(14).toString().trim();
					String sZipDB = mTableDataDB.get(iRow).get(15).toString().trim();
					String sMultEmailDB = mTableDataDB.get(iRow).get(16).toString().trim();
					String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(17).toString().trim();
					
					if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) && sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB) && sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
					{	
						//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
					
					//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
					if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && sAddr2UI.equalsIgnoreCase(sAddr2DB) && sCountryUI.equalsIgnoreCase(sCountryDB) && sStateUI.equalsIgnoreCase(sStateDB) && sCityUI.equalsIgnoreCase(sCityDB) && sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
					{	
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
					}
					else
					{
						obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
					}
		    }
		    else if(sOperation.equalsIgnoreCase("Cancel"))
		    {
		    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    
			    TestDriver.conn = objDBUtility.fnOpenDBConnection();
			    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				int iTotalRows = 0;
				while(TestDriver.rset.next())
				{
					iTotalRows = iTotalRows+1;
				}
				
				System.out.println(String.valueOf(iTotalRows));
				if(iTotalRows==1)
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
				}
				else
				{
					obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
				}
		    }
		   
		    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		    
		    ///////////////////////////////////////Verifying Contacts Start//////////////////////////////////////////////////////
		    if(bMultiContact==true)
		    {
		    String sQuery = objSQLConfig.sMasterCustomers_MultiContacts_Query;
		    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
		    fnVerifyMultiContactsAddresses(sQuery,mContactDataUI,"Contacts");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mContactTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
		    }
			/////////////////////////////////////Verifying Contacts End//////////////////////////////////////////////////////
			
			
			///////////////////////////////////////Verifying Alternate Addresses Start//////////////////////////////////////////////////////
		    if(bMultiAddress==true)
		    {
			String sQuery = objSQLConfig.sMasterCustomers_MultiAddresses_Query;
			sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			fnVerifyMultiContactsAddresses(sQuery,mAltAddressDataUI,"Alternate Addresses");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mAltAddressTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
		    }
			/////////////////////////////////////Verifying Alternate Addresses End//////////////////////////////////////////////////////
		
		} catch (Exception e) {
	   System.out.println("fnAddCustomer --------------Failed");    
	   TestDriver.log.error("fnAddCustomer failed",e);
	   }
		
		return sCustomerNameUI;
		
	}
	
	 public void fnCheckColumnSorting(String sTableXPath, String sColumnName, int iColNum, String sColXpath, String sortType, String sQuery,String sModule) throws Exception

	 {
		try
		{
			HashMap<Integer, HashMap<Integer, String>>mTableDataUI=null;
			
			////////////////////Sorting Logic////////////////////////////
			SimpleDateFormat formatter = new SimpleDateFormat("MM/dd/yyyy hh:mm:ss  a");
			String DesData=null;
			WebElement arrTBody =TestDriver.driver.findElement(By.xpath(sTableXPath));
			List<WebElement> arrRows = arrTBody.findElements(By.xpath("tr"));  //Get the header

			List<String> arrDFInitialList = new ArrayList<String>();
			List<String> arrInitialList = new ArrayList<String>();
			List<String> arrExpSortedList = new ArrayList<String>();
			List<String> arrActSortedList = new ArrayList<String>();
			List<String> arrDBList=new ArrayList<String>();
			
			if(sortType.equalsIgnoreCase("Asc"))
			{
			
			objGenericFunctionLibrary.ClickByXpath(sColXpath,"SortBtn",true);
			Thread.sleep(4000);
			
			String ActualSortClass=TestDriver.driver.findElement(By.xpath(sColXpath)).getAttribute("class");
			String [] arrClassName = ActualSortClass.split(" ");
	        String sSortBtn= arrClassName[arrClassName.length-1].toString().trim();
	        
	        if(sSortBtn.equalsIgnoreCase("fa-sort-up"))
	       
	        {
	        	obj.repAddData("Verifying ascending sort button", "Ascending sort button should be displayed","Ascending sort button is displayed", "Pass");
	        
			
			
			for(int i=1;i<=arrRows.size();i++)
			{
				String Data=TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				arrDFInitialList.add(Data);
				
			}
			System.out.println(arrDFInitialList);
			
			arrExpSortedList = arrDFInitialList;
			Collections.sort(arrExpSortedList);
			//Collections.reverse(arrExpSortedList);

			System.out.println(arrExpSortedList);
			System.out.println("Initial Expected Sorting Done");
			 
			for(int i=1;i<=arrRows.size();i++)
			{
				String ActData=TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				arrActSortedList.add(ActData);
				
			}
			
			System.out.println("Sorted List Done");
			
			if(arrActSortedList.equals(arrExpSortedList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' field", "'"+sColumnName+"' values should be sorted in ascending order", "'"+sColumnName+"' values are sorted in ascending order", "Pass");
			}
			else
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' field", "'"+sColumnName+"' values should be sorted in ascending order", "'"+sColumnName+"' values are not sorted in ascending order", "Fail");
			}
			
			//sQuery = sQuery.replaceAll("sortType","asc");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			
			for(int i=1;i<=mTableDataDB.size();i++)
			{
				if(sModule.equalsIgnoreCase("SAP Validation"))
				{
				String DBAscData=mTableDataDB.get(i).get(iColNum).toString().trim().toUpperCase();
				arrDBList.add(DBAscData);
			    }
				else
			    {
				String DBAscData=mTableDataDB.get(i).get(iColNum-1).toString().trim().toUpperCase();
				arrDBList.add(DBAscData);
			    }
			
			}
				
			Boolean bResultFlag = true;
			
			if(!arrActSortedList.equals(arrDBList))
			{
				bResultFlag = false;
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are not matched with DB values", "Fail");
			}
					
			if(bResultFlag == true)
			{
				obj.repAddData( "Compare all  records displayed on the screen", "All  records on UI should match with DB records", "UI and DB validation successful for all  records", "Pass");
			}*/
			
			}
	        else
	        {
	        	obj.repAddData("Verifying ascending sort button", "Ascending sort button should be displayed","Ascending sort button is not  displayed", "Fail");
	        
	        }
	       
		}
				
			
			if(sortType.equalsIgnoreCase("Desc"))
			{
			
			arrExpSortedList.clear();
			arrActSortedList.clear();
			arrDBList.clear();
			
			objGenericFunctionLibrary.ClickByXpath(sColXpath,"SortBtn",true);//post condition
			Thread.sleep(4000);
			
			String ActualSortClass=TestDriver.driver.findElement(By.xpath(sColXpath)).getAttribute("class");
			String [] arrClassName = ActualSortClass.split(" ");
	        String sSortBtn= arrClassName[arrClassName.length-1].toString().trim();
	        
	        if(sSortBtn.equalsIgnoreCase("fa-sort-down"))
	       
	        {
	        	obj.repAddData("Verifying descending sort button", "Descending sort button should be displayed","Descending sort button is displayed", "Pass");
	        
			
	        for(int i=1;i<=arrRows.size();i++)
			
	        {
				
				 DesData=TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				 arrInitialList.add(DesData);
				
			}
			System.out.println(arrInitialList);
			arrExpSortedList = arrInitialList;
			Collections.sort(arrExpSortedList);
			Collections.reverse(arrExpSortedList);

			System.out.println(arrExpSortedList);
			System.out.println("Initial Expected Sorting Done");
			
			for(int i=1;i<=arrRows.size();i++)
			{
				String ActData=TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				arrActSortedList.add(ActData);
				
			}
			System.out.println("Sorted List Done");
			
			if(arrActSortedList.equals(arrExpSortedList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in descending order", "'"+sColumnName+"' values are sorted in descending order", "Pass");
			}
			else
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in descending order", "'"+sColumnName+"' values are not sorted in desscending order", "Fail");
			}
			
			//sQuery = sQuery.replaceAll("sortType","desc");
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			
			for(int i=1;i<=mTableDataDB1.size();i++)
			{
				if(sModule.equalsIgnoreCase("SAP Validation"))
				{
				String DBData=mTableDataDB1.get(i).get(iColNum).toString().trim().toUpperCase();
				arrDBList.add(DBData);
			    }
				else
		
			   {
				String DBData=mTableDataDB1.get(i).get(iColNum-1).toString().trim().toUpperCase();
				arrDBList.add(DBData);
					
			   }
				
		   }
			
			Boolean bResultFlag1 = true;
			if(!arrActSortedList.equals(arrDBList))
			{
				bResultFlag1 = false;
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are not matched with DB values", "Fail");
			}
		   
			if(bResultFlag1 == true)
			{
				obj.repAddData( "Compare all  records displayed on the screen", "All  records on UI should match with DB records", "UI and DB validation successful for all  records", "Pass");
			}*/
			
	        }
			
	        else
	        {
	        	obj.repAddData("Verifying descending sort button", "Descending sort button should be displayed","Descending sort button is not displayed", "Fail");
	        
	        }
	       
		}
				
				
	    }catch (Exception e) {
	    System.out.println("fnCheckColumnSorting --------------Failed");    
	    TestDriver.log.error("fnCheckColumnSorting failed",e);
	    }
	 }

@SuppressWarnings("static-access")
	public static String fnVerifyDeptSystems_old(String sDeal)  throws Exception {
			 
		String sMatrixStatus = "";
			     try {
			    	
			    	 String sRentalWorksFlag = fnDBValidationDeptSystems("RentalWorks", sDeal);
			    	 //String sRTProFlag = fnDBValidationDeptSystems("RTPro", sDeal);//Un-comment once onprem get access
			    	 String sRTProFlag = "False"; //Comment once onprem get access
			    	 String sTransWorksFlag = fnDBValidationDeptSystems("TransWorks", sDeal);
			    	 String sScheduALLFlag = fnDBValidationDeptSystems("ScheduALL", sDeal);
			    	 
			    	 
			    	 sMatrixStatus = sRentalWorksFlag+","+sRTProFlag+","+sTransWorksFlag+","+sScheduALLFlag;
			    	
			    } catch (Exception e) {
			    	 System.out.println("fnVerifyDeptSystems --------------Failed");    
					    TestDriver.log.error("fnVerifyDeptSystems failed",e);
			    }
			     
			     return sMatrixStatus;

			}
	 
	@SuppressWarnings("static-access")
	public static String fnDBValidationDeptSystems_old(String sSystem, String sDeal)  throws Exception {
			 
		String  sFlag = "False";
			     try {
			    	//RentalWorks  Select * from deal
			    	 //RTPro       Select * from customer
			    	 //TransWorks  Select * from project
			    	 //ScheduALL   Select * from clnt where clienttype = 0
			    	 
			    	 String sUser = TestDriver.prop.getProperty("deptSystemUser").toString().trim();
			    	 String sPassword = TestDriver.prop.getProperty("deptSystemPassword").toString().trim();
			    	 String sServer = "";
			    	 String sDB = "";
			    	 String sSQLQuery="";
			    	 
			    	 if(sSystem.equalsIgnoreCase("RentalWorks"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("rentalWorksServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("rentalWorksDB").toString().trim();
			    		 //sDeal = ""; //Remove after testing
			    		 sSQLQuery = "select * from dbo.deal where deal='"+sDeal+"'";
			    	 }
			    	 else if(sSystem.equalsIgnoreCase("RTPro"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("rTProServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("rTProDB").toString().trim();
			    		 sSQLQuery = "select * from dbo.customer where deal='"+sDeal+"'";
			    	 }
			    	 else if(sSystem.equalsIgnoreCase("TransWorks"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("transWorksServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("transWorksDB").toString().trim();
			    		 sSQLQuery = "select * from dbo.project where title='"+sDeal+"'";
			    	 }
			    	 else if(sSystem.equalsIgnoreCase("ScheduALL"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("scheduALLServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("scheduALLDB").toString().trim();
			    		 sSQLQuery = "select * from schedwin.CLNT where clienttype = 0 and name='"+sDeal+"'";
			    	 }
			    	 
						//////////////////////////////////////////////////////////////////////////////////
						// Create a variable for the connection string.  
			     
			    //	String connectionUrl = "jdbc:sqlserver://USHDBWQ00039\\Q0136ES02;" +  
				//    "databaseName=URW_QA;user=onprem;password=onprem16";  
			    	
				    String connectionUrl = "jdbc:sqlserver://"+sServer+";" +  
						    "databaseName="+sDB+";user="+sUser+";password="+sPassword;  
				    
				  
				      // Declare the JDBC objects.  
				      Connection con = null;  
				      Statement stmt = null;  
				      ResultSet rs = null;  
				  
				      try {  
				         // Establish the connection.  
				         Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");  
				         con = DriverManager.getConnection(connectionUrl);  
				  
				         // Create and execute an SQL statement that returns some data.  
				       //  String sSQLQuery = "SELECT TOP 10 * FROM dbo.customer where customer='"+sCustomer+"'";  
				         stmt = con.createStatement();  
				         rs = stmt.executeQuery(sSQLQuery);  
				  
				         //Get number of rows
				         int count = 0;

				         while (rs.next()) {
				             ++count;
				             // Get data from the current row and use it
				         }

				         if (count == 0) {
				        	 sFlag = "False";
				             System.out.println("No record found for "+sSystem);
				         }
				         else if(count == 1)
				         {
				        	 sFlag = "True";
				        	 System.out.println("Record found for "+sSystem);
				         }
				         else
				         {
				        	 sFlag = "False";
				        	 System.out.println("Multi Records found for "+sSystem);
				         }
				         
				         // Iterate through the data in the result set and display it.  
				         while (rs.next()) {  
				            System.out.println(rs.getString(2) + " " + rs.getString(9));  
				         }  
				      }  
				  
				      // Handle any errors that may have occurred.  
				      catch (Exception e) {  
				         e.printStackTrace();  
				      }  
				      finally {  
				         if (rs != null) try { rs.close(); } catch(Exception e) {}  
				         if (stmt != null) try { stmt.close(); } catch(Exception e) {}  
				         if (con != null) try { con.close(); } catch(Exception e) {}  
				      }
						
						///////////////////////////////////////////////////////////////////////////////////

			    	
			    } catch (Exception e) {
			    	 System.out.println("fnDBValidationDeptSystems --------------Failed");    
					    TestDriver.log.error("fnDBValidationDeptSystems failed",e);
			    }
				return sFlag;
			}
	
	
	//@SuppressWarnings("static-access")
	public static String fnVerifyDeptSystems(String sDeal)  throws Exception {
			 
		String sMatrixStatus = "";
			     try {
			    	
			    	 String sDeptSystem = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("DeptSystem_Id").trim();
			    	 //String sDeptSystem = TestDriver.sDeptSystem;
			    	 
			    	 String sRentalWorksSLFlag = "";
			    	 String sRTPropFlag = ""; 
			    	 String sTransWorksFlag = "";
			    	 String sScheduALLSoundFlag = "";
			    	 
			    	 if(sDeptSystem.equalsIgnoreCase("RW_SL") || sDeptSystem.equalsIgnoreCase("ALL"))
			    	 {
			    		 sRentalWorksSLFlag = fnDBValidationDeptSystems("RW_SL", sDeal);
			    	 }
			    	 else
			    	 {
			    		 sRentalWorksSLFlag = "NA";
			    	 }
			    	 
			    	 
			    	 if(sDeptSystem.equalsIgnoreCase("RTPROP") || sDeptSystem.equalsIgnoreCase("ALL"))
			    	 {
			    		 sRTPropFlag = fnDBValidationDeptSystems("RTPROP", sDeal);
			    	 }
			    	 else
			    	 {
			    		 sRTPropFlag = "NA";
			    	 }
			    	 
			    	 if(sDeptSystem.equalsIgnoreCase("TW") || sDeptSystem.equalsIgnoreCase("ALL"))
			    	 {
			    		 sTransWorksFlag = fnDBValidationDeptSystems("TW", sDeal);
			    	 }
			    	 else
			    	 {
			    		 sTransWorksFlag = "NA";
			    	 }
			    	 
			    	 if(sDeptSystem.equalsIgnoreCase("SCALL_S") || sDeptSystem.equalsIgnoreCase("ALL"))
			    	 {
			    		 sScheduALLSoundFlag = fnDBValidationDeptSystems("SCALL_S", sDeal);
			    	 }
			    	 else
			    	 {
			    		 sScheduALLSoundFlag = "NA";
			    	 }
			    	 /*//String sRTProFlag = fnDBValidationDeptSystems("RTPro", sDeal);//Un-comment once onprem get access
			    	 String sRTProFlag = "False"; //Comment once onprem get access
			    	 String sTransWorksFlag = fnDBValidationDeptSystems("TransWorks", sDeal);
			    	 String sScheduALLFlag = fnDBValidationDeptSystems("ScheduALL", sDeal);
			    	 */
			    	 
			    	 sMatrixStatus = sRentalWorksSLFlag+","+sRTPropFlag+","+sTransWorksFlag+","+sScheduALLSoundFlag;
			    	
			    } catch (Exception e) {
			    	 System.out.println("fnVerifyDeptSystems --------------Failed");    
					    TestDriver.log.error("fnVerifyDeptSystems failed",e);
			    }
			     
			     return sMatrixStatus;

			}
	 
	@SuppressWarnings("static-access")
	public static String fnDBValidationDeptSystems(String sSystem, String sDeal)  throws Exception {
			 
		String  sFlag = "False";
			     try {
			    	//RentalWorks  Select * from deal
			    	 //RTPro       Select * from customer
			    	 //TransWorks  Select * from project
			    	 //ScheduALL   Select * from clnt where clienttype = 0
			    	 
			    	 String sUser = TestDriver.prop.getProperty("deptSystemUser").toString().trim();
			    	 String sPassword = TestDriver.prop.getProperty("deptSystemPassword").toString().trim();
			    	 String sServer = "";
			    	 String sDB = "";
			    	 String sSQLQuery="";
			    	 
			    	 if(sSystem.equalsIgnoreCase("RW_SL"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("rentalWorksServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("rentalWorksDB").toString().trim();
			    		 //sDeal = ""; //Remove after testing
			    		 sSQLQuery = "select * from dbo.deal where deal='"+sDeal+"'";
			    	 }
			    	 else if(sSystem.equalsIgnoreCase("RTPROP"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("rTProServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("rTProDB").toString().trim();
			    		 sSQLQuery = "select * from dbo.customer where deal='"+sDeal+"'";
			    	 }
			    	 else if(sSystem.equalsIgnoreCase("TW"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("transWorksServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("transWorksDB").toString().trim();
			    		 sSQLQuery = "select * from dbo.project where title='"+sDeal+"'";
			    	 }
			    	 else if(sSystem.equalsIgnoreCase("SCALL_S"))
			    	 {
			    		 sServer =  TestDriver.prop.getProperty("scheduALLServer").toString().trim();
			    		 sDB = TestDriver.prop.getProperty("scheduALLDB").toString().trim();
			    		 sSQLQuery = "select * from schedwin.CLNT where clienttype = 0 and name='"+sDeal+"'";
			    	 }
			    	 
						//////////////////////////////////////////////////////////////////////////////////
						// Create a variable for the connection string.  
			     
			    //	String connectionUrl = "jdbc:sqlserver://USHDBWQ00039\\Q0136ES02;" +  
				//    "databaseName=URW_QA;user=onprem;password=onprem16";  
			    	
				    String connectionUrl = "jdbc:sqlserver://"+sServer+";" +  
						    "databaseName="+sDB+";user="+sUser+";password="+sPassword;  
				    
				  
				      // Declare the JDBC objects.  
				      Connection con = null;  
				      Statement stmt = null;  
				      ResultSet rs = null;  
				  
				      try {  
				         // Establish the connection.  
				         Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");  
				         con = DriverManager.getConnection(connectionUrl);  
				  
				         // Create and execute an SQL statement that returns some data.  
				       //  String sSQLQuery = "SELECT TOP 10 * FROM dbo.customer where customer='"+sCustomer+"'";  
				         stmt = con.createStatement();  
				         rs = stmt.executeQuery(sSQLQuery);  
				  
				         //Get number of rows
				         int count = 0;

				         while (rs.next()) {
				             ++count;
				             // Get data from the current row and use it
				         }

				         if (count == 0) {
				        	 sFlag = "False";
				             System.out.println("No record found for "+sSystem);
				         }
				         else if(count == 1)
				         {
				        	 sFlag = "True";
				        	 System.out.println("Record found for "+sSystem);
				         }
				         else
				         {
				        	 sFlag = "False - Multi records found";
				        	 System.out.println("Multi Records found for "+sSystem);
				         }
				         
				         // Iterate through the data in the result set and display it.  
				         while (rs.next()) {  
				            System.out.println(rs.getString(2) + " " + rs.getString(9));  
				         }  
				      }  
				  
				      // Handle any errors that may have occurred.  
				      catch (Exception e) {  
				         e.printStackTrace();  
				      }  
				      finally {  
				         if (rs != null) try { rs.close(); } catch(Exception e) {}  
				         if (stmt != null) try { stmt.close(); } catch(Exception e) {}  
				         if (con != null) try { con.close(); } catch(Exception e) {}  
				      }
						
						///////////////////////////////////////////////////////////////////////////////////

			    	
			    } catch (Exception e) {
			    	 System.out.println("fnDBValidationDeptSystems --------------Failed");    
					    TestDriver.log.error("fnDBValidationDeptSystems failed",e);
			    }
				return sFlag;
			}
	


	 public void fnCheckDateSorting(String sTableXPath, String sColumnName, int iColNum, String sColXpath, String sortType, String sQuery,String sModule) throws Exception

	 {
		try
		{
			HashMap<Integer, HashMap<Integer, String>>mTableDataUI=null;
			
			////////////////////Sorting Logic////////////////////////////
			
			String sformat="MM/dd/yyyy hh:mm a";
			//String sformat2="yyyy-MM-dd hh:mm:ss";
			SimpleDateFormat format = new SimpleDateFormat(sformat);
			//SimpleDateFormat format2 = new SimpleDateFormat(sformat2);
			String DBData=null;
			String DesData=null;                               
			WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(sTableXPath));
			List<WebElement> arrRows = arrTBodies.findElements(By.xpath("tr"));  //Get the header
			List<Date> arrInitialList = new ArrayList<Date>();
			List<Date> arrExpSortedList = new ArrayList<Date>();
			List<Date> arrActSortedList = new ArrayList<Date>();
			List<Date> arrDFInitialList = new ArrayList<Date>();
			
			List<Date> arrDBList=new ArrayList<Date>();
			if(sortType.equalsIgnoreCase("Asc"))
			{
			
			objGenericFunctionLibrary.ClickByXpath(sColXpath,"SortBtn",true);//post condition
			Thread.sleep(4000);
			Boolean bresultflag1=false;	
			for(int i=1;i<=arrRows.size();i++)
			{

				String sAscExpList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				if(!sAscExpList.equals(""))
				{
				bresultflag1=true;
				sAscExpList = sAscExpList.replace("@ ", "");
				sAscExpList = sAscExpList.replace("PM", " PM");
				sAscExpList = sAscExpList.replace("AM", " AM");
				sAscExpList=new SimpleDateFormat("yyyy-MM-dd HH:mm").format(new SimpleDateFormat("MM/dd/yyyy hh:mm a").parse(sAscExpList));
				arrInitialList.add(new SimpleDateFormat("yyyy-MM-dd HH:mm").parse(sAscExpList));
				}else
			
				{
					   System.out.println("Date is not present in "+i+"th row"); 
				}
			
			}
	
			
			System.out.println(arrInitialList);
			arrExpSortedList = arrInitialList;
			
			Collections.sort(arrExpSortedList);

			System.out.println(arrExpSortedList);
			System.out.println("Initial Expected Sorting Done");
			Boolean bresultflag=false;
			for(int i=1;i<=arrRows.size();i++)
			{
				
				String sActAscList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				if(!sActAscList.equals(""))
				{
				bresultflag=true;
				sActAscList = sActAscList.replace("@ ", "");
				sActAscList = sActAscList.replace("PM", " PM");
				sActAscList = sActAscList.replace("AM", " AM");
				
				Date ActAscList = format.parse(sActAscList);
				arrActSortedList.add(ActAscList);
				}
			  }
			if(bresultflag==false)
			{
				   System.out.println("Date is not present"); 
			}
			
			System.out.println("Sorted List Done");
			
			if(arrActSortedList.equals(arrExpSortedList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in ascending order", "'"+sColumnName+"' values are sorted in ascending order", "Pass");
			}
			else
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in ascending order", "'"+sColumnName+"' values are not sorted in ascending order", "Fail");
			}
			
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			for(int i=1;i<=mTableDataDB.size();i++)
			{
				if(sModule.equalsIgnoreCase("Administration"))
				{
				 DBData=mTableDataDB.get(i).get(iColNum-2).toString().trim().toUpperCase();
				}
				if(!DBData.equals("")){
				 DBData = DBData.replace(".0", "").trim();
				 Date dt =new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse(DBData);
				 Date newDate = DateUtils.addMinutes(dt, 180);
				 Date Date = DateUtils.setSeconds(newDate,0);
				 arrDBList.add(Date);
				
				}
			}
			
			System.out.println(arrActSortedList);
			System.out.println(arrDBList);	
		
			if(arrActSortedList.equals(arrDBList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are matched with DB values", "Pass");
			}else
			
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are not  matched with DB values", "Fail");
			}*/
			
			
			}
			if(sortType.equalsIgnoreCase("Desc"))
			{
			arrExpSortedList.clear();
			arrActSortedList.clear();
			arrDBList.clear();
			
			objGenericFunctionLibrary.ClickByXpath(sColXpath,"SortBtn",true);//post condition
			Thread.sleep(4000);
			
			for(int i=1;i<=arrRows.size();i++)
			{
							
				String sDesExpList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				sDesExpList = sDesExpList.replace("@ ", "");
				sDesExpList = sDesExpList.replace("PM", " PM");
				sDesExpList = sDesExpList.replace("AM", " AM");
				//Date sdtDesExpList = format.parse(sDesExpList);//previous code
				sDesExpList=new SimpleDateFormat("yyyy-MM-dd HH:mm").format(new SimpleDateFormat("MM/dd/yyyy hh:mm a").parse(sDesExpList));
				arrInitialList.add(new  SimpleDateFormat("yyyy-MM-dd HH:mm").parse(sDesExpList) );
				//System.out.println(sDesExpList);
			    //arrInitialList.add(sdtDesExpList);//previous code
			}
			System.out.println(arrInitialList);
			arrExpSortedList = arrInitialList;
			Collections.sort(arrExpSortedList);
			Collections.reverse(arrExpSortedList);

			System.out.println(arrExpSortedList);
			System.out.println("Initial Expected Sorting Done");
			for(int i=1;i<=arrRows.size();i++)
			{
				String sActDesList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				sActDesList = sActDesList.replace("@ ", "");
				sActDesList = sActDesList.replace("PM", " PM");
				sActDesList = sActDesList.replace("AM", " AM");
				
				Date dtActDesList = format.parse(sActDesList);
				//sActDesList=new SimpleDateFormat("yyyy-MM-dd HH:mm").format(new SimpleDateFormat("MM/dd/yyyy hh:mm a").parse(sActDesList));
				//arrInitialList.add(new  SimpleDateFormat("yyyy-MM-dd HH:mm").parse(sActDesList) );
				arrActSortedList.add(dtActDesList);
				
			}
			System.out.println("Sorted List Done");
			
			if(arrActSortedList.equals(arrExpSortedList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in descending order", "'"+sColumnName+"' values are sorted in descending order", "Pass");
			}
			else
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in descending order", "'"+sColumnName+"' values are not sorted in desscending order", "Fail");
			}
			
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				for(int i=1;i<=mTableDataDB1.size();i++)
				{
					if(sModule.equalsIgnoreCase("Administration"))
					{
					DBData=mTableDataDB1.get(i).get(iColNum-2).toString().trim().toUpperCase();
					}
					 DBData = DBData.replace(".0", "").trim();
					 Date dt =new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse(DBData);
					 Date newDate = DateUtils.addMinutes(dt, 180);
					 Date Date = DateUtils.setSeconds(newDate,0);
					 arrDBList.add(Date);	
				}
			
			System.out.println(arrActSortedList);
			System.out.println(arrDBList);
			
			if(arrActSortedList.equals(arrDBList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are matched with DB values", "Pass");
			}else
			
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are not  matched with DB values", "Fail");
			}*/
			
		}
			
				
					
	   }catch (Exception e) {
	    System.out.println("fnCheckDateSorting --------------Failed");    
	    TestDriver.log.error("fnCheckDateSorting failed",e);
	    }
	 }
	 
	 public void fnCheckQueueHubDateSorting(String sTableXPath, String sColumnName, int iColNum, String sColXpath, String sortType, String sQuery,String sModule) throws Exception

	 {
		try
		{
			HashMap<Integer, HashMap<Integer, String>>mTableDataUI=null;
			
			////////////////////Sorting Logic////////////////////////////
			
			String sformat="MM/dd/yyyy hh:mm:ss a";
			//String sformat2="yyyy-MM-dd hh:mm:ss";
			SimpleDateFormat format = new SimpleDateFormat(sformat);
			//SimpleDateFormat format2 = new SimpleDateFormat(sformat2);
			String DBData=null;
			String DesData=null;                               
			WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(sTableXPath));
			List<WebElement> arrRows = arrTBodies.findElements(By.xpath("tr"));  //Get the header

			List<Date> arrInitialList = new ArrayList<Date>();
			List<Date> arrExpSortedList = new ArrayList<Date>();
			List<Date> arrActSortedList = new ArrayList<Date>();
			List<Date> arrDFInitialList = new ArrayList<Date>();
			List<Date> arrDBList=new ArrayList<Date>();
			
			if(sortType.equalsIgnoreCase("Asc"))
			{
			
				objGenericFunctionLibrary.ClickByXpath(sColXpath,"SortBtn",true);//post condition
			    Thread.sleep(4000);
			    Boolean bresultflag1=false;	
			  
			for(int i=1;i<=arrRows.size();i++)
			{
				String sAscExpList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				sAscExpList=new SimpleDateFormat("MM/dd/yyyy HH:mm:ss").format(new SimpleDateFormat("MM/dd/yyyy hh:mm:ss a").parse(sAscExpList));
				arrInitialList.add(new  SimpleDateFormat("MM/dd/yyyy HH:mm:ss").parse(sAscExpList) );
				//Date dtAscExpList = format.parse(sExpList);
				//arrInitialList.add(dtAscExpList);
				
			}
			
			System.out.println(arrInitialList);
			arrExpSortedList = arrInitialList;
			
			Collections.sort(arrExpSortedList);

			System.out.println(arrExpSortedList);
			System.out.println("Initial Expected Sorting Done");
		
			for(int i=1;i<=arrRows.size();i++)
			{
				
				String sActAscList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				
				Date ActAscList = format.parse(sActAscList);
				arrActSortedList.add(ActAscList);
				

				
			}
			System.out.println(arrActSortedList);
			System.out.println("Sorted List Done");
			
			if(arrActSortedList.equals(arrExpSortedList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in ascending order", "'"+sColumnName+"' values are sorted in ascending order", "Pass");
			}
			else
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in ascending order", "'"+sColumnName+"' values are not sorted in ascending order", "Fail");
			}
			
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			for(int i=1;i<=mTableDataDB.size();i++)
			{
				if(sModule.equalsIgnoreCase("QueueLogging"))
				{
				 DBData=mTableDataDB.get(i).get(iColNum-1).toString().trim().toUpperCase();
				}
				 
				 System.out.println(DBData);
				 Date dt =new SimpleDateFormat("MM/dd/yyyy HH:mm:ss").parse(DBData);
				 Date newDate = DateUtils.addMinutes(dt, 180);
				 arrDBList.add(newDate);
				
			}
			
			System.out.println(arrActSortedList);
			System.out.println(arrDBList);	
		
			if(arrActSortedList.equals(arrDBList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are matched with DB values", "Pass");
			}else
			
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are not  matched with DB values", "Fail");
			}*/
			
			}
			if(sortType.equalsIgnoreCase("Desc"))
			{
			arrExpSortedList.clear();
			arrActSortedList.clear();
			arrDBList.clear();
			
			objGenericFunctionLibrary.ClickByXpath(sColXpath,"SortBtn",true);//post condition
			Thread.sleep(4000);
			
			for(int i=1;i<=arrRows.size();i++)
			{
							
				String sDesExpList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				System.out.println(sDesExpList); 
				//Date sdtDesExpList = format.parse(sDesExpList);//previous code
				sDesExpList=new SimpleDateFormat("MM/dd/yyyy HH:mm:ss").format(new SimpleDateFormat("MM/dd/yyyy hh:mm:ss a").parse(sDesExpList));
				arrInitialList.add(new  SimpleDateFormat("MM/dd/yyyy HH:mm:ss").parse(sDesExpList) );
				//System.out.println(sDesExpList);
			    //arrInitialList.add(sdtDesExpList);//previous code
			}
			System.out.println(arrInitialList);
			arrExpSortedList = arrInitialList;
			Collections.sort(arrExpSortedList);
			Collections.reverse(arrExpSortedList);

			System.out.println(arrExpSortedList);
			System.out.println("Initial Expected Sorting Done");
			
			for(int i=1;i<=arrRows.size();i++)
			{
				String sActDesList =TestDriver.driver.findElement(By.xpath(sTableXPath+"/tr["+i+"]/td["+iColNum+"]")).getText().trim().toUpperCase();
				System.out.println(format);
				Date dtActDesList = format.parse(sActDesList);
				
				arrActSortedList.add(dtActDesList);
				
			}
			System.out.println("Sorted List Done");
			System.out.println(arrActSortedList);
			
			if(arrActSortedList.equals(arrExpSortedList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in descending order", "'"+sColumnName+"' values are sorted in descending order", "Pass");
			}
			else
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should be sorted in descending order", "'"+sColumnName+"' values are not sorted in desscending order", "Fail");
			}
			
			/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				for(int i=1;i<=mTableDataDB1.size();i++)
				{
					if(sModule.equalsIgnoreCase("QueueLogging"))
					{
					DBData=mTableDataDB1.get(i).get(iColNum-1).toString().trim().toUpperCase();
					}
					 System.out.println(DBData);
					 Date dt =new SimpleDateFormat("MM/dd/yyyy HH:mm:ss").parse(DBData);
					 Date newDate = DateUtils.addMinutes(dt, 180);
					 arrDBList.add(newDate);	
				}
			
			System.out.println(arrActSortedList);
			System.out.println(arrDBList);
			
			if(arrActSortedList.equals(arrDBList))
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are matched with DB values", "Pass");
			}else
			
			{
				obj.repAddData( "Verify Sorting on '"+sColumnName+"' column", "'"+sColumnName+"' values should match with DB values ", "'"+sColumnName+"' values are not  matched with DB values", "Fail");
			}*/
			
		}
			
				
					
	   }catch (Exception e) {
	    System.out.println("fnCheckQueueHubDateSorting --------------Failed");    
	    TestDriver.log.error("fnCheckQueueHubDateSorting failed",e);
	    }
	 }

	     public void  fnGetCreditTableData (String sTablePath,String sCustomerUI ) throws Exception
	     {
			 HashMap<Integer, HashMap<Integer, String>> mTableDataUI = new HashMap<Integer,HashMap<Integer, String>>();
			
			 //String sCustomerUI ="AUTOTESTCUSTOMER_28809";
			      WebDriverWait wait = new WebDriverWait(TestDriver.driver, 60);
			      try
		            {     
			        
			    	String sQuery = objSQLConfig.scustomer_CreditApprovalNotification_Query;
			        WebElement eleTable = TestDriver.driver.findElement(By.xpath(sTablePath)); //Get the table data rows
					//List<WebElement> eleSpanList =eleTable .findElements(By.tagName("./span"));
					List<WebElement> eleSpanList =TestDriver.driver.findElements(By.xpath(SphereModules.Customers_CreditApprovalNotification_View_table_xp));//this code also works
					//List<WebElement> eleColList = TestDriver.driver.findElements(By.xpath(SphereModules.Customers_CreditApprovalNotification_Columns_xp));this code also works
					wait.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Customers_CreditApprovalNotification_Title_xp)));
					WebElement ele =TestDriver.driver.findElement(By.xpath(SphereCommon.Customers_CreditApprovalNotification_Title_xp));
					objGenericFunctionLibrary.HighlightElement(ele);
					Thread.sleep(2000);
					
					String sCreditApprovalTitleMessage = AppMessages.Customers_CreditApprovalNotification_Title_msg.toString().trim();
					
					if(objGenericFunctionLibrary.CheckTextOnPage(sCreditApprovalTitleMessage))
					{
						obj.repAddData( "Verify Credit Approval notification page", "Credit Approval notification page should be loaded", "Credit Approval notification page loaded successfully with Title : "+sCreditApprovalTitleMessage, "Pass");
				
					}
					
					WebElement Logoele =TestDriver.driver.findElement(By.xpath(SphereModules.Customers_CreditApprovalNotification_View_Logo_xp));
					objGenericFunctionLibrary.HighlightElement(Logoele);
					Thread.sleep(2000);
					WebElement Textele = TestDriver.driver.findElement(By.xpath(SphereModules.Customers_CreditApprovalNotification_Text_xp));
					objGenericFunctionLibrary.HighlightElement(Textele);
					Thread.sleep(2000);
					
					objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_customer_MainPhone_xp,"Main Phone",true,true);
					objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_customer_Email_xp,"Email",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_Accounting_Contact_1_xp,"Accounting Contact 1",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_customer_Number_xp,"Customer Number",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_customer_Name_xp,"Customer Name",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_customer_Address_xp,"Address",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_production_Type_xp,"Production Type",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_creditlimit_xp,"Credit Limit",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_startdate_xp,"Start Date",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_expirationdate_xp,"Expiration Date",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_Print_xp,"Print",true,true);
                	objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(objSphereModules.Customers_CreditApprovalNotification_CreateDeal_xp,"Create Deal",true,true);
                	
                	String sSpan = "";
                    for(WebElement eleSpan : eleSpanList)
                    {
                    	sSpan =sSpan+eleSpan.getText().trim().toUpperCase() + ";";
    					
                    }
                    sSpan = sSpan.trim();	
                    String sSpanlist =sSpan.trim(); 
        			String [] arrlist = sSpanlist.split(";");
        			//System.out.println(arrAddress[0].toString());
        			String sMnphoneUI= arrlist[0].toString();
        			String sCusttemailUI= arrlist[1].toString();
        			String sCtnameUI= arrlist[2].toString();
        			String sCtphoneUI = arrlist[3].toString();
        			String sCtemailUI= arrlist[4].toString();
        			String sCustNumberUI= arrlist[5].toString();
        			String sCustNameUI= arrlist[6].toString();
        			String sAddress1UI= arrlist[7].toString();
        			String sAddress2UI = arrlist[8].toString();
        			String sAddress3UI= arrlist[9].toString();
        			//String sAddress4UI= arrlist[10].toString();
        			String sProdTypeUI= arrlist[10].toString();
        			String sCreditlimitUI= arrlist[11].toString();
        			String sStartDateUI= arrlist[12].toString();
        			String sExpirationDateUI= arrlist[13].toString();
        			mTableDataUI.put(1, new HashMap<Integer, String>());
        			mTableDataUI.get(1).put(1,sMnphoneUI.toUpperCase());
        			mTableDataUI.get(1).put(2,sCusttemailUI.toUpperCase());
        			mTableDataUI.get(1).put(3,sCtnameUI.toUpperCase());
        			mTableDataUI.get(1).put(4,sCtphoneUI.toUpperCase());
        			mTableDataUI.get(1).put(5,sCtemailUI.toUpperCase());
        			mTableDataUI.get(1).put(6,sCustNumberUI.toUpperCase());
        			mTableDataUI.get(1).put(7,sCustNameUI.toUpperCase());
        			mTableDataUI.get(1).put(8,sAddress1UI.toUpperCase());
        			mTableDataUI.get(1).put(9,sAddress2UI.toUpperCase());
        			mTableDataUI.get(1).put(10,sAddress3UI.toUpperCase());
        			//mTableDataUI.get(1).put(11,sAddress4UI.toUpperCase());
        			mTableDataUI.get(1).put(11,sProdTypeUI.toUpperCase());
        			mTableDataUI.get(1).put(12,sCreditlimitUI.toUpperCase());
        			mTableDataUI.get(1).put(13,sStartDateUI.toUpperCase());
        			mTableDataUI.get(1).put(14,sExpirationDateUI.toUpperCase());
        			int iRow = 1; //for add 
					sQuery = sQuery.replaceAll("customer_name_param",sCustomerUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
        			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteCreditpageResultSet(TestDriver.rset);
        			boolean bFlag = true;
        			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
        			if(!mTableDataUI.get(1).toString().equalsIgnoreCase(mTableDataDB.get(1).toString()))
					{
						bFlag = false;
						obj.repAddData( "Compare customer details on credit approval  page", "customer details on UI and DB should match", "customer details validation failed", "Fail");
					}
        			if(bFlag == true)
        			{
        				obj.repAddData( "Compare customer details on credit approval  page", "customer details on UI and DB should match", "customer details validation successful", "Pass");
        			}
        		
        			}catch (Exception e) {
	                 System.out.println("fnGetCreditTableData --------------Failed");    
	                TestDriver.log.error("fnGetCreditTableData failed",e);
	              }
				
	     }
	     public void fnVerifySAPRecordsCount(String sQuery,String UIRecords,String CostObject) throws Exception
	 	{
	 	
	 		try
	 		{
	 			
	 			TestDriver.conn = objDBUtility.fnOpenDBConnection();
	 			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	 			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	 			System.out.println("Hello");
	 			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	 			String sRecordsDB = mTableDataDB.get(1).get(1).toString();
	 			if(sRecordsDB.equalsIgnoreCase(UIRecords))
	 			{
	 				obj.repAddData( "Verify records for CostObject: "+ CostObject, "Records Count should match for CostObject : "+ CostObject, "Records count validation successful for Cost Object : "+ CostObject, "Pass");
	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify records for CostObject: "+ CostObject, "Records Count should match for CostObject : "+ CostObject, "Records count validation failed for Cost Object : "+ CostObject, "Fail");
	 			}
	 		} catch (Exception e) {
	 	   System.out.println("fnVerifySAPRecordsCount--------------Failed");    
	 	   TestDriver.log.error("fnVerifySAPRecordsCount failed",e);
	 	   }
	 		
	 	} 
	     public void fnVerifyRecordsWithDB(String sTablepath,String sQuery,String CostObjectName) throws Exception
		 	{
		 	
		 		try
		 		{
		 			HashMap<Integer, HashMap<Integer, String>> mTableDataUI =objGenericFunctionLibrary.fnGetSapTableData(sTablepath);
					System.out.println("Hello");
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
					System.out.println(mTableDataUI.size());
					if(CostObjectName.equalsIgnoreCase("Manual Funds Commitment")||
					   CostObjectName.equalsIgnoreCase("WBSE"))
					{
					Boolean bResultFlag = false;
					int failedsystems=0;
					for(int i=1;i<=mTableDataUI.size(); i++)
					{
						 bResultFlag = false;
						String sCol1UI = mTableDataUI.get(i).get(1).toString().trim();
						System.out.println("UI column 1\t:"+ sCol1UI);
						
						String sCol2UI = mTableDataUI.get(i).get(2).toString().trim();
						System.out.println("UI column 2\t:"+ sCol2UI);
						
						String sCol3UI = mTableDataUI.get(i).get(3).toString().trim();
						System.out.println("UI column 3\t:"+ sCol3UI);
						
						String sCol4UI = mTableDataUI.get(i).get(4).toString().trim();
						System.out.println("UI column 4\t:"+ sCol4UI);
																		
						for(int j=1; j<=mTableDataDB.size();j++)
		                {
							String sCol1DB = mTableDataDB.get(j).get(1).toString().trim();
							System.out.println("DB column 1\t:"+ sCol1DB);
							
							String sCol2DB = mTableDataDB.get(j).get(2).toString().trim();
							System.out.println("DB column 2\t:"+ sCol2DB);
							
							String sCol3DB = mTableDataDB.get(j).get(3).toString().trim();
							System.out.println("DB column 3\t:"+ sCol3DB);
							
							String sCol4DB = mTableDataDB.get(j).get(4).toString().trim();
							System.out.println("DB column 4\t:"+ sCol4DB);
														
								if((sCol1UI.equalsIgnoreCase(sCol1DB))
									&&(sCol2UI.equalsIgnoreCase(sCol2DB))
									&&(sCol3UI.equalsIgnoreCase(sCol3DB))
									&&(sCol4UI.equalsIgnoreCase(sCol4DB)))
												
							{
								bResultFlag = true;
							    System.out.println(i+" record matched");
							   break;
							}
		                }
						//break;
						if(bResultFlag == false){
							failedsystems++;
							 System.out.println(i+" record not matched");
							//System.out.println(sSystemnameUI+ " "+ sSystemDealUI);
							obj.repAddData( "Compare  Cost Object "+CostObjectName+" records" , "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "Validation failed for  : \t company: "+sCol1UI +sCol2UI +sCol3UI +sCol4UI, "Fail");
						}
					
					}
                   
					    if(failedsystems==0){
						if(bResultFlag == true)
						{
							obj.repAddData( "Compare  Cost Object "+CostObjectName+" records" , "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "UI and DB validation successful for all Cost Object "+CostObjectName+"  records", "Pass");
						}
						   }
						     else
							if(failedsystems>0){
								if(bResultFlag == false)	
							
						   {
							obj.repAddData( "Compare  Cost Object "+CostObjectName+" records", "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "UI and DB validation failed for all Cost Object "+CostObjectName+"  records", "Fail");
						   }
							  }
				
					}else
					{
						Boolean bResultFlag = false;
						int failedsystems=0;
						for(int i=1;i<=mTableDataUI.size(); i++)
						{
							 bResultFlag = false;
							String sCol1UI = mTableDataUI.get(i).get(1).toString().trim();
							System.out.println("UI column 1\t:"+ sCol1UI);
							
							String sCol2UI = mTableDataUI.get(i).get(2).toString().trim();
							System.out.println("UI column 2\t:"+ sCol2UI);
							
							String sCol3UI = mTableDataUI.get(i).get(3).toString().trim();
							System.out.println("UI column 3\t:"+ sCol3UI);
							
							for(int j=1; j<=mTableDataDB.size();j++)
			                {
								String sCol1DB = mTableDataDB.get(j).get(1).toString().trim();
								System.out.println("DB column 1\t:"+ sCol1DB);
								
								String sCol2DB = mTableDataDB.get(j).get(2).toString().trim();
								System.out.println("DB column 2\t:"+ sCol2DB);
								
								String sCol3DB = mTableDataDB.get(j).get(3).toString().trim();
								System.out.println("DB column 3\t:"+ sCol3DB);
								
									if((sCol1UI.equalsIgnoreCase(sCol1DB))
										&&(sCol2UI.equalsIgnoreCase(sCol2DB))
										&&(sCol3UI.equalsIgnoreCase(sCol3DB)))
								                                    
													//if((!sSystemDealUI.equals(sDealnumberDB))||(!sSystemnameUI.equals(sSystemnameDB)))
								{
									bResultFlag = true;
								    System.out.println(i+" record matched");
								   break;
								}
			                }
							//break;
							if(bResultFlag == false){
								failedsystems++;
								 System.out.println(i+" record not matched");
								//System.out.println(sSystemnameUI+ " "+ sSystemDealUI);
								obj.repAddData( "Compare  Cost Object "+CostObjectName+" records" , "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "Validation failed for  : \t company: "+sCol1UI +" " +sCol2UI+" " +sCol3UI, "Fail");
							}
						
						}
	                   
						if(failedsystems==0){
							if(bResultFlag == true)
							{
								obj.repAddData( "Compare  Cost Object "+CostObjectName+" records" , "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "UI and DB validation successful for all Cost Object "+CostObjectName+" records", "Pass");
							}
							}
							else
								if(failedsystems>0){
									if(bResultFlag == false)	
								
							{
								obj.repAddData( "Compare  Cost Object "+CostObjectName+" records", "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "UI and DB validation failed for all Cost Object  records", "Fail");
							}
								}
					}
					
					
		 		} catch (Exception e) {
		 	   System.out.println("fnVerifyRecordsWithDB--------------Failed");    
		 	   TestDriver.log.error("fnVerifyRecordsWithDB failed",e);
		 	   }
		 		
		 	} 
	     
	     public void fnVerifyHubQueueFilterViewRecordswithDB(String sTablepath,String sQuery,String StatusFilter,String StatusFilterXpath ) throws Exception
		 	
	     {
		 		try
		 		{
		 			
		 			objGenericFunctionLibrary.ClickByXpath(StatusFilterXpath, StatusFilter, true);
					
					WebElement eleTable = TestDriver.driver.findElement(By.xpath(sTablepath));
					List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
					System.out.println("Rows Size>>>>"+arrHeaderColumns.size());
					
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Request Timestamp");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Status");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Customer Number");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"Deal Number");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"System");
					objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Resend");
					obj.repAddData( "Verifying Filtered records of QueueLogging", "", "", "");
					
					Thread.sleep(4000);			
					//HashMap<Integer, HashMap<Integer, String>> mTableDataUI = fnGetTableData(objSphereModules.Common_ViewNationalAccountModule_Table_xp+"/tbody");
					HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetQueueTableData(sTablepath);
					//System.out.println("Hello");
				    
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset );
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					 
					System.out.println(mTableDataUI.size());
					Boolean bResultFlag = false;
					int failedsystems=0;
					
					System.out.println(mTableDataUI.size());
					//Boolean bResultFlag = false;
					for(int i=1;i<=mTableDataUI.size(); i++)
					{
						bResultFlag = false;
						String sTimestampUI = mTableDataUI.get(i).get(1).toString().trim();
						System.out.println("UI Timestampvalue\t:"+ sTimestampUI);
						
						String sStatusUI = mTableDataUI.get(i).get(2).toString().trim();
						System.out.println("UI statusvalue\t:"+ sStatusUI);
						
						String sCustomerUI = mTableDataUI.get(i).get(3).toString().trim();
						System.out.println("UI customervalue\t:"+ sCustomerUI);
						
						String sSystemDealUI=mTableDataUI.get(i).get(4).toString();
						System.out.println("UI Deal value\t:"+ sSystemDealUI);
						
						String sSystemnameUI=mTableDataUI.get(i).get(5).toString();
						System.out.println("UI Systemname value\t:"+ sSystemnameUI);
						
						for(int j=1; j<=mTableDataDB.size();j++)
		                {
							String sTimestampDB = mTableDataDB.get(j).get(1).toString().trim();
							System.out.println("DB Timestampvalue\t:"+ sTimestampDB);
							
							String sStatusDB = mTableDataDB.get(j).get(2).toString().trim();
							System.out.println("DB statusvalue\t:"+ sStatusDB);
							
							String sCustomerDB = mTableDataDB.get(j).get(3).toString().trim();
							System.out.println("DB customervalue\t:"+ sCustomerDB);
							
							String sSystemDealDB=mTableDataDB.get(j).get(4).toString();
							System.out.println("DB Deal value\t:"+ sSystemDealDB);
							
							String sSystemnameDB = mTableDataDB.get(j).get(5).toString().trim();
							System.out.println("DB systemNamevalue\t:"+ sSystemnameDB);
							
							if((sSystemnameUI.equalsIgnoreCase(sSystemnameDB))
									&&(sSystemDealUI.equalsIgnoreCase(sSystemDealDB))
									&&(sCustomerUI.equalsIgnoreCase(sCustomerDB))
									&&(sTimestampUI.equalsIgnoreCase(sTimestampDB))
									&&(sStatusUI.equalsIgnoreCase(sStatusDB)))
							//if((!sSystemDealUI.equals(sDealnumberDB))||(!sSystemnameUI.equals(sSystemnameDB)))
							{
								bResultFlag = true;
							    System.out.println(i+" record matched");
							    break;
							}
		                } //End of i loop
						//break;
						if(bResultFlag == false)
						{
							failedsystems++;
							System.out.println(i+" record not matched");
							System.out.println(sSystemnameUI+ " "+ sSystemDealUI);
							obj.repAddData( "Compare record for Queue logging record : ", "Record on UI and DB should match for Queue logging : ", "Validation failed for  : \t systemname: "+sSystemnameUI, "Fail");
						}
					} //End of j loop
					
					if(failedsystems==0)
					{
						//if(bResultFlag == true)
						{
							obj.repAddData( "Compare all "+mTableDataUI.size()+" queuelogging records displayed on the screen", "All queuelogging records on UI should match with DB records", "UI and DB validation successful for all queuelogging  records", "Pass");
						}
						
					}
						else
							if(failedsystems>0)
							{
								//if(bResultFlag == false)	
							
						{
							obj.repAddData( "Compare all "+mTableDataUI.size()+" queuelogging records displayed on the screen", "All queuelogging records on UI should match with DB records", "UI and DB validation failed for all queuelogging  records", "Fail");
						}
							
							}
					  
					  objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				
		 		} catch (Exception e) {
		 	   System.out.println("fnVerifyHubQueueViewRecordswithDB--------------Failed");    
		 	   TestDriver.log.error("fnVerifyHubQueueViewRecordswithDB failed",e);
		 	   }
		 		
		 	} 


	     public void fnVerifyPaginationgroup(String sPaginationPath,String sPaginationTextpath,String sNextXpath,String sPrevXpath,String CostObjectName) throws Exception
		 	{
		 	
		 		try
		 		{
		 			//List<WebElement> elePagination =TestDriver.driver.findElements(By.xpath(sPaginationPath));//this code also works
		 			WebElement PageSequence=TestDriver.driver.findElement(By.xpath(sPaginationPath));
		 			WebElement ShownItemsOnPage=TestDriver.driver.findElement(By.xpath(sPaginationTextpath));
					
					if(PageSequence.isDisplayed())
					{
						((JavascriptExecutor) TestDriver.driver).executeScript("arguments[0].scrollIntoView(true);", PageSequence);
						Thread.sleep(1000);
						objGenericFunctionLibrary.HighlightElementByXpath(sPaginationPath);
						Thread.sleep(2000);
						obj.repAddData( "Verify  Pagination displayed for "+CostObjectName+" table", "pagination should be displayed for Cost Object "+CostObjectName+" table ", "pagination displayed for "+CostObjectName+" table", "Pass");
					}else
					{
						obj.repAddData( "Verify  Pagination displayed for "+CostObjectName+" table", "pagination should be displayed for Cost Object "+CostObjectName+" table ", "pagination not displayed for "+CostObjectName+" table", "Fail");
					}
					
					
					if(ShownItemsOnPage.isDisplayed())
					{
						((JavascriptExecutor) TestDriver.driver).executeScript("arguments[0].scrollIntoView(true);", ShownItemsOnPage);
						objGenericFunctionLibrary.HighlightElementByXpath(sPaginationTextpath);
						Thread.sleep(2000);
						obj.repAddData( "Verify showing items text for "+CostObjectName+" table", " showing items text should be displayed for Cost Object "+CostObjectName+" table ", " showing items text displayed for "+CostObjectName+" table", "Pass");
					}else
					{
						obj.repAddData( "Verify showing items text for "+CostObjectName+" table", " showing items text should be displayed for Cost Object "+CostObjectName+" table ", " showing items text not displayed for "+CostObjectName+" table", "Fail");
					}
					
					obj.repAddData( "Verifying  Page navigation", "", "", "");
					
					String expNextText="page=2";
					objGenericFunctionLibrary.ClickByXpath(sNextXpath,"Next",true);//post condition
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(2000);
					//String ActPageText=TestDriver.driver.getCurrentUrl().substring(59,65);
					String ActPageText=TestDriver.driver.getCurrentUrl().trim();//substring(59,65);
					boolean bresultFlag=false;
					//if(ActPageText.equalsIgnoreCase(expNextText))
					if(ActPageText.contains(expNextText))
					{
					    bresultFlag=true;
						obj.repAddData( "Verifying page navigation", "New page  should be loaded", "New page is loaded successfully ", "Pass");
					}
					else if(bresultFlag=false)	
					{
						obj.repAddData( "Verifying page navigation", "New page  should be loaded", "New page is not loaded successfully ", "Fail");
					}
					objGenericFunctionLibrary.ClickByXpath(sPrevXpath,"previous",true);//post condition
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(2000);
					String ExpPrevPageText="page=1";
					String ActPrevPageText=TestDriver.driver.getCurrentUrl().trim();//substring(59,65);
					boolean bFlag=false;
					//if(ActPrevPageText.equalsIgnoreCase(ExpPrevPageText))
					if(ActPrevPageText.contains(ExpPrevPageText))
					{
					    bFlag=true;
						obj.repAddData( "Verifying page navigation", "previous page should be navigated", "previous page is loaded successfully", "Pass");
					}
					else if(bFlag==false)	
					{
					    obj.repAddData( "Verifying page navigation", "previous page  should be loaded", "previous page is not loaded successfully", "Fail");
					}
				
		 		} catch (Exception e) {
		 	   System.out.println("fnVerifyPaginationgroup--------------Failed");    
		 	   TestDriver.log.error("fnVerifyPaginationgroup failed",e);
		 	   }
		 		
		 	} 
	     
	     public void fnVerifyPageNavigation(String sNextXpath,String sPrevXpath,int UrlStartValue,int UrlEndValue) throws Exception
		 	{
		 	try
		 		{
					
					//obj.repAddData( "Verifying  Page navigation", "", "", "");
					
					String expNextText="page=2";
					objGenericFunctionLibrary.ClickByXpath(sNextXpath,"Next",true);//post condition
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(2000);
					//String ActPageText=TestDriver.driver.getCurrentUrl().substring(59,65);
					//String ActPageText=TestDriver.driver.getCurrentUrl().substring(UrlStartValue,UrlEndValue);
					//System.out.println(ActPageText);
					//String ActualColor=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_GreenColor_xp)).getAttribute("class");
					String ActPageText=TestDriver.driver.getCurrentUrl().trim();
					System.out.println(ActPageText);
					//String [] arrClassName = ActPageText.split("page=");
			       // String sPageNum = arrClassName[1].toString().trim();
					boolean bresultFlag=false;
					//if(ActPageText.equalsIgnoreCase(expNextText))
					if(ActPageText.contains(expNextText))
					{
					    bresultFlag=true;
						obj.repAddData( "Verifying page navigation", " New page  should be loaded", "New page is loaded succesfully", "Pass");
					}else
					if(bresultFlag=false)	
					{
						obj.repAddData( "Verifying page navigation", " New page  should be loaded", "New page is loaded succesfully", "Fail");
					}
					objGenericFunctionLibrary.ClickByXpath(sPrevXpath,"previous",true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(2000);
					String ExpPrevPageText="page=1";
					String ActPrevPageText=TestDriver.driver.getCurrentUrl().trim();
					boolean bFlag=false;
					if(ActPrevPageText.contains(ExpPrevPageText))
					{
					    bFlag=true;
						obj.repAddData( "Verifying page navigation", " previous page  should be loaded", "previous page is loaded successfully ", "Pass");
					}else
					if(bFlag==false)	
					{
					    obj.repAddData( "Verifying page navigation", " previous page  should be loaded", "previous page is not loaded succesfully", "Fail");
					}
				
		 		} catch (Exception e) {
		 	   System.out.println("fnVerifyPaginationgroup--------------Failed");    
		 	   TestDriver.log.error("fnVerifyPaginationgroup failed",e);
		 	   }
		 		
		 	} 

	   //fnVerifyDealCustomerAddress(sCustomerUI)
	     public void fnVerifyDealCustomerAddress(String sCustomerUI,String sQuery) throws Exception
		 	{
	    	 HashMap<Integer, HashMap<Integer, String>> mTableDataUI = new HashMap<Integer,HashMap<Integer, String>>();
	    	 try
		 		{
	    		    List<WebElement> eleSpanList =TestDriver.driver.findElements(By.xpath(SphereModules.Deals_AddDeal_Customer_Adress_List_xp));//this code also works
				   // String sQuery=objSQLConfig.scustomer_MainAddress_Query; 	
	
					String sSpan = "";
                    for(WebElement eleSpan : eleSpanList)
                    {
                    	sSpan =sSpan+eleSpan.getText().trim().toUpperCase() + ";";
    					
                    }
                    sSpan = sSpan.trim();	
                    String sSpanlist =sSpan.trim(); 
        			String [] arrlist = sSpanlist.split(";");
        			//System.out.println(arrAddress[0].toString());
        			String sAddress1UI= arrlist[0].toString();
        			String sAddress2UI = arrlist[1].toString();
        			String sAddress3UI= arrlist[2].toString();
        			if(sAddress3UI.contains("-")) 
        			{
        				sAddress3UI = sAddress3UI.replace("-","").trim();
					}
        			mTableDataUI.put(1, new HashMap<Integer, String>());
        			mTableDataUI.get(1).put(1,sAddress1UI.toUpperCase());
        			mTableDataUI.get(1).put(2,sAddress2UI.toUpperCase());
        			mTableDataUI.get(1).put(3,sAddress3UI.toUpperCase());
        			
        			int iRow = 1; //for add 
					sQuery = sQuery.replaceAll("customer_name_param",sCustomerUI);
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
        			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
        			boolean bFlag = true;
        			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
        			if(!mTableDataUI.get(1).equals(mTableDataDB.get(1)))
					{
						bFlag = false;
						obj.repAddData( "Compare customer main address on deal page", "customer details on UI and DB should match", "customer address validation failed", "Fail");
					}
        			if(bFlag == true)
        			{
        				obj.repAddData( "Compare customer main address on deal page", "customer details on UI and DB should match", "customer address validation successful", "Pass");
        			}
					
				
		 		} catch (Exception e) {
		 	   System.out.println("fnVerifyDealCustomerAddress--------------Failed");    
		 	   TestDriver.log.error("fnVerifyDealCustomerAddress failed",e);
		 	   }
		 		
		 	}
	     
	     
	   //fnVerifyDealCustomerAddress(sCustomerUI)
	     public void fnAddandVerifyFields(String AddForm) throws Exception
		 	{
	    	 HashMap<Integer, HashMap<Integer, String>> mTableDataUI = new HashMap<Integer,HashMap<Integer, String>>();
	    	 try
		 		{
	 			
	 			//////////////////////////
	 			if(AddForm.equalsIgnoreCase("AddAddress"))
	 			{
	 			String sAltDescription="AutoUpdateAltAddrDesc";
	 			//String sAltAddress = "7707 GATEWAY BOULEVARD;;;UNITED STATES;CALIFORNIA;NEWARK;94560";
	 			String AltAddr1UI="7707 GATEWAY BOULEVARD";
	 			String AltAddr2UI= "SUITE200";
	 			String AltAddr3UI="OUTER DRIVE";
	 			String AltCountryUI ="UNITED STATES";
	 			String AltStateUI= "CALIFORNIA";
	 			String AltCityUI= "NEWARK";
	 			String AltZipUI= "94560";
	 			/////////////////////////////////////////Verifying Alternate Address fields/////////////////////////////////////////////////////
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InputAddressLine1_id, "Alternate Address Line 1",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InputAddressLine2_id,"Alternate Address Line 2",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InputAddressLine3_id,"Alternate Address Line 3",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_ComboCountry_xp,"Country",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_ComboState_xp,"State",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InputCity_xp,"City",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_InputZipId_id,"Zip",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true,true);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddAltAddress_InputAddrDesc_id,"Alternate Address Description",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_Address_InputAddnlInfo1_id,"Alternate Address Description 1",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_Address_InputAddnlInfo2_id,"Alternate Address Description 2",true,true);
	 			
	 			/////////////////////////////////////////Adding Alternate Address/////////////////////////
	 			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine1_id, AltAddr1UI, "Alternate Address Line 1");
	 			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine2_id, AltAddr2UI, "Alternate Address Line 2");
	 			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine3_id, AltAddr3UI, "Alternate Address Line 3");
	 			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCountry_xp,AltCountryUI);
	 			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboState_xp,AltStateUI);
	 			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputCity_xp, AltCityUI, "Alt City");
	 			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputZipId_id, AltZipUI, "Alt Zip");
	 			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddAltAddress_InputAddrDesc_id, sAltDescription, "Alternate Address Description");
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Save_xp,"Add Alternate Address Button",true);
	 			objGenericFunctionLibrary.fnLoadingPageWait();
	 			
	 			////////////////////////////////////////Verifying Address Values//////////////////////////
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_EditAltAddress_Pencil_xp," Address Edit Link",true);
	 			String AddressValue1=TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_InputAddressLine1_id)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(AltAddr1UI,AddressValue1);
	 			String AddressValue2=TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_InputAddressLine2_id)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(AltAddr2UI,AddressValue2);
	 			String AddressValue3=TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_InputAddressLine3_id)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(AltAddr3UI,AddressValue3);
	 			String CountryValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_SelectedCountry_xp)).getText().trim();
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(AltCountryUI,CountryValue);
	 			String StateValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_SelectedState_xp)).getText().trim();
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(AltStateUI,StateValue);
	 			String CityValue=TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_InputCity_xp)).getAttribute("value");// not working
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(AltCityUI,CityValue);
	 			String ZipValue=TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_InputZipId_id)).getAttribute("value");//not working
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(AltZipUI,ZipValue);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Close_xp,"Close button",true);
	 			objGenericFunctionLibrary.fnLoadingPageWait();
	 			}
	 			
	 			if(AddForm.equalsIgnoreCase("AddProject"))
	 			{
	 			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
	 			String sProjectNameUI="AutoProject"+sRandom;
				String sProjectClusterUI="AutoCluster"+sRandom;
				String sProjectType=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp,"Project Add Button",true,true);
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,"Search Project",true,true);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
				//////////////////////////////////////Verifying Project Fields/////////////////////////////////////////////////////////////
				objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, "Project Name",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp,"Project Cluster",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,"Project Type",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddProject_InternalProject_xp,"Internal",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddProject_ActiveCheck_xp,"Active",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewProject_cancel_xp,"Cancel Project",true,true);
	 			
	 			objGenericFunctionLibrary.fnVerifyCombolistByXpath("Project_Type_List","Project Type" ,SphereModules.Deals_AddDeal_AddProject_Project_Type_xp);
	 			
	 			////////////////////////////////////////Adding Project//////////////////////////////////////////////////////////////////////
				
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddProject_InternalProject_xp,"Internal Project",true);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddProject_InternalProject_xp,"Internal Project",true);//to uncheck Internal project
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
				Thread.sleep(4000);
	 			//////////////////////////////////////Verifying Project Values////////////////////////////////////////////////////
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_EdditProject_Pencil_xp,"Edit Pencil",true);
				String ProjectNameValue1=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sProjectNameUI,ProjectNameValue1);
	 			String ProjectClusterValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sProjectClusterUI,ProjectClusterValue);
	 			String ProjectTypeValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_SelectedProject_xp)).getText().trim();
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sProjectType,ProjectTypeValue);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_cancel_xp,"Cancel Project", true);
	 			Thread.sleep(4000);
	 			}
	 		    ////////////////////////////////
	 			if(AddForm.equalsIgnoreCase("AddContact"))
	 			{
	 			String sDealContactFirstNameUI="Test Edit First Name";
	 			String sDealContactLastNameUI="Test Edit Last Name";
	 			String sDealContactTypeUI="Test Edit Title Name";		
	 			String sDealContactPhone="2484621245";
	 			String sDealContactPhoneUI="(248) 462-1245";
	 			String sDealContactEmailUI="testEdit@email.com";
	 			/////////////////////////////////////////////Verifying contact fields///////////////////////////////////
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp, "Add New Contact Button",true,true);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "First Name ",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp,"Last Name",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp,"Title",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp,"Phone Number",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp,"Email Address",true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true,true);
	 			objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.Deals_AddDeal_AddNewContact_cancel_xp,"Cancel",true,true);
	 			///////////////////////////////////////////Adding new contact/////////////////////////////////////////////
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, sDealContactFirstNameUI, "First Name ");
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp,sDealContactLastNameUI, "Last Name");
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, sDealContactTypeUI, "Title");
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sDealContactPhone, "Phone Number");
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, sDealContactEmailUI, "Email Address");
	 			///objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
	 			//ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
	 			Thread.sleep(4000);
	 			objGenericFunctionLibrary.fnLoadingPageWait();
	 			//////////////////////////////////////////Verifying Contact Fields///////////////////////////////////
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_EditContact_Pencil,"Edit Pencil",true);
	 			String FirstNameValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sDealContactFirstNameUI,FirstNameValue);
	 			String LastNameValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sDealContactLastNameUI,LastNameValue);
	 			String TitleValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sDealContactTypeUI,TitleValue);
	 			String PhoneValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_Phone_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sDealContactPhoneUI,PhoneValue);
	 			String EmailValue=TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_AddNewContact_email_xp)).getAttribute("value");
	 			objGenericFunctionLibrary.fnVerifyLabelMsgText(sDealContactEmailUI,EmailValue);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_cancel_xp,"Cancel", true);
	 			Thread.sleep(4000);
	 			}
					
				
		 		} catch (Exception e) {
		 	   System.out.println("fnAddandVerifyFields--------------Failed");    
		 	   TestDriver.log.error("fnAddandVerifyFields failed",e);
		 	   }
		 		
		 	}
	     
	    public void fnSelectFilters(String sOption, String sValue, int i, String filterXpath,String contentXpath ) throws Exception
	 	{
	 	   try
	 		{
	 			if(i==2)
	 			{
	 			objGenericFunctionLibrary.ClickByXpath(filterXpath, sOption, true);
	 			if(sOption.equalsIgnoreCase("Customer")){
	 				String sCustomerNumber= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_UI").trim();
	 				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_Customer_Filter_Search_xp, sValue, "Customer");
	 				Thread.sleep(3000);
	 				TestDriver.driver.findElement(By.xpath(SphereModules.Deals_Customer_Filter_Search_xp)).sendKeys(Keys.BACK_SPACE);
	 				Thread.sleep(4000);
	 				sValue=sValue+" "+sCustomerNumber;
	 			}
	 			}
	 			List<WebElement> lstDynamicFilterValues = TestDriver.driver.findElements(By.xpath(contentXpath));
	 			
	 			for (WebElement eleData : lstDynamicFilterValues)
	 			{
	 				String sTempValue = eleData.findElement(By.xpath("./span[2]")).getText().trim();
	 				
	 				if (sTempValue.equalsIgnoreCase(sValue)) 
	 				{
	 					WebElement eleCheckbox = eleData.findElement(By.xpath("./span[1]"));
	 					objGenericFunctionLibrary.HighlightElement(eleCheckbox);
	 					objGenericFunctionLibrary.ClickByElement(eleCheckbox, sValue+" Checkbox", true);
	 					Thread.sleep(2000);
	 					objGenericFunctionLibrary.fnLoadingPageWait();
	 					break;
	 				}
	 			  }
	 			     // objGenericFunctionLibrary.ClickByXpath(filterXpath, sOption, true);
	 		   
	 			
	 		} catch (Exception e) {
	 	   System.out.println("fnSelectDynamicFilters --------------Failed");    
	 	   TestDriver.log.error("fnSelectDynamicFilters failed",e);
	 	   }
	 		
	 	}
	 	
	    public void fnVerifyDealsDeactivatedRecord(String sDealNumberDB) throws Exception
	 	{
	 	
	 		try
	 		{
	 			String sQuery = objSQLConfig.sDeals_Deactivate_Query;
	 			sQuery = sQuery.replaceAll("deal_number_param",sDealNumberDB);
	 			TestDriver.conn = objDBUtility.fnOpenDBConnection();
	 			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	 			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	 			System.out.println("Hello");
	 			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	 			String sStatusDB = mTableDataDB.get(1).get(1).toString();
	 			String sStatus="Closed-Accept No New Cost/Chrg";
	 			if(sStatusDB.equalsIgnoreCase(sStatus))
	 			{
	 				obj.repAddData( "Verify deactivation for DealTitle: "+ sDealNumberDB, "Deal should be deactivated for DealTitle : "+ sDealNumberDB, "Deal deactivation successful for DealTitle : "+ sDealNumberDB, "Pass");
	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify deactivation for DealTitle : "+ sDealNumberDB, "Deal should be deactivated for DealTitle : "+ sDealNumberDB, "Deal deactivation failed for DealTitle : "+ sDealNumberDB, "Fail");
	 			}
	 		} catch (Exception e) {
	 	   System.out.println("fnVerifyDealsDeactivatedRecord--------------Failed");    
	 	   TestDriver.log.error("fnVerifyDealsDeactivatedRecord failed",e);
	 	   }
	 		
	 	}
	 	public void fnVerifyDealsActivateRecord(String sDealNumberDB) throws Exception
	 	{
	 	
	 		try
	 		{
	 			String sQuery = objSQLConfig.sDeals_Activate_Query;
	 			sQuery = sQuery.replaceAll("deal_number_param",sDealNumberDB);
	 			TestDriver.conn = objDBUtility.fnOpenDBConnection();
	 			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	 			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	 			System.out.println("Hello");
	 			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	 			String sStatusDB = mTableDataDB.get(1).get(1).toString();
	 			String sStatus="Open Deal";
	 			if(sStatusDB.equalsIgnoreCase(sStatus))
	 			{
	 				obj.repAddData( "Verify open status for DealTitle: "+ sDealNumberDB, "Deal status should be opened for DealTitle : "+ sDealNumberDB, "Deal activation successful for DealTitle : "+ sDealNumberDB, "Pass");
	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify open status for DealTitle : "+ sDealNumberDB, "Deal status should be opened for DealTitle : "+ sDealNumberDB, "Deal activation failed for DealTitle : "+ sDealNumberDB, "Fail");
	 			}
	 		} catch (Exception e) {
	 	   System.out.println("fnVerifyDealsDeactivatedRecord--------------Failed");    
	 	   TestDriver.log.error("fnVerifyDealsDeactivatedRecord failed",e);
	 	   }
	 		
	 	}
	 	
	 	
	 	public void fnVerifyUsersDeactivatedRecord(String sso_id) throws Exception
	 	{
	 	
	 		try
	 		{
	 			String sQuery = objSQLConfig.sUsers_DeactivateUser_Query;
	 			sQuery = sQuery.replaceAll("sso_id_param",sso_id);
	 			TestDriver.conn = objDBUtility.fnOpenDBConnection();
	 			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	 			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	 			System.out.println("Hello");
	 			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	 			String sStatusDB = mTableDataDB.get(1).get(1).toString();
	 			if(Integer.valueOf(sStatusDB)==0)
	 			{
	 				obj.repAddData( "Verify deactivation for User: "+ sso_id, "User should be deactivated", "deactivation is successful for User : "+ sso_id, "Pass");
	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify deactivation for User: "+ sso_id, "User should be deactivated", "deactivation is not successful for User : "+ sso_id, "Fail");
	 			}
	 		} catch (Exception e) {
	 	   System.out.println("fnVerifyUserDeactivatedRecord--------------Failed");    
	 	   TestDriver.log.error("fnVerifyUserDeactivatedRecord failed",e);
	 	   }
	 		
	 	}
	 	
	 	public void fnVerifyParentcompanyDeactivatedRecord(String ParentCompanyAccount) throws Exception
	 	{
	 	
	 		try
	 		{
	 			String sQuery = objSQLConfig.sNationalAccount_DeactivateUser_Query;
	 		    sQuery = sQuery.replaceAll("account_name_param",ParentCompanyAccount);//sQuery = sQuery.replaceAll("customer_name_param",sCustomerName);
	 			TestDriver.conn = objDBUtility.fnOpenDBConnection();
	 			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	 			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	 			System.out.println("Hello");
	 			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	 			String sActive = mTableDataDB.get(1).get(1).toString();
	 			if(Integer.valueOf(sActive)==0)
	 			{
	 				obj.repAddData( "Verify deactivation for ParentCompanyAccount : "+ ParentCompanyAccount, "Account should be deactivated for ParentCompanyAccount : "+ ParentCompanyAccount, "Account deactivation successful for ParentCompanyAccount : "+ ParentCompanyAccount, "Pass");
	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify deactivation for ParentCompanyAccount : "+ ParentCompanyAccount, "Account should be deactivated for ParentCompanyAccount : "+ ParentCompanyAccount, "Account deactivation failed for ParentCompanyAccount : "+ ParentCompanyAccount, "Fail");
	 			}
	 		} catch (Exception e) {
	 	   System.out.println("fnVerifyParentcompanyDeactivatedRecord --------------Failed");    
	 	   TestDriver.log.error("fnVerifyParentcompanyDeactivatedRecord failed",e);
	 	   }
	 		
	 	}
	 	public void fnVerifyCustomerDeactivatedRecord(String sCustomer) throws Exception
	 	{
	 	try
	 		{
	 			String sQuery = objSQLConfig.sCustomer_DeactivateUser_Query;
	 		    sQuery = sQuery.replaceAll("customer_name_param",sCustomer);
	 			TestDriver.conn = objDBUtility.fnOpenDBConnection();
	 			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	 			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	 			System.out.println("Hello");
	 			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	 			String sActive = mTableDataDB.get(1).get(1).toString();
	 			if(Integer.valueOf(sActive)==0)
	 			{
	 				obj.repAddData( "Verify deactivation for customer : "+ sCustomer, "Customer : "+ sCustomer+" should be deactivated", "customer : "+ sCustomer+" deactivated successfully", "Pass");
	 				
	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify deactivation for customer : "+ sCustomer, "Customer : "+ sCustomer+" should be deactivated", "customer : "+ sCustomer+" not deactivated", "Fail");
	 			}
	 		} catch (Exception e) {
	 	   System.out.println("fnVerifyCustomerDeactivatedRecord --------------Failed");    
	 	   TestDriver.log.error("fnVerifyCustomerDeactivatedRecord failed",e);
	 	   }
	 		
	 	}
	 	
	 	public void fnVerifyCustomerActivatedRecord(String sCustomer) throws Exception
	 	{
	 	
	 		try
	 		{
	 			String sQuery = objSQLConfig.sCustomer_ReactivateUser_Query;
	 		    sQuery = sQuery.replaceAll("customer_name_param",sCustomer);
	 			TestDriver.conn = objDBUtility.fnOpenDBConnection();
	 			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	 			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	 			System.out.println("Hello");
	 			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	 			String sActive = mTableDataDB.get(1).get(1).toString();
	 			if(Integer.valueOf(sActive)==1)
	 			{
	 				obj.repAddData( "Verify activation for customer : "+ sCustomer, "Customer : "+ sCustomer+" should be activated", "customer : "+ sCustomer+" activated successfully", "Pass");
	 				
	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify activation for customer : "+ sCustomer, "Customer : "+ sCustomer+" should be activated", "customer : "+ sCustomer+" not activated", "Fail");
	 			}
	 		} catch (Exception e) {
	 	   System.out.println("fnVerifyCustomerActivatedRecord --------------Failed");    
	 	   TestDriver.log.error("fnVerifyCustomerActivatedRecord failed",e);
	 	   }
	 		
	 	}
	 	public void fnVerifyQueueHubSearchFilterData(String sTableXPath, String sSearchText, String sTextToBeVerified, int iVerifyColLoc) throws Exception
		{
			
			try
			{
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sSearchText , "Search Box");
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
				Thread.sleep(4000);
				HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetQueueTableData(sTableXPath);
				boolean bResultFlag = false;
				for(int i=1;i<=mTableDataUI.size(); i++)
				{
					String sName = mTableDataUI.get(i).get(iVerifyColLoc).toString();
					System.out.println("sName "+ sName);
					System.out.println("sTextToBeVerified "+ sTextToBeVerified);
					if(sName.equalsIgnoreCase(sTextToBeVerified) &&((sTextToBeVerified != null) && (!sTextToBeVerified.isEmpty())))
					//if(sName.equalsIgnoreCase(sTextToBeVerified)||
					//sName.toUpperCase().contains(sTextToBeVerified.toUpperCase()))
					{
						bResultFlag = true;
						obj.repAddData( "Verify record after applying search criteria", "Records for cutomer or deal should be displayed on the screen", "Records for \" "+sTextToBeVerified+ "\"  successfully displayed on the screen", "Pass");
						break;
					}
					
					
				}
				
				if(bResultFlag == false)
				{
					obj.repAddData( "Verify record after applying search criteria", "Records for cutomer or deal should be displayed on the screen", "Record for \" "+sTextToBeVerified+ "\" is displayed or No Record is found on the screen", "Fail");
				}
				
			} catch (Exception e) {
				
		   System.out.println("fnVerifyQueueHubSearchFilterData --------------Failed");    
		   TestDriver.log.error("fnVerifyQueueHubSearchFilterData failed",e);
		   }
			
		}
		
		public void fnVerifySAPSearchFilterData(String sTableXPath,String sSearchType, String sSearchText, String sTextToBeVerified, int iVerifyColLoc,String CostObject) throws Exception
		{
			HashMap<Integer, HashMap<Integer, String>>mTableDataUI=null;
			try
			{
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				List<WebElement> eleTableList =TestDriver.driver.findElements(By.xpath(SphereModules.Common_View_Sap_Table_xp));
				
				if(sSearchType.equalsIgnoreCase("TableSearch"))
				{
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Sap_Validation_Screen_Table_Search_bar_xp, sSearchText, "Search");
				Thread.sleep(8000);
				objGenericFunctionLibrary.fnLoadingPageWait();
				//Thread.sleep(4000);
				mTableDataUI = objGenericFunctionLibrary.fnGetSapTableData(sTableXPath);
				boolean bResultFlag = false;
				
				if(TestDriver.driver.findElements(By.xpath(SphereModules.Common_View_Modules_Table_FirstRow_xp)).size()>0==true)
				{
				for(int i=1;i<=mTableDataUI.size(); i++)
				{
					//bResultFlag = false;
					String sName = mTableDataUI.get(i).get(iVerifyColLoc).toString().toUpperCase();
					
					if(sName.equalsIgnoreCase(sTextToBeVerified)||
							sName.toUpperCase().contains(sTextToBeVerified.toUpperCase()))
					{
						bResultFlag = true;
						System.out.println(i+" record matched");
						obj.repAddData( "Verify record after applying search criteria", "Records for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " successfully displayed for "+CostObject+ "table", "Pass");
						
					}
					if(bResultFlag == false)
					{
						System.out.println(i+" record not matched");
						obj.repAddData( "Verify record after applying search criteria", "Record for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " not displayed for "+CostObject, "Fail");
					}
					
				}
				
				}
				else
				{
					obj.repAddData( "Verify record after applying search criteria", "Record for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " not displayed for "+CostObject, "Fail");
				}
				/*if(bResultFlag == true)
				{
					obj.repAddData( "Verify record after applying search criteria", "Record for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " displayed for "+CostObject, "Pass");
				}*/

				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Sap_Validation_Screen_Table_Search_bar_xp, " ", "Search");
				Thread.sleep(4000);
				}			
				else if(sSearchType.equalsIgnoreCase("GlobalSearch"))
				{
				 //objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Sap_Validation_Screen_Search_bar_xp, sSearchText, "Search");
			     //mTableDataUI = objGenericFunctionLibrary.fnGetSapTableData(sTableXPath+"["+j+"]");
			     mTableDataUI = objGenericFunctionLibrary.fnGetSapTableData(sTableXPath);
			     boolean bResultFlag = false;
			     if(TestDriver.driver.findElements(By.xpath(SphereModules.Common_View_Modules_Table_FirstRow_xp)).size()>0==true)
					{
				
			    	 for(int i=1;i<=mTableDataUI.size(); i++)
				
			    	 {
					
					//bResultFlag = false;
					String sName = mTableDataUI.get(i).get(iVerifyColLoc).toString().toUpperCase();
					
					if(sName.equalsIgnoreCase(sTextToBeVerified)||
							sName.toUpperCase().contains(sTextToBeVerified.toUpperCase()))
					{
						bResultFlag = true;
						System.out.println(i+" record matched");
						obj.repAddData( "Verify record after applying search criteria", "Records for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " successfully displayed for"  +CostObject, "Pass");
						
					}
					if(bResultFlag == false)
					{
						System.out.println(i+" record not matched");
						obj.repAddData( "Verify record after applying search criteria", "Record for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " not displayed for "+CostObject, "Fail");
					}
					
			    }
					}
			     else
					{
						obj.repAddData( "Verify record after applying search criteria", "Record for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " not displayed for "+CostObject, "Fail");
					}
				
				/*if(bResultFlag == true)
				{
			       obj.repAddData( "Verify record after applying search criteria", "Record for "+sTextToBeVerified+ " should be displayed on the screen", "Records for "+sTextToBeVerified+ " displayed for "+CostObject, "Pass");
				}*/
				
					}			
			} catch (Exception e) {
				
		   System.out.println("fnVerifySAPSearchFilterData --------------Failed");    
		   TestDriver.log.error("fnVerifySAPSearchFilterData failed",e);
		   }
			
		}
		
		public void fnVerifyDealExportData(String sFilterName) throws Exception
		{
			
			try
			{
				
				HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
				System.out.println("Hello");
				boolean bFlag = false;
				//mTableDataDB.equals(mTableDataDB);
				if(!sFilterName.equalsIgnoreCase("All")&&
					!sFilterName.equalsIgnoreCase("Open")&&
					!sFilterName.equalsIgnoreCase("Closed")&&
					!sFilterName.equalsIgnoreCase("Department Closed"))
			   {
				
				for(int i=1;i<=mTableDataUI.size(); i++)
				{
					String sDealTitle = mTableDataUI.get(i).get(2).toString();
					String sProjectUI = mTableDataUI.get(i).get(3).toString();
					String sCustomer = mTableDataUI.get(i).get(4).toString();
					String sCustomerType = mTableDataUI.get(i).get(5).toString();
					String sDealType=mTableDataUI.get(i).get(6).toString();
					String sCostCenter=mTableDataUI.get(i).get(7).toString();
					String sActFilterValue = "";
					if(sFilterName.equalsIgnoreCase("Deal_Type"))
					{
						sActFilterValue = sDealType;
					}
					else if(sFilterName.equalsIgnoreCase("Project"))
					{
						sActFilterValue = sProjectUI;
					}
					else if(sFilterName.equalsIgnoreCase("Deal_Customer"))
					{
						sActFilterValue = sCustomer;
					}
					else if(sFilterName.equalsIgnoreCase("Cost_Center"))
					{
						sActFilterValue = sCostCenter;
					}
					
					if(sFilterName.equalsIgnoreCase("Cost_Center"))
					{
						//if(TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim().substring(0,3).equals(sActFilterValue));
					    String CostCenter=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").substring(0,3);
						System.out.println( TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").substring(0,3));
						if(!CostCenter.equalsIgnoreCase(sActFilterValue))
						{
							obj.repAddData( "Verify all filtered records on Deals page", "Records should be filtered based on "+sFilterName+" : "+TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get(sFilterName).trim(), "Record for other Cost Center : "+sActFilterValue+ " found.", "Fail");
						}
					}
					else
					{
						if(!sActFilterValue.trim().equalsIgnoreCase(TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get(sFilterName).trim()))
						{
							obj.repAddData( "Verify all filtered records on Deals page", "Records should be filtered based on filter : "+TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get(sFilterName).trim(), "Record for other : "+sFilterName+ " found.", "Fail");
						}
					}
				}
			}	
				objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_exportActions_id,"Export",true,true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_exportActions_id, "Export", true);
				
				HashMap<Integer, HashMap<String, String>> mExcelDealData=null;
				String sFileName = "SphereDeals.xls";
				String sDownloadedData=FileLocSetter.sDownloadPath+sFileName;
			    mExcelDealData= objExcelUtility.fnGetExcelData(sDownloadedData,"SphereDeals","");
			    
			    for(int i=1;i<=mTableDataUI.size();i++)
			    {
			    	boolean bDealValidation = false;
			    	String sTableDealNumber = mTableDataUI.get(i).get(1);
			    	String sExcelDealNumber = "";
			    	String sFailReason = "";
			    	
			    	for(int j=1;j<=mExcelDealData.size();j++)
			    	{
			    		sExcelDealNumber = mExcelDealData.get(j).get("Deal Number");
			    		if(sTableDealNumber.equalsIgnoreCase(sExcelDealNumber))
			    		{
			    			bDealValidation = true;
			    			if(mTableDataUI.get(i).get(2).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Deal Title").trim()))
			    			{
			    				//obj.repAddData( "Verify Exported records for Deal title", "Records should match for Deal Title : ", "Record for Deal Title successfully matched", "Pass");
			    				System.out.println("record matched for Deal Title");
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Deal title not matching";
			    				bDealValidation = false;
			    				System.out.println(mExcelDealData.get(j).get("Deal Title"));
			    				obj.repAddData( "Verify  Exported record for Deal title", "Records should match for Deal Title : ", "Record for Deal Title not matched", "Fail");//deal title not matching
			    			}
			    			
			    			if(mTableDataUI.get(i).get(3).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Project or Production").trim()))
			    			{
			    				//obj.repAddData( "Verify  Exported record for Project", "Records should match for Project : ", "Records for Project successfully matched", "Pass");//deal title not matching//Project or Production match
			    				System.out.println("record matched for Project or Production");
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Project or Production not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify Exported record for Project", "Records should match for Project : ", "Records for Project not matched", "Fail");//deal title not matching//Project or Production match
			    			}
			    			
			    			if(mTableDataUI.get(i).get(4).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Customer Name").trim()))
			    			{
			    				//obj.repAddData( "Verify Exported record for customer Name", "Records should match for Customer Name : ", "Records for Customer Name successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report
			    				System.out.println("record matched for Customer Name");
			    			
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Customer Name not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify Exported records for customer Name", "Records should match for Customer Name: ", "Records for Customer Name not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report
			    			}
			    			
			    			if(mTableDataUI.get(i).get(5).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Customer Type").trim()))
			    			{
			    				//obj.repAddData( "Verify Exported records for Customer Type", "Records should match for Customer Type : ", "Records for Customer type successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report
			    				System.out.println("record matched for Customer Type");
			    			
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Customer Type not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify  Exported records for Customer Type", "Records should match for Customer Type : ", "Records for Customer type not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report
			    			}
			    			
			    			if(mTableDataUI.get(i).get(6).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Deal Type").trim()))
			    			{
			    				//obj.repAddData( "Verify  Exported records for Deal Type", "Records should match for Deal Type : ", "Records for Deal type successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Pass Report
			    				System.out.println("record matched for Deal Type");
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Deal Type not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify  Exported records for Deal Type", "Records should match for Deal Type : ", "Records for Deal Type not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report//Fail Report
			    			}
			    			
			    			if(mExcelDealData.get(i).get("Managing Cost Center").trim().contains(mTableDataUI.get(i).get(7).trim()))
			    			{
			    				//obj.repAddData( "Verify Exported records Managing Cost Center", "Records should match for Cost Center : ", "Records for Cost Center successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Pass Report//Pass Report
			    				System.out.println("record matched for Cost Center");
			    			
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Managing Cost Center not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify Exported records Managing Cost Center", "Records should match for Cost Center : ", "Records for Cost Center not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report//Fail Report//Fail Report
			    			}
			    			
			    			break;
			    		}
			    	}
			    	
			    	if(bDealValidation==true)
			    	{
			    		obj.repAddData( "Verify  Exported record for Deal Number", "Record should match for Deal Number : "+sTableDealNumber+" ", "Record for deal number successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report//Fail Report//Fail Report
			    		System.out.println("All records matched for deal number # "+sTableDealNumber+" matching");
			    		
			    	}
			    	else
			    	{
			    		if(sFailReason.equalsIgnoreCase(""))
			    		{
			    			sFailReason = "Deal not found in Excel sheet";
			    		}
			    		obj.repAddData( "Verify  Exported record for Deal Number", "Record should match for Deal Number : "+sTableDealNumber+" ", "Record for deal number not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report//Fail Report//Fail Report
			    		System.out.println("Deal validation failed for Deal Number # "+sTableDealNumber+" with reason : "+sFailReason);
			   
			    	}
			    	
			    }
			
			    //Header validation started
			   /* List<String> arrActHeaderList = new ArrayList<String>(); //remove comment from this line after the issue is fixed
			    String FirstRowData=mExcelDealData.get(1).toString().trim().toUpperCase();
			    String [] HeaderColumns=FirstRowData.split(",");
			    int size=HeaderColumns.length;
			    
			    for(int i=0;i<=size-1; i++)
			    {
			    String [] columnValue=FirstRowData.split(",");
			    String [] coldata=columnValue[i].split("=");
			    String colHeader=coldata[0].toString().trim();
			    arrActHeaderList.add(colHeader);
			    }
			    System.out.println(arrActHeaderList);  
			    String[] actArr = new String[arrActHeaderList.size()];
			    actArr = arrActHeaderList.toArray(actArr);
			    if(actArr[0].contains("{"))
			    {
			    	actArr[0] = actArr[0].replace("{","").trim();
			    }

			    String sExplist = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Excel_Header_List").trim();
			    String [] arrExpList = sExplist.split(";");
			    boolean sbFlag=true;
			    boolean isListEqual=false;
			    for (int i=0; i<arrExpList.length; i++)
			    {
			    	if (actArr[i].equalsIgnoreCase(arrExpList[i]))
	            	 {
	            		 sbFlag=true;
	            		 System.out.println(actArr[i]);
	            		 System.out.println(arrExpList[i]);
	            		 System.out.println("Matched");
	                 }
	            	 else
	            	 {
	            		 obj.repAddData( "Verify excel header column values", "excel header column " +arrExpList[i]+ " not matched", "excel header column"  +arrExpList[i]+ " not matched", "Fail");
	            		 System.out.println(actArr[i]);
	            		 System.out.println(arrExpList[i]);
	            		 System.out.println( i+ "not Matched"); 
	            	 }
	            	           	
			
			    
			        }
			     			    
			    if(sbFlag==true)
			    {
			    	   
			    	   List<String> list1 = Arrays.asList(actArr);
			    	   List<String> list2 = Arrays.asList(arrExpList);
			    	  
			    	  if(list1.equals(list2))
			    	  {
			    	   isListEqual=true;
			    	  }
			    }
            if(isListEqual==true)
            {
      	  
         	   obj.repAddData( "Verify excel header column values", "expected header columns  should be displayed in excel sheet", "expected header columns  displayed in excel sheet", "Pass");  
        
           }
            else
           {
            	obj.repAddData( "Verify excel header column values", "expected list header columns and actual header column list should be matched", "expected header columns list and actual header column list not matching", "Fail");
           }*/
			    
			  //Header validation ended
			    
			    /* else if(sbFlag==false)
			     {
           		 obj.repAddData( "Verify excel header column values", "expected header column  should be displayed in excel sheet", "expected header column  not displayed in excel sheet", "Fail");
           		 System.out.println( i+ "not Matched"); 
			     }*/
			   
			         
			    File fReportFile;
			    
			    fReportFile = new File(FileLocSetter.sDownloadPath+sFileName);
                objGenericFunctionLibrary.fnArchiveFile(fReportFile,sFileName);
                System.out.println("File Archive is done");		
			
			} catch (Exception e) {
				
		   System.out.println("fnVerifyDealExportData --------------Failed");    
		   TestDriver.log.error("fnVerifyDealExportData failed",e);
		   }
			
		}
		public void fnVerifyParentCompanyExportData(String sFilterName) throws Exception
		{
			
			try
			{
				
				HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewNationalAccountModule_Table_xp);
				System.out.println("Hello");
				boolean bFlag = false;
				
				objGenericFunctionLibrary.fnCheckFieldDisplayById(SphereModules.Deals_AddDeal_exportActions_id,"Export",true,true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_exportActions_id, "Export", true);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ParentCompany_Export_Popup_Alert))
				{
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.ParentCompany_Export_Popup_Alert_Yes_Btn_xp,"Yes button",true);
				
				}
				
				HashMap<Integer, HashMap<String, String>> mExcelDealData=null;
				String sFileName = "SphereParentCompanies.xls";
				String sDownloadedData=FileLocSetter.sDownloadPath+sFileName;
			    mExcelDealData= objExcelUtility.fnGetExcelData(sDownloadedData,"SphereParentCompanies","");
			    
			    for(int i=1;i<=mTableDataUI.size();i++)
			    {
			    	boolean bDealValidation = false;
			    	String sTableAccountNumber = mTableDataUI.get(i).get(1);
			    	String sExcelsTableAccountNumber = "";
			    	String sFailReason = "";
			    	
			    	for(int j=1;j<=mExcelDealData.size();j++)
			    	{
			    		sExcelsTableAccountNumber = mExcelDealData.get(j).get("Account Number");
			    		if(sTableAccountNumber.equalsIgnoreCase(sExcelsTableAccountNumber))
			    		{
			    			bDealValidation = true;
			    			if(mTableDataUI.get(i).get(2).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Account Name").trim()))
			    			{
			    				obj.repAddData( "Verify Exported records for Deal title", "Records should match for Deal Title : ", "Record for Deal Title successfully matched", "Pass");
			    				System.out.println("record matched for Account Name");
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Account Name not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify  Exported record for Account Name", "Records should match for Account Name : ", "Record for Account Name not matched", "Fail");//deal title not matching
			    			}
			    			
			    			if(mTableDataUI.get(i).get(3).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Customer Type").trim()))
			    			{
			    				obj.repAddData( "Verify  Exported record for Project", "Records should match for Project : ", "Records for Project successfully matched", "Pass");//deal title not matching//Project or Production match
			    				System.out.println("record matched for Customer Type");
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Customer Type not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify Exported record for Customer Type", "Records should match for Customer Type : ", "Records for Customer Type not matched", "Fail");//deal title not matching//Project or Production match
			    			}
			    			
			    			if(mTableDataUI.get(i).get(4).trim().equalsIgnoreCase(mExcelDealData.get(i).get("Production Type").trim()))
			    			{
			    				obj.repAddData( "Verify Exported record for customer Name", "Records should match for Customer Name : ", "Records for Customer Name successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report
			    				System.out.println("record matched for Production Type");
			    			
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; production Type not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify Exported records for Production Type", "Records should match for Production Type: ", "Records for Production Type not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report
			    			}
			    			
			    			String city=mExcelDealData.get(i).get("Main Address City").trim();
			    			String state=mExcelDealData.get(i).get("Main Address State").trim();
			    			String location=city+", "+state;
			    			System.out.println( mTableDataUI.get(i).get(5));
			    			if(mTableDataUI.get(i).get(5).trim().equalsIgnoreCase(location))
			    			{
			    				obj.repAddData( "Verify  Exported records for Location", "Records should match for Location : ", "Records for Location successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Pass Report
			    				System.out.println("record matched for Location");
			    			}
			    			else
			    			{
			    				sFailReason = sFailReason+" ; Location not matching";
			    				bDealValidation = false;
			    				obj.repAddData( "Verify  Exported records for Location", "Records should match for Location : ", "Records for Location not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report//Fail Report
			    			}
			    			
			    			break;
			    		}
			    	}
			    	
			    	if(bDealValidation==true)
			    	{
			    		obj.repAddData( "Verify  Exported record for Account Number", "Record should match for Account Number : "+sTableAccountNumber+" ", "Record for Account number successfully matched", "Pass");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report//Fail Report//Fail Report
			    		System.out.println("All records matched for Account number # "+sTableAccountNumber+" matching");
			    		
			    	}
			    	else
			    	{
			    		if(sFailReason.equalsIgnoreCase(""))
			    		{
			    			sFailReason = "Account Number not found in Excel sheet";
			    		}
			    		obj.repAddData( "Verify  Exported record for Deal Number", "Record should match for Deal Number : "+sTableAccountNumber+" ", "Record for deal number not matched", "Fail");//deal title not matching//Project or Production match//Pass Report//Fail Report//Pass Report//Fail Report//Fail Report//Fail Report
			    		System.out.println("Deal validation failed for Deal Number # "+sTableAccountNumber+" with reason : "+sFailReason);
			   
			    	}
			    	
			    }
			
			    //Header validation started
			    List<String> arrActHeaderList = new ArrayList<String>();
			    String FirstRowData=mExcelDealData.get(1).toString().trim().toUpperCase();
			    String [] HeaderColumns=FirstRowData.split(",");
			    int size=HeaderColumns.length;
			    
			    for(int i=0;i<=size-1; i++)
			    {
			    String [] columnValue=FirstRowData.split(",");
			    String [] coldata=columnValue[i].split("=");
			    String colHeader=coldata[0].toString().trim();
			    arrActHeaderList.add(colHeader);
			    }
			    System.out.println(arrActHeaderList);  
			    String[] actArr = new String[arrActHeaderList.size()];
			    actArr = arrActHeaderList.toArray(actArr);
			    if(actArr[0].contains("{")){
			    	actArr[0] = actArr[0].replace("{","").trim();
			    }

			    String sExplist = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Excel_Header_List").trim();
			    String [] arrExpList = sExplist.split(";");
			   // boolean sbFlag=true;
			    boolean sbFlag = false;
				boolean isListEqual=false;
			    for (int i=0; i<arrExpList.length; i++)
			    {
	            	 if (actArr[i].equalsIgnoreCase(arrExpList[i]))
	            	 {
	            		 sbFlag=true;
	                	 System.out.println(i+ " value Matched");
	            		 System.out.println(actArr[i]);
	            		 System.out.println(arrExpList[i]);
	            		 System.out.println("Matched");
	                 }
	            	 else
	            	 {
	            		 obj.repAddData( "Verify excel header column values", "excel header column " +arrExpList[i]+ " not matched", "excel header column"  +arrExpList[i]+ " not matched", "Fail");
	            		 System.out.println(actArr[i]);
	            		 System.out.println(arrExpList[i]);
	            		 System.out.println( i+ "not Matched"); 
	            	 }
	            	/* else if(sbFlag==false)
				     {
	            		 obj.repAddData( "Verify excel header column values", "expected header column  should be displayed in excel sheet", "expected header column  not displayed in excel sheet", "Fail");
	            		 System.out.println( i+ "not Matched"); 
				     }*/
			     }
			    if(sbFlag==true)
			    {
			    	   
			    	   List<String> list1 = Arrays.asList(actArr);
			    	   List<String> list2 = Arrays.asList(arrExpList);
			    	  if(list1.equals(list2))
			    	  {
			    	   isListEqual=true;
			    	  }
			       }
               if(isListEqual==true)
               {
         	  
            	   obj.repAddData( "Verify excel header column values", "expected header columns  should be displayed in excel sheet", "expected header columns  displayed in excel sheet", "Pass");  
           
              }
               else
              {
            	   obj.repAddData( "Verify excel header column values", "expected list header columns and actual header column list should be matched", "expected header columns list and actual header column list not matching", "Fail");
              }
			    
			       /*  if(sbFlag==true)
			         {
	            	  
	            	  obj.repAddData( "Verify excel header column values", "expected header columns  should be displayed in excel sheet", "expected header columns  displayed in excel sheet", "Pass");  
			         }*/
			   
			  //Header validation ended
			   
			         
			    File fReportFile;
			    
			    fReportFile = new File(FileLocSetter.sDownloadPath+sFileName);
                objGenericFunctionLibrary.fnArchiveFile(fReportFile,sFileName);
                System.out.println("File Archive is done");		
			
			} catch (Exception e) {
				
		   System.out.println("fnVerifyParentCompanyExportData --------------Failed");    
		   TestDriver.log.error("fnVerifyParentCompanyExportData failed",e);
		   }
			
		}


		 public void fnVerifySAPRecordsWithDB(String sTablepath,String sQuery,String CostObjectName) throws Exception
		 	{
		 	
		 		try
		 		{
		 			HashMap<Integer, HashMap<Integer, String>> mTableDataUI =objGenericFunctionLibrary.fnGetSapTableData(sTablepath);
					System.out.println("Hello");
					TestDriver.conn = objDBUtility.fnOpenDBConnection();
					TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
					
					objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
					
					
					for(int i=1;i<=mTableDataUI.size(); i++)
					{
						boolean bResultFlag = false;
						System.out.println(i+"Record:"+ mTableDataUI.get(i));												
						for(int j=1; j<=mTableDataDB.size();j++)
		                {
							System.out.println(i+"Record:"+ mTableDataDB.get(j));
							if(mTableDataUI.get(i).equals(mTableDataDB.get(j)))
							{
								bResultFlag = true;
							    System.out.println(i+" record matched");
							    obj.repAddData( "Compare  Cost Object "+CostObjectName+" records" , "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "Validation successful for  : "+mTableDataUI.get(i), "Pass");
							    break;
							}
		                  
		                }
						  if(bResultFlag == false)
						  {
							 System.out.println(i+"record not matched");
							//System.out.println(sSystemnameUI+ " "+ sSystemDealUI);
							obj.repAddData( "Compare  Cost Object "+CostObjectName+" records" , "Record on UI and DB should match for Cost Object "+CostObjectName+" : ", "Validation failed for  : "+mTableDataUI.get(i), "Fail");
						  }
						
					}
		 		
		 		
		 		} catch (Exception e) {
		 	   System.out.println("fnVerifyRecordsWithDB--------------Failed");    
		 	   TestDriver.log.error("fnVerifyRecordsWithDB failed",e);
		 	   }
		 		
		 	} 
		
		 public void fnAddresssearchPrecondition() throws Exception
		 	{
		 		try
		 		{
		 			    fnClickMainMenuElement("Deals");
					    WebDriverWait wait = new WebDriverWait(TestDriver.driver, 80);
					    wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
					    Thread.sleep(10000); 
						String sAltAddressLine1="420 SOUTH STATE STREET";//for new deal address/////
						//String sAltAddress="701 East University Avenue";///for existing deal address/////
						//String sAltAddressLine2="SUITE 100";
						//String sAltAddressLine3="OUTER DRIVE 100";
						String sAltcity="ANN ARBOR";
						String sAltCountry="UNITED STATES";
						String sAltState="MICHIGAN";
						String sZip="48109";
						String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						fnSelectCostCenter(1,sCostCenterUI);
						objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,sAltAddressLine1, "Search Address");
						objGenericFunctionLibrary.fnLoadingPageWait();
						
						//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_ExistAddressListSearch_xp, "First customer Row", true);
						
						boolean altAddressDisplayed =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_ExistAddressListSearch_xp)).getText().contains("420 SOUTH STATE STREET");
						System.out.println("Method returns : " + TestDriver.driver.findElement(By.xpath(SphereModules.Deals_ExistAddressListSearch_xp)).getText());
					    System.out.println("Method returns : " + altAddressDisplayed);
						
					    if(altAddressDisplayed==true)
					    {
					    	objGenericFunctionLibrary.fnCloseOpenedForm();
					    }
					    else
						{
						objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp," Address Button",true,true);
						objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Alternate Address Button",true);	
						
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine1_id, sAltAddressLine1, "Alternate Address Line 1");
						
						objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCountry_xp,sAltCountry);
						objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboState_xp,sAltState);
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputCity_xp, sAltcity, "Alt City");
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputZipId_id, sZip, "Alt Zip");
							
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Save_xp,"Add Alternate Address Button",true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						objGenericFunctionLibrary.fnCloseOpenedForm();
						}
		 		
						} catch (Exception e) {
		 	   System.out.println("fnAddresssearchPrecondition--------------Failed");    
		 	   TestDriver.log.error("fnAddresssearchPrecondition failed",e);
		 	   }
		 		
		 	}
		
		 public String fnAltAddressPresearchForAssociated(String sModule) throws Exception
		 	{
			 String sAltAddressLine1="";
		 		try
		 		{
		 			
		 			 //String sAltAddressLine1=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Search_Address").trim(); 
		 			 /* Date date = new Date();
	                  SimpleDateFormat sdf = new SimpleDateFormat("MMddyyyhhmmss");
	                  String formattedDate = sdf.format(date);*/
	                  String timeStamp = new SimpleDateFormat("yyyy-MM-dd.HH.mm.ss").format(new java.util.Date());
	                  System.out.println(timeStamp);
		 			    sAltAddressLine1="701 East "+timeStamp;//for new deal address/////+formattedDate;
						//String sAltAddress="701 East University Avenue";///for existing deal address/////
						String sAltAddressLine2="SUITE";
						String sAltAddressLine3="Outer Drive";
						String sAltcity="ANN ARBOR";
						String sAltCountry="UNITED STATES";
						String sAltState="MICHIGAN";
						String sZip="48109";
						String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
						boolean altAddressDisplayed;
						if(sModule.equalsIgnoreCase("Deals"))
						{
						fnClickMainMenuElement("Deals");
						WebDriverWait wait = new WebDriverWait(TestDriver.driver, 80);
						wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
						Thread.sleep(10000);
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						fnSelectCostCenter(1,sCostCenterUI);
						objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
						
						/*objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchAddresses_xp,sAltAddressLine1, "Search Address");
						objGenericFunctionLibrary.fnLoadingPageWait();
						
						altAddressDisplayed =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_ExistAddressListSearch_xp)).getText().contains("701 East University Avenue");
						System.out.println("Method returns : " + TestDriver.driver.findElement(By.xpath(SphereModules.Deals_ExistAddressListSearch_xp)).getText());
					    System.out.println("Method returns : " + altAddressDisplayed);
						
					    if(altAddressDisplayed==true)
					    {
					    	objGenericFunctionLibrary.fnCloseOpenedForm();
					    }else
						{*/
						objGenericFunctionLibrary.fnCheckFieldDisplayByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp," Address Button",true,true);
						objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Alternate Address Button",true);	
						
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine1_id, sAltAddressLine1, "Alternate Address Line 1");
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine2_id, sAltAddressLine2, "Alternate Address Line 2");
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputAddressLine3_id, sAltAddressLine3, "Alternate Address Line 3");
						objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCountry_xp,sAltCountry);
						objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboState_xp,sAltState);
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputCity_xp, sAltcity, "Alt City");
						objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputZipId_id, sZip, "Alt Zip");
							
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_Add_Address_Save_xp,"Add Alternate Address Button",true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						fnUSPSValidation("SAVE");
						objGenericFunctionLibrary.fnCloseOpenedForm();
						}
						//}
						if(sModule.equalsIgnoreCase("Customers"))
						{
							fnClickSubMenuElement("Customers Master","Customers");
							objGenericFunctionLibrary.fnLoadingPageWait();
							WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
							waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
							waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
							Thread.sleep(4000);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
							objGenericFunctionLibrary.fnLoadingPageWait();
							objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
							WebElement ele =TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp));
							System.out.println("Displayed>>>"+ele.isDisplayed());
							((JavascriptExecutor)TestDriver.driver).executeScript("arguments[0].scrollIntoView(true);", ele);
							objGenericFunctionLibrary.HighlightElement(ele);
						/*	objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Customers_AltAddress_SearchBar_xp,sAltAddressLine1, "Search Address");
							objGenericFunctionLibrary.fnLoadingPageWait();
							
							altAddressDisplayed =TestDriver.driver.findElement(By.xpath(SphereModules.Customers_Search_Alt_Address_First_Row_xp)).getText().contains("701 East University Avenue");
							System.out.println("Method returns : " + TestDriver.driver.findElement(By.xpath(SphereModules.Customers_Search_Alt_Address_First_Row_xp)).getText());
						    System.out.println("Method returns : " + altAddressDisplayed);
							
						    if(altAddressDisplayed==true)
							    {
							    	objGenericFunctionLibrary.fnCloseOpenedForm();
							    }else
								{*/
							
						    objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
							objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAltAddressLine1, "Alternate Address Line 1");
							objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAltAddressLine2, "Alternate Address Line 1");
							objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAltAddressLine3, "Alternate Address Line 1");
							objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sAltCountry);
							objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sAltState);
							objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sAltcity, "Alt City");
							objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZip, "Alt Zip");
							
							objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
							objGenericFunctionLibrary.fnLoadingPageWait();
							fnUSPSValidation("SAVE");
							objGenericFunctionLibrary.fnCloseOpenedForm();
						   
						
						}
						//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_ExistAddressListSearch_xp, "First customer Row", true);
						//}	
						
		 		
						} catch (Exception e) {
		 	   System.out.println("fnAltAddressPresearchForAssociated--------------Failed");    
		 	   TestDriver.log.error("fnAltAddressPresearchForAssociated failed",e);
		 	   }
		 		return sAltAddressLine1;
		 	} 
		 
		 
		 public String fnContactsearchPrecondition() throws Exception
		 	{
			 String sContactFirstName="";
		 		try
		 		{
		 			    fnClickMainMenuElement("Deals");
					    WebDriverWait wait = new WebDriverWait(TestDriver.driver, 80);
					    wait.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
					    Thread.sleep(5000); 
					    String timeStamp = new SimpleDateFormat("yyyy-MM-dd.HH.mm.ss").format(new java.util.Date());
		                System.out.println(timeStamp);
			 			sContactFirstName="FirstName"+timeStamp;//for new deal address/////+formattedDate;
			 			String sCtLastName="TestLastName";
						String sCtTitle="TestTitle";
						String sCtEmail="test@email.com";
							
						String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						fnSelectCostCenter(1,sCostCenterUI);
						/*objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchContacts_xp,sContactFirstName, "Search Contact");
						objGenericFunctionLibrary.fnLoadingPageWait();
						boolean contactDisplayed =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_ContactListSearch_xp)).getText().contains(sContactFirstName);
						System.out.println("Method returns : " + TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_ContactListSearch_xp)).getText());
					    System.out.println("Method returns : " + contactDisplayed);
					    if(contactDisplayed==true)
						{
					    	
					    	objGenericFunctionLibrary.fnCloseOpenedForm();
						}else
						{*/
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, sContactFirstName, "First Name ");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp,sCtLastName, "Last Name");
						
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, sCtTitle, "Title");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "2484621245", "Phone Number");
						//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp,sCtEmail, "Email Address");
						//objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
						//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						objGenericFunctionLibrary.fnCloseOpenedForm();
						//}
		 		      } catch (Exception e) {
		 	          System.out.println("fnContactsearchPrecondition--------------Failed");    
		 	          TestDriver.log.error("fnContactsearchPrecondition failed",e);
		 	         }
		 		
		 		return sContactFirstName;
		 	}  

		 public String fnAddMultiContactForsearchScenario() throws Exception
		 	{
			 String sNameRandom="";
		 		try
		 		{
		 			fnClickMainMenuElement("Deals");
					WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
					Thread.sleep(10000); 
					String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					fnSelectCostCenter(1,sCostCenterUI);
					WebElement ele =TestDriver.driver.findElement(By.xpath(SphereModules. Deals_AddDeal_AddNewContact_xp));
					((JavascriptExecutor) TestDriver.driver).executeScript("arguments[0].scrollIntoView(true);",ele);
					//HighlightElement(ele);
				    sNameRandom=String.valueOf(objGenericFunctionLibrary.fnRandomNum(222, 999));
					int contactCount=4;
					for(int i=1;i<=contactCount;i++)
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules. Deals_AddDeal_AddNewContact_xp, "Add Contact", true);
						String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
						//String sContactPhone="2487898989";
						//String sNameRandom=String.valueOf(objGenericFunctionLibrary.fnRandomNum(222, 999));
						String sphoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
						String sContactPhone ="248"+sphoneRandom;
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp,"AutoContactFirstName"+i+"_"+sNameRandom, "First Name");
						objGenericFunctionLibrary.fnLoadingPageWait();
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "AutoContactLastName"+i, "Last Name");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle"+i, "Title");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "automail"+i+"@email.com", "Email Address");
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
					}
				
					objGenericFunctionLibrary.fnCloseOpenedForm();
		 		      } catch (Exception e) {
		 	          System.out.println("fnAddMultiContactForsearchScenario--------------Failed");    
		 	          TestDriver.log.error("fnAddMultiContactForsearchScenario failed",e);
		 	         }
		 		return sNameRandom;
		 	}  
		 
		 public void fnVerifyExhausetedDealErrorMsg(String Department,String sDealsize) throws Exception
		 	{
		 	
		 		try
		 		{
		 			fnClickMainMenuElement("Deals");
					WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
					Thread.sleep(10000); 
					//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
					String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
					String NonmultiDeptCostCenter="CRAFT SERVICES";
					String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
					String sBulkDealTitle="AutoTestDeal_"+sRandom;
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					if(Department.equalsIgnoreCase("NonMultiDept"))
					{
						fnSelectCostCenter(1,NonmultiDeptCostCenter);
					}/*else
						if(Department.equalsIgnoreCase("MultiDept"))
						{
							fnSelectCostCenter(1,multiDeptCostCenter);
						}*/
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(3000);
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_NumberOfDeals_id, sDealsize, "Number of Deals");
					Thread.sleep(3000);
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sBulkDealTitle, "Deal Title");
					Thread.sleep(3000);
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_ExhaustedNumberofDeals_Error_xp);
					String sErrorMsg =TestDriver.driver.findElement(By.xpath(SphereModules.Deals_ExhaustedNumberofDeals_Error_xp)).getText().trim();
					System.out.println(sErrorMsg);
					String sExpMsg = AppMessages.Deals_ExhaustedNumberofDeals_Error_Msg;
					objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpMsg, sErrorMsg.trim());
					System.out.println(sErrorMsg);
					objGenericFunctionLibrary.fnCloseOpenedForm();
		 		     
		 		   }catch (Exception e) {
		 	          System.out.println("fnVerifyExhausetedDealErrorMsg--------------Failed");    
		 	          TestDriver.log.error("fnVerifyExhausetedDealErrorMsg failed",e);
		 	         }
		 		
		 	}  
		
	public void fnVerifyactiveinactivefilteredrecords(String sModule,String sTablexpath,int ColumnNum, String sFiltertype) throws Exception
	{
		
		try
		{
		   HashMap<Integer, HashMap<Integer, String>> mTableDataUI =objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_View_Sap_Table_xp);
			System.out.println("Hello");
			Boolean bResultFlag=false;
			int failedrecords=0;
			//String sTablexpath=objSphereModules.Common_View_Sap_Table_xp;
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				bResultFlag = false;
				String sDealNumber = mTableDataUI.get(i).get(1).toString();
				String ActualColor=TestDriver.driver.findElement(By.xpath(sTablexpath+"/tr["+i+"]/td["+ColumnNum+"]"+"/sp-status-color/i")).getAttribute("class");
				String [] arrClassName = ActualColor.split(" ");
		        String sStatus = arrClassName[arrClassName.length-1].toString().trim();
		       
		        if(sFiltertype.equalsIgnoreCase("Active"))
		        {
		        	
		        if(sStatus.equalsIgnoreCase("activeRecord"))
		        {
		            		        	
		           	bResultFlag = true;
		        	obj.repAddData("Verify active record is displayed ", "Active record should display in the table","Active record is displayed success fully", "Pass");
		        }				  
		        if(bResultFlag == false)
		        {
		        	failedrecords++;
		        	obj.repAddData("Verify active record is displayed ", "Active record should display in the table","Active record is not displayed", "Fail");
		        }
		        
		        } 
		        
		        
		    
		        else if(sFiltertype.equalsIgnoreCase("Inactive"))
				       
		        { 
		        	
		        	 if(sStatus.equalsIgnoreCase("inactiveRecord"))
				 {
				           
				        	bResultFlag = true;
				        	obj.repAddData("Verifying Inactive records ", sFiltertype+ " record should display in the table", sFiltertype+ " record  displayed successfully", "Pass");
				        }				  
				        if(bResultFlag == false)
				        {
				        	failedrecords++;
				        	obj.repAddData("Verifying Inactive records ", sFiltertype+ " record should display in the table",sFiltertype+ " record not displayed", "Fail");
				        }
		        }
		        
		  
			}
			if(failedrecords>0)
			{
					
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records not displayed on the screen", "Fail");
				}
					
			}
			else if(failedrecords==0)
			{
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records displayed successfully on the screen", "Pass");
				
				}
				
			}
			 if(sFiltertype.equalsIgnoreCase("Active"))
		        {
		        	String activeCount=TestDriver.driver.findElement(By.xpath(SphereModules.Common_ViewModules_ActiveCount_xp)).getText();
		        	activeCount = activeCount.split("[\\(\\)]")[1];
		        	String showingActiveCount=TestDriver.driver.findElement(By.xpath(SphereModules.Common_View_pagination_groupText_xp)).getText();
		            showingActiveCount=showingActiveCount.split("of")[1].trim().replace(".", "");
		           // org.testng.Assert.assertEquals(activeCount, showingActiveCount);
		            objGenericFunctionLibrary.fnVerifyLabelMsgText(activeCount, showingActiveCount.trim());
					System.out.println(showingActiveCount);
		        }
			
			 else if(sFiltertype.equalsIgnoreCase("Inactive"))
				       
			   { 
			        	String inactiveCount=TestDriver.driver.findElement(By.xpath(SphereModules.Common_ViewModules_ActiveCount_xp)).getText();
			        	inactiveCount = inactiveCount.split("[\\(\\)]")[1];
			        	String showinginActiveCount=TestDriver.driver.findElement(By.xpath(SphereModules.Common_View_pagination_groupText_xp)).getText();
			            showinginActiveCount=showinginActiveCount.split("of")[1].trim().replace(".", "");; 
			            objGenericFunctionLibrary.fnVerifyLabelMsgText(inactiveCount, showinginActiveCount.trim());
						System.out.println(showinginActiveCount);
			   }
			
		  }catch (Exception e) {
			  obj.repAddData("Verify active or inactive records count ", "Active record should display in the table","Active record is not displayed", "Fail");
 	          System.out.println("fnVerifyactiveinactivefilteredrecords--------------Failed");    
 	          TestDriver.log.error("fnVerifyactiveinactivefilteredrecords failed",e);
 	         }
 		
 	}  

	
	public void fnVerifyQueueLoggingStatusfilteredrecords(String sModule,String sTablexpath,int ColumnNum, String sFilterName,String expStatus) throws Exception
	{
		
		try
		{
		   HashMap<Integer, HashMap<Integer, String>> mTableDataUI =objGenericFunctionLibrary.fnGetTableData(sTablexpath);
			System.out.println("Hello");
			Boolean bResultFlag=false;
			int failedrecords=0;
			String sFiltertype="";
			//String sTablexpath=objSphereModules.Common_View_Sap_Table_xp;
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				bResultFlag = false;
				String sActFilterText = mTableDataUI.get(i).get(1).toString();
				String ActualColor=TestDriver.driver.findElement(By.xpath(sTablexpath+"/tr["+i+"]/td["+ColumnNum+"]"+"/sp-status-color/i")).getAttribute("class");
				String [] arrClassName = ActualColor.split(" ");
		        String sActualStatus = arrClassName[arrClassName.length-1].toString().trim();
		       
		        //if(sFiltertype.equalsIgnoreCase("Active"))
		        //if(sFiltertype.equalsIgnoreCase(sFilterName))
		        if(sActFilterText.equalsIgnoreCase(sFilterName) && sActualStatus.equalsIgnoreCase(expStatus))
		        {
		        	
		           	bResultFlag = true;
		        	obj.repAddData("Verify filter name and color ", sFilterName+ " record should display in the table",sFilterName+ " record is displayed successfully", "Pass");
		        
		        } 
		       
		        if(bResultFlag == false)
		        {
		        	failedrecords++;
		        	obj.repAddData("Verify filter name and color ", sFilterName+ " record should display in the table",sFilterName+ " record is not displayed successfully", "Fail");
		        }
		        
		  
			}
						
		/*	if(failedrecords>0)
			{
					
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records not displayed on the screen", "Fail");
				}
					
			}
			else if(failedrecords==0)
			{
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records displayed successfully on the screen", "Pass");
				
				}
				
			}*/
			 
			
		  }catch (Exception e) {
			  obj.repAddData("Verify active or inactive records count ", "Active record should display in the table","Active record is not displayed", "Fail");
 	          System.out.println("fnVerifyactiveinactivefilteredrecords--------------Failed");    
 	          TestDriver.log.error("fnVerifyactiveinactivefilteredrecords failed",e);
 	         }
 		
 	}
	
	
	public void fnVerifySuspensePagefilteredrecords(String sModule,String sTablexpath,int ColumnNum, String sExpFilterText) throws Exception
	{
		
		try
		{
		   HashMap<Integer, HashMap<Integer, String>> mTableDataUI =objGenericFunctionLibrary.fnGetTableData(sTablexpath);
			System.out.println("Hello");
			Boolean bResultFlag=false;
			int failedrecords=0;
			String sFiltertype="";
			//String sTablexpath=objSphereModules.Common_View_Sap_Table_xp;
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				bResultFlag = false;
				String sActFilterText = mTableDataUI.get(i).get(ColumnNum).toString();
				
		        //if(sFiltertype.equalsIgnoreCase("Active"))
		        //if(sFiltertype.equalsIgnoreCase(sFilterName))
		        if(sActFilterText.equalsIgnoreCase(sExpFilterText) )
		        {
		        	
		           	bResultFlag = true;
		        	obj.repAddData("Verify filter name and color ", sExpFilterText+ " record should display in the table",sExpFilterText+ " record is displayed successfully", "Pass");
		        
		        } 
		       
		        if(bResultFlag == false)
		        {
		        	failedrecords++;
		        	obj.repAddData("Verify filter name and color ", sExpFilterText+ " record should display in the table",sExpFilterText+ " record is not displayed successfully", "Fail");
		        }
		        
		  
			}
						
		/*	if(failedrecords>0)
			{
					
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records not displayed on the screen", "Fail");
				}
					
			}
			else if(failedrecords==0)
			{
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records displayed successfully on the screen", "Pass");
				
				}
				
			}*/
			 
			
		  }catch (Exception e) {
			  obj.repAddData("Verify active or inactive records count ", "Active record should display in the table","Active record is not displayed", "Fail");
 	          System.out.println("fnVerifyactiveinactivefilteredrecords--------------Failed");    
 	          TestDriver.log.error("fnVerifyactiveinactivefilteredrecords failed",e);
 	         }
 		
 	}
	
	
	public void fnVerifyDealStatusfilteredrecords(String sModule,String sTablexpath,int ColumnNum, String sFilterName,String expStatus) throws Exception
	{
		
		try
		{
		   HashMap<Integer, HashMap<Integer, String>> mTableDataUI =objGenericFunctionLibrary.fnGetTableData(sTablexpath);
			System.out.println("Hello");
			Boolean bResultFlag=false;
			int failedrecords=0;
			String sFiltertype="";
			//String sTablexpath=objSphereModules.Common_View_Sap_Table_xp;
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				bResultFlag = false;
				//String sActFilterText = mTableDataUI.get(i).get(1).toString();
				String ActualColor=TestDriver.driver.findElement(By.xpath(sTablexpath+"/tr["+i+"]/td["+ColumnNum+"]"+"/sp-status-color/i")).getAttribute("class");
				String [] arrClassName = ActualColor.split(" ");
		        String sActualStatus = arrClassName[arrClassName.length-1].toString().trim();
		       
		        //if(sFiltertype.equalsIgnoreCase("Active"))
		        //if(sFiltertype.equalsIgnoreCase(sFilterName))
		        if(sActualStatus.equalsIgnoreCase(expStatus))
		        {
	        	
		           	bResultFlag = true;
		        	obj.repAddData("Verify filter name and color ", sFilterName+ " record should display in the table",sFilterName+ " record is displayed successfully", "Pass");
		        
		        } 
		       
		        if(bResultFlag == false)
		        {
		        	failedrecords++;
		        	obj.repAddData("Verify filter name and color ", sFilterName+ " record should display in the table",sFilterName+ " record is not displayed successfully", "Fail");
		        }
		        
		  
			}
			
			
			
			
			
		/*	if(failedrecords>0)
			{
					
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records not displayed on the screen", "Fail");
				}
					
			}
			else if(failedrecords==0)
			{
				{
					obj.repAddData( "Compare all "+mTableDataUI.size()+" filtered records displayed on the screen", "All " +sFiltertype+ " records on UI should be displayed", "All " +sFiltertype+ " records displayed successfully on the screen", "Pass");
				
				}
				
			}*/
			 
			
		  }catch (Exception e) {
			  obj.repAddData("Verify active or inactive records count ", "Active record should display in the table","Active record is not displayed", "Fail");
 	          System.out.println("fnVerifyactiveinactivefilteredrecords--------------Failed");    
 	          TestDriver.log.error("fnVerifyactiveinactivefilteredrecords failed",e);
 	         }
 		
 	}  
	public void fnSelectPerformingCostCenter(int iCostCenter,String sCostCenter) throws Exception
	{
		//String sCostCenter = String.valueOf(iCostCenter);
		try
		{/*
			 List<WebElement> lsCostCenters = TestDriver.driver.findElements(By.xpath(SphereModules.Users_AddUser_SelectCostCenters_xp));
			 //List<WebElement> lsCostCenters = TestDriver.driver.findElements(By.xpath(SphereModules.Deals_AddDeal_UseCostCenter_xp));
			  
			 lsCostCenters.get(iCostCenter).click(); //Select first cost center //li starts with blank and cost center 1, cost center 2 and so on 
			 
			 obj.repAddData( "Select Cost Center "+sCostCenter+"'", "Cost Center '"+sCostCenter+"' should be selected", "Cost Center '"+sCostCenter+"' selected successfully", "Pass");
*/
	            objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_AddEditModules_PerformingCostCenterCostCenter_xp, sCostCenter, "Search Cost Center");
	            objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_ListSearchedCostCenter_xp, "Searched "+sCostCenter, true);
	            
		
		
		} catch (Exception e) {
			 obj.repAddData( "Select Cost Center "+sCostCenter+"'", "Cost Center '"+sCostCenter+"' should be selected", "Cost Center '"+sCostCenter+"' not selected", "Fail");
	   System.out.println("fnSelectPerformingCostCenter --------------Failed");    
	   TestDriver.log.error("fnSelectPerformingCostCenter failed",e);
	   }
}

	public static void fnCopyFileToSharedDrive(String sFilePath, String sShareddDrivePath) 
	{
		
		System.out.println("Copying local file "+sFilePath +" to shared drive "+sShareddDrivePath);
		try {
			
			String xCopyCommand = "cmd.exe /c copy \"" + sFilePath + "\"" + " \"" +sShareddDrivePath + "\"";
			System.out.println(xCopyCommand);
			@SuppressWarnings("unused")
			Process process = Runtime.getRuntime().exec(xCopyCommand); 
			
		} catch (Exception e) {
			System.out.println("Error occurred while making a copy of the source file with timestamp::: "+ e.getMessage());
		} 
	}

	
	 public String fnoldArchiveFile(String srcFilePath,String filename) throws Exception 
	   {
                      
	                 String targetFileName=null;
	                 Date date = new Date();
	                  SimpleDateFormat sdf = new SimpleDateFormat("MMddyyyhhmmss");
	                  String formattedDate = sdf.format(date);
	                  System.out.println(formattedDate);
	                  //File srcFile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC.TXT");
	                 
	                  File srcFile=new File(srcFilePath+filename);
	                  String[] arrFileName = filename.toString().split("\\.");
	                  try {    
	                        File theDir = new File(FileLocSetter.sTestDataPath+"Arch");
	                        if(srcFile.exists())
	                        {
	                              if (!theDir.exists()) 
	                              {
	                                    System.out.println("creating directory: " + theDir);
	                                    theDir.mkdirs();
	                              }
	                              else
	                              {
	                                  System.out.println("Arch folder already created");
	                              }
	                              
	                              File fDest = new File(FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"_"+formattedDate+"."+arrFileName[1].toString().trim());
	                              System.out.println(srcFile.toPath());
	                              File copyfile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC_Copy.TXT");
	                              System.out.println(srcFile.getName());
	                              Files.copy(srcFile.toPath(), copyfile.toPath(), StandardCopyOption.REPLACE_EXISTING);
	                            //  Files.copy(copyfile.toPath(),srcFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
	                              
	                               Files.move(srcFile.toPath(), fDest.toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);
	                               copyfile.renameTo(srcFile);
	                               targetFileName=FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"_"+formattedDate+"."+arrFileName[1].toString().trim();
	    
	                        }
	                        else
	                        {
	                              System.out.println("File not found");
	                        }
	                        //fnReadtextfile();
	                    
	                } catch (Exception e) {
	        			System.out.println("Error occurred while making a copy of the source file with timestamp::: "+ e.getMessage());
	        		} 
	                
	   return targetFileName;
	        
	   
	 
	   }
	
	 public static void fnoldReadReplaceTextFile() 
		{

		 String file = FileLocSetter.sTestDataPath+"TEST.TXT";

		 try {

		    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
		    String line;
		    String sNewDeal ="672581";
	        BufferedWriter output = null;
		    // Uncomment the line below if you want to skip the fist line (e.g if headers)
		    // line = br.readLine();
		    String sFinalText = "";
		    while ((line = br.readLine()) != null) {
		    	
		    	sFinalText = sFinalText+line;
		    	if(line.contains("SL"))
		    	{
		    		String sDeal = line.split(" ")[0].substring(20, 26);
		    		sFinalText = sFinalText.replaceAll(sDeal, sNewDeal);
		    	}

		    }
	    	output = new BufferedWriter(new FileWriter(file));
            output.write(sFinalText);
            output.close();    
		    br.close();
		 
		 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " + file);
		    e.printStackTrace();  
		 }
			} 
	
	 public static String fnnewArchiveFile(String srcFilePath,String filename) throws Exception 
	   {
	                  
	                 String targetFileName=null;
	                 Date date = new Date();
	                  SimpleDateFormat sdf = new SimpleDateFormat("MMddyyyhhmmss");
	                  String formattedDate = sdf.format(date);
	                  System.out.println(formattedDate);
	                  //File srcFile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC.TXT");
	                 
	                  File srcFile=new File(srcFilePath+filename);
	                  String[] arrFileName = filename.toString().split("\\.");
	                  
	                  try {    
	                        File theDir = new File(FileLocSetter.sTestDataPath+"Arch");
	                        if(srcFile.exists())
	                        {
	                              if (!theDir.exists()) 
	                              {
	                                    System.out.println("creating directory: " + theDir);
	                                    theDir.mkdirs();
	                              }
	                              else
	                              {
	                                  System.out.println("Arch folder already created");
	                              }
	                              
	                              File fDest = new File(FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"_"+formattedDate+"."+arrFileName[1].toString().trim());
	                              System.out.println(fDest);
	                              System.out.println(srcFile.toPath());
	                             /* File copyfile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC_Copy.TXT");
	                              System.out.println(srcFile.getName());
	                              Files.copy(srcFile.toPath(), copyfile.toPath(), StandardCopyOption.REPLACE_EXISTING);*/
	                              
	                            //  Files.copy(copyfile.toPath(),srcFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
	                              
	                               Files.copy(srcFile.toPath(), fDest.toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);
	                               //copyfile.renameTo(srcFile);
	                              // targetFileName=FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"_"+formattedDate+"."+arrFileName[1].toString().trim();
	                               targetFileName=fDest.getPath();
	                              
	                        }
	                        else
	                        {
	                              System.out.println("File not found");
	                        }
	                        //fnReadtextfile();
	                    
	                } catch (Exception e) {
	        System.out.println("Error occurred while making a copy of the source file with timestamp::: "+ e.getMessage());
	        } 
	                
	   return targetFileName;
	        
	   
	 
	   }

	 public static String fnnewArchiveFilei81(String srcFilePath,String filename) throws Exception
     {
           
                   String targetFileName=null;
                   Date date = new Date();
                    SimpleDateFormat sdf = new SimpleDateFormat("MMddyyyhhmmss");
                    String formattedDate = sdf.format(date);
                    System.out.println(formattedDate);
                    //File srcFile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC.TXT");
                  
                    File srcFile=new File(srcFilePath+filename);
                    String[] arrFileName = filename.toString().split("\\.");
                   
                    try {   
                         // File theDir = new File(FileLocSetter.sTestDataPath+"Arch");
                      File theDir = new File(FileLocSetter.sTestDataPath);
                          if(srcFile.exists())
                          {
                                if (!theDir.exists())
                                {
                                      System.out.println("creating directory: " + theDir);
                                      theDir.mkdirs();
                                }
                                else
                                {
                                    System.out.println("Arch folder already created");
                                }
                               
                                File fDest = new File(FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"."+arrFileName[1].toString().trim());
                              //  File fDest = new File(FileLocSetter.sTestDataPath+arrFileName[0].toString().trim()+"_"+formattedDate+"."+arrFileName[1].toString().trim());
                                System.out.println(fDest);
                                System.out.println(srcFile.toPath());
                               /* File copyfile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC_Copy.TXT");
                                System.out.println(srcFile.getName());
                                Files.copy(srcFile.toPath(), copyfile.toPath(), StandardCopyOption.REPLACE_EXISTING);*/
                               
                              //  Files.copy(copyfile.toPath(),srcFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
                               
                                 Files.copy(srcFile.toPath(), fDest.toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);
                                 //copyfile.renameTo(srcFile);
                                 targetFileName=FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"."+arrFileName[1].toString().trim();
                                 targetFileName=fDest.getPath();
                               
                          }
                          else
                          {
                                System.out.println("File not found");
                          }
                          //fnReadtextfile();
                     
                  } catch (Exception e) {
                          System.out.println("Error occurred while making a copy of the source file with timestamp::: "+ e.getMessage());
                    }
                  
     return targetFileName;
         
     
   
     }
	 /*public static String fnnewArchiveFilei81(String srcFilePath,String filename) throws Exception 
	   {
                  
	                 String targetFileName=null;
	                 Date date = new Date();
	                  SimpleDateFormat sdf = new SimpleDateFormat("MMddyyyhhmmss");
	                  String formattedDate = sdf.format(date);
	                  System.out.println(formattedDate);
	                  //File srcFile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC.TXT");
	                 
	                  File srcFile=new File(srcFilePath+filename);
	                  String[] arrFileName = filename.toString().split("\\.");
	                  
	                  try {    
	                       // File theDir = new File(FileLocSetter.sTestDataPath+"Arch");
	                	  File theDir = new File(FileLocSetter.sTestDataPath);
	                        if(srcFile.exists())
	                        {
	                              if (!theDir.exists()) 
	                              {
	                                    System.out.println("creating directory: " + theDir);
	                                    theDir.mkdirs();
	                              }
	                              else
	                              {
	                                  System.out.println("Arch folder already created");
	                              }
	                              
	                              File fDest = new File(FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"."+arrFileName[1].toString().trim()+"_"+formattedDate+"."+arrFileName[2].toString().trim());
	                            //  File fDest = new File(FileLocSetter.sTestDataPath+arrFileName[0].toString().trim()+"_"+formattedDate+"."+arrFileName[1].toString().trim());
	                              System.out.println(fDest);
	                              System.out.println(srcFile.toPath());
	                              File copyfile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC_Copy.TXT");
	                              System.out.println(srcFile.getName());
	                              Files.copy(srcFile.toPath(), copyfile.toPath(), StandardCopyOption.REPLACE_EXISTING);
	                              
	                            //  Files.copy(copyfile.toPath(),srcFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
	                              
	                               Files.copy(srcFile.toPath(), fDest.toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);
	                               //copyfile.renameTo(srcFile);
	                               targetFileName=FileLocSetter.sTestDataPath+"Arch\\"+arrFileName[0].toString().trim()+"."+arrFileName[1].toString().trim()+"_"+formattedDate+"."+arrFileName[2].toString().trim();
	                               targetFileName=fDest.getPath();
	                              
	                        }
	                        else
	                        {
	                              System.out.println("File not found");
	                        }
	                        //fnReadtextfile();
	                    
	                } catch (Exception e) {
	        			System.out.println("Error occurred while making a copy of the source file with timestamp::: "+ e.getMessage());
	        		} 
	                
	   return targetFileName;
	        
	   
	 
	   }*/
	
	
	 public static void fnReadReplaceTextFile(String sDestFilePath,String sFieldName, String sNewValue) 
		{
		 //String file = FileLocSetter.sTestDataPath+"TEST.TXT";

		 try {
			int iStartLoc = 0; 
			int iEndLoc = 0; 
			if(sFieldName.equalsIgnoreCase("Deal"))
			{
				iStartLoc = 20;
				iEndLoc = 26;
			}
			if(sFieldName.equalsIgnoreCase("DealOrder"))
			{
				iStartLoc = 20;
				iEndLoc = 29;
			}
			if(sFieldName.equalsIgnoreCase("DeptSysNum"))
			{
				/*iStartLoc = 2;
				iEndLoc = 12;*/
				iStartLoc = 3;
				iEndLoc = 12;
			}
			if(sFieldName.equalsIgnoreCase("PoNo"))
			{
				iStartLoc = 34;
				iEndLoc = 39;
			}
			if(sFieldName.equalsIgnoreCase("SLDeptSysNum"))
			{
				iStartLoc = 5;
				iEndLoc = 12;
			}
			if(sFieldName.equalsIgnoreCase("sapAccountNumber"))
			{
				iStartLoc = 242;
				iEndLoc = 266;
			}if(sFieldName.equalsIgnoreCase("sapCostobject"))
			{
				iStartLoc = 266;
				iEndLoc = 274;
			}
			 
		    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sDestFilePath)));
		    String line;
	        BufferedWriter output = null;
		    // Uncomment the line below if you want to skip the fist line (e.g if headers)
		    // line = br.readLine();
		    String sFinalText = "";
		   // int length=br.readLine().lenght();
		    while ((line = br.readLine()) != null) {
		    	System.out.println("ERROR: unable to read file " + line.length());	
		    	
		    	
		    	sFinalText = sFinalText+line+"\r\n";
	    		//String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);
		    	String sDeal = line.substring(iStartLoc, iEndLoc);
	    		sFinalText = sFinalText.replaceAll(sDeal, sNewValue);


		    }
	    	output = new BufferedWriter(new FileWriter(sDestFilePath));
	    	output.write(sFinalText);
	    	output.close();    
		    br.close();
		 
		 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " + sDestFilePath);
		    e.printStackTrace();  
		 }
	} 
	 
	 
	
	 
	 
	 
	 public static void fnNewReadReplaceTextFile(String sDestFilePath,String sFieldName, String sNewValue) 
		{
		 //String file = FileLocSetter.sTestDataPath+"TEST.TXT";

		 try {
			int iStartLoc = 0; 
			int iEndLoc = 0; 
			if(sFieldName.equalsIgnoreCase("Deal"))
			{
				iStartLoc = 20;
				iEndLoc = 26;
			}
			if(sFieldName.equalsIgnoreCase("DealOrder"))
			{
				iStartLoc = 20;
				iEndLoc = 29;
			}
			if(sFieldName.equalsIgnoreCase("DeptSysNum"))
			{
				iStartLoc = 2;
				iEndLoc = 12;
				/*iStartLoc = 5;
				iEndLoc = 12;*/
			}
			if(sFieldName.equalsIgnoreCase("SLDeptSysNum"))
			{
				iStartLoc = 5;
				iEndLoc = 12;
			}
			if(sFieldName.equalsIgnoreCase("PoNumber"))
			{
				iStartLoc = 34;
				iEndLoc = 40;
			}
			
			 
		    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sDestFilePath)));
		    String line;
	        BufferedWriter output = null;
		    // Uncomment the line below if you want to skip the fist line (e.g if headers)
		    // line = br.readLine();
		    String sFinalText = "";
		   // int length=br.readLine().lenght();
		    while ((line = br.readLine()) != null) {
		    	System.out.println("ERROR: unable to read file " + line.length());	
		    	
		    	
		    	sFinalText = sFinalText+line+"\r\n";
	    		//String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);
		    	String sDeal = line.substring(iStartLoc, iEndLoc);
		    	System.out.println(sDeal);
		    	System.out.println(sNewValue);
		    	sFinalText = sFinalText.replaceAll(sDeal, sNewValue);
		    	
		    }
	    	output = new BufferedWriter(new FileWriter(sDestFilePath));
	    	output.write(sFinalText);
	    	output.close();    
		    br.close();
		 
		 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " + sDestFilePath);
		    e.printStackTrace();  
		 }
	} 
	 
	 public static void fnReadReplaceTextFileSecondRow(String sDestFilePath,String sFieldName, String sNewValue) 
		{
		 //String file = FileLocSetter.sTestDataPath+"TEST.TXT";

		 try {
			int iStartLoc = 0; 
			int iEndLoc = 0; 
			if(sFieldName.equalsIgnoreCase("Deal"))
			{
				iStartLoc = 20;
				iEndLoc = 26;
			}
			if(sFieldName.equalsIgnoreCase("DealOrder"))
			{
				iStartLoc = 20;
				iEndLoc = 29;
			}
			if(sFieldName.equalsIgnoreCase("DeptSysNum"))
			{
				iStartLoc = 2;
				iEndLoc = 12;
				
				
				/*iStartLoc = 5;
				iEndLoc = 12;*/
			}
			if(sFieldName.equalsIgnoreCase("SLDeptSysNum"))
			{
				iStartLoc = 5;
				iEndLoc = 12;
			}
			
			 
		    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sDestFilePath)));
		    String line;
		    int linecount=0;
	        BufferedWriter output = null;
		    // Uncomment the line below if you want to skip the fist line (e.g if headers)
		    // line = br.readLine();
		    String sFinalText = "";
		    Scanner input = new Scanner(new File(sDestFilePath));
	        while (input.hasNextLine()) {
	            String data = input.nextLine();
	            linecount++;
	           
	            
	            if(linecount>1){
	            	
		    		//String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);
			    	String sDeal = data.substring(iStartLoc, iEndLoc);
		    		sFinalText = sFinalText.replaceAll(sDeal, sNewValue);
	            }
	            sFinalText = sFinalText+data+"\r\n";
	        }
	        //System.out.println("total line count=:"+linecount);
	       
		   /* while ((line = br.readLine()) != null) {
		    	
		    	
		    /*	linecount=Integer.parseInt(line);
		    	//System.out.println("total line count=:"+linecount);
		    	sFinalText = sFinalText+line+"\r\n";
	    		//String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);
		    	String sDeal = line.substring(iStartLoc, iEndLoc);
	    		sFinalText = sFinalText.replaceAll(sDeal, sNewValue);*/


		    //}*/
	    	output = new BufferedWriter(new FileWriter(sDestFilePath));
	    	output.write(sFinalText);
	    	output.close();    
		    br.close();
		 
		 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " + sDestFilePath);
		    e.printStackTrace();  
		 }
	} 
	 public static void fnReadReplacei81TextFile(String sDestFilePath,String sFieldName, String sNewValue) 
		{
		 //String file = FileLocSetter.sTestDataPath+"TEST.TXT";

		 try {
			int iStartLoc = 0; 
			int iEndLoc = 0; 
			if(sFieldName.equalsIgnoreCase("Deal"))
			{
				iStartLoc = 20;
				iEndLoc = 26;
			}
			if(sFieldName.equalsIgnoreCase("DealOrder"))
			{
				iStartLoc = 65;
				iEndLoc = 74;
			}
			if(sFieldName.equalsIgnoreCase("DeptSysNum"))
			{
				iStartLoc = 3;
				iEndLoc = 12;
			}
			
			if(sFieldName.equalsIgnoreCase("Date"))
			{
				iStartLoc = 342;
				iEndLoc = 350;
			}
			 
		    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sDestFilePath)));
		    String line;
	        BufferedWriter output = null;
		    // Uncomment the line below if you want to skip the fist line (e.g if headers)
		    // line = br.readLine();
		    String sFinalText = "";
		    while ((line = br.readLine()) != null) {
		    	
		    	sFinalText = sFinalText+line+"\r\n";
	    		//String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);
		    	String sDeal = line.substring(iStartLoc, iEndLoc);
	    		sFinalText = sFinalText.replaceAll(sDeal, sNewValue);


		    }
	    	output = new BufferedWriter(new FileWriter(sDestFilePath));
	    	output.write(sFinalText);
	    	output.close();    
		    br.close();
		 
		 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " + sDestFilePath);
		    e.printStackTrace();  
		 }
	} 
	
	 public  void fnVerifyBillingInvalidCostobjectexception() 
		{

		 try {
		
	    obj.repAddData( "Verifying  Billing Request Invalid Cost Object exception", "", "", "");
		
		obj.repAddData( "File upload to shared drive is a prerequisite", "", "", "");
		
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    //String sDealNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
	    //String sDealNumberRandom="673127";
	    String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumber=mTableDataDB1.get(1).get(1).toString().trim();
	    //String DealNumber="673137";
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumber , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		    
	    
	   // String DealNumber=fnCreateandCloseDeal();
		String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
		    //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
		System.out.println(sDeptSyssNumberRandom);
	   
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_DC - InvalidCostObject.TXT");
	    System.out.println(targetFileName);
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",DealNumber);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
	    Thread.sleep(7000);
	    //String DealNumberDB="678741";
	   
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(objSphereModules.BillingRequest_Table_xp));
				
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(objSphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumber , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			
		obj.repAddData( "Verifying Billing cost object exception background color ", "", "", "");
		fnVerifyBackGroundColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
			
		obj.repAddData( "Verifying Billing cost object invalid text when user hover over", "", "", "");
		fnVerifyExceptionTextWithMouse("Cost Object",objSphereModules.BillingRequest_CostObject_xp,SphereModules.BillingRequest_InvalidCostObject_Text_xp,"Cost Object Invalid"); 
			
			
        objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Exceptions_ExpandIcon_xp, "Expand Icon", true);
		
		WebElement eleTable1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_View_Transactions_Table_xp));
		List<WebElement> arrHeaderColumns1 = eleTable1.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns1.size());
		
		obj.repAddData( "Verifying Transaction cost object exception background color ", "", "", "");
		fnVerifyBackGroundColor("TransactionCostObject",objSphereModules.BillingRequest_TransactionCostObject_Text_xp);
		
		obj.repAddData( "Verifying Transaction cost object invalid  text when user hover over ", "", "", "");
        fnVerifyExceptionTextWithMouse("Cost Object",objSphereModules.BillingRequest_TransactionCostObject_Text_xp,objSphereModules.BillingRequest_Transaction_Row_InvalidCostObject_Text_xp,"Cost Object Invalid");
        
        obj.repAddData( "Verifying cost object invalid  text on Transaction Slide out ", "", "", "");
        
        objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Transactions_Table_First_Row_xp, "First Row", true);
       
        WebElement ele1=TestDriver.driver.findElement(By.xpath(SphereModules.BillingRequest_Transaction_BtnCancel_xp));
     	((JavascriptExecutor) TestDriver.driver).executeScript("arguments[0].scrollIntoView(true);", ele1);
     	
        fnVerifyExceptionTextOnSlideOut("Cost Object","Transaction Slide out",SphereModules.BillingRequest_CostObjectInvalid_Text_xp,"Cost Object Invalid");
		        
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_Transaction_BtnCancel_xp,"Cancel",true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Exceptions_ExpandIcon_xp, "Expand Icon", true);
				
		/*obj.repAddData( "Verifying Billing Request PopUP Messages ", "", "", "");
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DealNumber_xp, "Deal Number", true);
		Thread.sleep(4000);///since we are taking closed deal we can't verify pop up message
		fnClickExceptionVerifyPopUp();*/
			
		obj.repAddData( "Verifying cost object invalid  text on Billing Request Slide out ", "", "", "");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Dept Sys Number", true);
		Thread.sleep(6000);
		fnVerifyExceptionTextOnSlideOut("Cost Object","Billing Request Slide out",SphereModules.BillingRequest_CostObjectInvalid_Text_xp,"Cost Object Invalid");
					
		
		String validCostObject="000004800004";
		objGenericFunctionLibrary.SendKeyById(objSphereModules.Transaction_costObject_id, validCostObject , "Cost Object");
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
				
		obj.repAddData( "Verifying cost object Exception resolved color ", "", "", "");
		fnVerifyResolvedColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, " " , "Search Box");
		Thread.sleep(6000);
		
		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}
		
		if(objGenericFunctionLibrary.ElementFound(SphereModules.BillingRequest_ExitForm_Yes_xp))
		{

			objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_ExitForm_Yes_xp,"Yes I'm Sure",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(4000);
			obj.repAddData( "Verify Exit form is not displayed : ", "Exit Form should not display with out editing form", "Exit form is displayed", "Fail");
		
		}
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }
}
	 public  void fnVerifyTransactionInvalidCostobjectexception() throws Exception 
		{

		 try {
		
	    obj.repAddData( "Verifying  Billing Request Invalid Cost Object exception", "", "", "");
		
		obj.repAddData( "File upload to shared drive is a prerequisite", "", "", "");
		
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    //String sDealNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
	    //String sDealNumberRandom="673127";
	    String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumber=mTableDataDB1.get(1).get(1).toString().trim();
	    //String DealNumber="673141";
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumber , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
			    
	   
		
	    
	    
	    
	   // String DealNumber=fnCreateandCloseDeal();
		  String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
		    //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
		    System.out.println(sDeptSyssNumberRandom);
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_DC - InvalidCostObject.TXT");
	    System.out.println(targetFileName);
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",DealNumber);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
	    Thread.sleep(7000);
	    //String DealNumberDB="678741";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(objSphereModules.BillingRequest_Table_xp));
				
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(objSphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumber , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			
		obj.repAddData( "Verifying Billing cost object exception background color ", "", "", "");
		fnVerifyBackGroundColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
			
		obj.repAddData( "Verifying Billing cost object invalid text when user hover over", "", "", "");
		fnVerifyExceptionTextWithMouse("Cost Object",objSphereModules.BillingRequest_CostObject_xp,SphereModules.BillingRequest_InvalidCostObject_Text_xp,"Cost Object Invalid"); 
			
			
        objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Exceptions_ExpandIcon_xp, "Expand Icon", true);
		
		WebElement eleTable1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_View_Transactions_Table_xp));
		List<WebElement> arrHeaderColumns1 = eleTable1.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns1.size());
		
		obj.repAddData( "Verifying Transaction cost object exception background color ", "", "", "");
		fnVerifyBackGroundColor("TransactionCostObject",objSphereModules.BillingRequest_TransactionCostObject_Text_xp);
		
		obj.repAddData( "Verifying Transaction cost object invalid  text when user hover over ", "", "", "");
        fnVerifyExceptionTextWithMouse("Cost Object",objSphereModules.BillingRequest_TransactionCostObject_Text_xp,objSphereModules.BillingRequest_Transaction_Row_InvalidCostObject_Text_xp,"Cost Object Invalid");
     
        obj.repAddData( "Verifying cost object invalid  text on Transaction Slide out ", "", "", "");
     
        objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Transactions_Table_First_Row_xp, "First Row", true);
    
        WebElement ele1=TestDriver.driver.findElement(By.xpath(SphereModules.BillingRequest_Transaction_BtnCancel_xp));
  	   ((JavascriptExecutor) TestDriver.driver).executeScript("arguments[0].scrollIntoView(true);", ele1);
  	
        fnVerifyExceptionTextOnSlideOut("Cost Object","Transaction Slide out",SphereModules.BillingRequest_CostObjectInvalid_Text_xp,"Cost Object Invalid");
        String validCostObject="000004800004";
		objGenericFunctionLibrary.SendKeyById(objSphereModules.Transaction_costObject_id, validCostObject , "Cost Object");
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_Transaction_BtnSave_xp, "Save", true);
		Thread.sleep(6000);       
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_Transaction_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.fnCloseOpenedForm();

		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Exceptions_ExpandIcon_xp, "Expand Icon", true);
				
		/*obj.repAddData( "Verifying Billing Request PopUP Messages ", "", "", "");
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DealNumber_xp, "Deal Number", true);
		Thread.sleep(4000);///since we are taking closed deal we can't verify pop up message
		fnClickExceptionVerifyPopUp();*/
		
		//objGenericFunctionLibrary.fnCloseOpenedForm();
		//Thread.sleep(6000);
				
		obj.repAddData( "Verifying cost object Exception resolved color ", "", "", "");
		fnVerifyResolvedColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, " " , "Search Box");
		Thread.sleep(6000);
		
		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }
		 finally {
			 objGenericFunctionLibrary.fnCloseOpenedForm();
		
		 }
		 
		 } 
	 
	 
	 public  void fnVerifyMissingCostobjectexception() 
		{

		 try {
		
	    obj.repAddData( "Verifying  Billing Request Missing Cost Object exception", "", "", "");
		
		obj.repAddData( "File upload to shared drive is a prerequisite", "", "", "");
		
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    
	    String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    //String DealNumberDB="673147";
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
	    
	    
	    String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
	    //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	  
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_DC - DealNotOpenMissingCostObject.TXT");
	    System.out.println(targetFileName);
	    
	  /*  String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_DC - MissingCostObject.TXT");
	    System.out.println(targetFileName);*/
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",DealNumberDB);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
	    Thread.sleep(10000);
	    //String DealNumberDB="678741";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(SphereModules.BillingRequest_Table_xp));
				
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(SphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			obj.repAddData( "Verifying Billing cost object exception background color ", "", "", "");
			fnVerifyBackGroundColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
				
			obj.repAddData( "Verifying Billing cost object missing text when user hover over", "", "", "");
			fnVerifyExceptionTextWithMouse("Cost Object",objSphereModules.BillingRequest_CostObject_xp,SphereModules.BillingRequest_MissingCostObject_Text_xp,"Cost Object Missing"); 
				
				
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Exceptions_ExpandIcon_xp, "Expand Icon", true);
		
		WebElement eleTable1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_View_Transactions_Table_xp));
		List<WebElement> arrHeaderColumns1 = eleTable1.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns1.size());
		
		obj.repAddData( "Verifying Transaction cost object exception background color ", "", "", "");
		fnVerifyBackGroundColor("TransactionCostObject",objSphereModules.BillingRequest_TransactionCostObject_Text_xp);
		
		obj.repAddData( "Verifying Transaction cost object missing  text when user hover over ", "", "", "");
        fnVerifyExceptionTextWithMouse("Cost Object",objSphereModules.BillingRequest_TransactionCostObject_Text_xp,objSphereModules.BillingRequest_Transaction_Row_MissingCostObject_Text_xp,"Cost Object Missing");
        
        obj.repAddData( "Verifying cost object invalid  text on Transaction Slide out ", "", "", "");
        
        objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Transactions_Table_First_Row_xp, "First Row", true);

        WebElement ele1=TestDriver.driver.findElement(By.xpath(SphereModules.BillingRequest_Transaction_BtnCancel_xp));
     	((JavascriptExecutor) TestDriver.driver).executeScript("arguments[0].scrollIntoView(true);", ele1);
        
        fnVerifyExceptionTextOnSlideOut("Cost Object","Transaction Slide out",SphereModules.BillingRequest_CostObjectMissing_Text_xp,"Cost Object Missing");
       	
				
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_Transaction_BtnCancel_xp,"Cancel",true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_View_Exceptions_ExpandIcon_xp, "Expand Icon", true);
				
        obj.repAddData( "Verifying cost object missing  text on Billing Request Slide out ", "", "", "");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Dept Sys Number", true);
		Thread.sleep(6000);
		fnVerifyExceptionTextOnSlideOut("Cost Object","Billing Request Slide out",SphereModules.BillingRequest_CostObjectMissing_Text_xp,"Cost Object Missing");
				
		
		String validCostObject="000004800004";
		objGenericFunctionLibrary.SendKeyById(objSphereModules.Transaction_costObject_id, validCostObject , "Cost Object");
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		
		obj.repAddData( "Verifying cost object Exception resolved color ", "", "", "");
		fnVerifyResolvedColor("CostObject",objSphereModules.BillingRequest_CostObject_xp);
		
		objGenericFunctionLibrary.fnCloseOpenedForm();
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, " " , "Search Box");
		Thread.sleep(6000);
		
		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}

		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }
 }

 public  void fnVerifyOrdernotopenCostobjectexception() 
	
	 {

		 try {
			 
		String sNewValue=fnCreateDealOrderforexception("Closed Order","Open Deal");
		System.out.println(sNewValue);
		
		String sDealNumberUI=sNewValue.substring(0,6);
		String sOrderUI=sNewValue.substring(6,9);
		
		String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
		sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
		sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    
		String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
		
		obj.repAddData( "Verifying  Billing Request Order not open exception", "", "", "");
		
		obj.repAddData( "File upload to shared drive is a prerequisite", "", "", "");
		
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	   
	    String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
	    //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - OrderNotOpen.TXT");
	    System.out.println(targetFileName);
	   // String targetFileName=fnnewArchiveFile("C:\\Merged_Automation_Workspace\\SphereAutomation\\TestData\\","CHSLGRIP_DC - OrderCostObject.TXT");
	   // System.out.println(targetFileName);
	   
	     
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
	    Thread.sleep(7000);
	    //String DealNumberDB="678741";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(SphereModules.BillingRequest_Table_xp));
			
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(SphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sNewValue , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
		
		obj.repAddData( "Verifying Billing cost object exception background color ", "", "", "");
		fnVerifyBackGroundColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
				
		
		obj.repAddData( "order status update to open", "", "", "");
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_OrderNumber_xp, "Order Number", true);
		Thread.sleep(6000);
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		
		obj.repAddData( "Verifying the order column color after the order status is updated ", "", "", "");
		fnVerifyResolvedColor("Order",objSphereModules.BillingRequest_OrderNumber_xp);
		
        obj.repAddData( "Verifying cost object invalid  text on Billing Request Slide out ", "", "", "");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Dept Sys Number", true);
		Thread.sleep(6000);
		fnVerifyExceptionTextOnSlideOut("Cost Object","Billing Request Slide out",SphereModules.BillingRequest_CostObjectInvalid_Text_xp,"Cost Object Invalid");
		
		
		String validCostObject="000004800004";
		objGenericFunctionLibrary.SendKeyById(objSphereModules.Transaction_costObject_id, validCostObject , "Cost Object");
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		
		obj.repAddData( "Verifying cost object Exception resolved color ", "", "", "");
		fnVerifyResolvedColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
		
		
		obj.repAddData( "Verifying Exception record is not displayed after exceptions resolved ", "", "", "");
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sNewValue , "Search Box");
		Thread.sleep(6000);
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is displayed on exception screen", "Exception records validation failed", "Fail");
		
		}else
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is not displayed on exception screen", "Exception records validation successful", "Pass");
		}

		
		
		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is not displayed on exception screen", "Exception records validation failed", "Fail");
		}
		
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }
}

	 
	 public  void fnVerifyDealOrderCostObjectexception()throws Exception 
		{

		try {
		
	    obj.repAddData( "Create deal,order and closing the deal,order", "", "", "");
	   
	    //String sNewValue=fnCreateDealOrderforexception("Closed Order","Closed Deal");
	    
	    String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    //String DealNumberDB="672763";
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
			    
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    
	    String sDeptSyssNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	    
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - DealNotOpen.TXT");
	    System.out.println(targetFileName);
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",DealNumberDB);
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);

	   // String DealNumberDB="672441";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(objSphereModules.BillingRequest_Table_xp));
			
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(objSphereModules.BillingRequest_Table_xp));
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			
		fnVerifyBackGroundColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DealNumber_xp, "Deal Number", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusOpen_xp, "Deal Open Status", true);	
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Billing Request Row", true);
		Thread.sleep(6000);
		
		fnVerifyResolvedColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		
		fnVerifyBackGroundColor("Order",SphereModules.BillingRequest_OrderNumber_xp);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_OrderNumber_xp, "Order Number", true);
		Thread.sleep(6000);
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		
		fnVerifyResolvedColor("Order",objSphereModules.BillingRequest_OrderNumber_xp);
			
		
		String validCostObject="000004800004";
		objGenericFunctionLibrary.SendKeyById(objSphereModules.Transaction_costObject_id, validCostObject , "Cost Object");
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		
		String Resolvedcolor=TestDriver.driver.findElement(By.xpath(objSphereModules.BillingRequest_CostObject_xp)).getCssValue("border-bottom-color");
		System.out.println(Resolvedcolor);
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record should not be displayed on exception screen", "Exception records validation failed", "Fail");
		
		}else
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is not displayed on exception screen", "Exception records validation successful", "Pass");
		}

	}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }


		}
	 
	 public  void fnVerifyDealnotOpenexception()throws Exception 
		{

		try {
		
	    obj.repAddData( "Creating  deal is prerequisite", "", "", "");
	   
	    
	   String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    //String DealNumberDB="673147";
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
			    
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    
	    String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
	    //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	    
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_DC - DealNotOpen - Resolution.TXT");
	    System.out.println(targetFileName);
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",DealNumberDB);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);

	   // String DealNumberDB="672441";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(objSphereModules.BillingRequest_Table_xp));
			
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(objSphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
		
		fnVerifyBackGroundColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DealNumber_xp, "Deal Number", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusOpen_xp, "Deal Open Status", true);	
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Billing Request Row", true);
		Thread.sleep(4000);
		
		fnVerifyResolvedColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		
	/*	obj.repAddData( "order status update to open", "", "", "");
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_OrderNumber_xp, "Order Number", true);
		Thread.sleep(6000);
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);*/
		
		//obj.repAddData( "Verifying the order column color after the order status is updated ", "", "", "");
		
		//fnVerifyResolvedColor("Order",objSphereModules.BillingRequest_OrderNumber_xp);  removed this step because record will not appear on screen
								
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is displayed on exception screen", "Exception records validation failed", "Fail");
		
		}else
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is not displayed on exception screen", "Exception records validation successful", "Pass");
		}

	}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, " " , "Search Box");
		Thread.sleep(6000);
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }


		}
	 
	 
	 
	 public  String fnCreateDealOrderforexception4(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		//String sPoNumberUI = "PO_"+sRandom;
		//String sPoNumberUI = sPoRandom;
		String sPoNumberUI = "501128";
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

/*		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");*/
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		
		//fnSelectCostCenter(1,sCostCenterUI);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Common_AddEditModules_InputSearchCostCenter_xp, "SET LIGHTING - CA");
	//	objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_InputSearchCostCenter_xp, "Cost Center",true);
	//	objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_cost_center_xp, "SET LIGHTING - CA",true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 
	 public  String fnCreateDCSDealOrder(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		String sPoNumberUI = sPoRandom;
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		//objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		//fnSelectCostCenter(1,sCostCenterUI);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_CostObject_id, "0010017050","Cost Object");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_AccountNumber_id, "0073122009","SAP Account Number");
		Thread.sleep(4000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_cost_center_xp, "SET LIGHTING - CA",true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		Thread.sleep(3000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 
	 public  String fnCreateDCSDealOrderwithNewCustomer(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
	  //sDealTitleUI = objBusinessLib.fnAddDealAccountWithCustomer(18, mTestPhaseData.get(iTC_ID).get("Cost_Center"),false,true,"");
	    String sDealTitleUI =fnAddDCSDealAccountWithCustomerforBilling(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"),true,false,"","DCS - Direct Charge Summary");
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		String sPoNumberUI = sPoRandom;
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		//objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		//fnSelectCostCenter(1,sCostCenterUI);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_CostObject_id, "0010017050","Cost Object");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_AccountNumber_id, "0073122009","SAP Account Number");
		Thread.sleep(4000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_cost_center_xp, "SET LIGHTING - CA",true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		Thread.sleep(3000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 
	 public  String fnCreateDETDealOrderwithNewCustomer(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
	  //sDealTitleUI = objBusinessLib.fnAddDealAccountWithCustomer(18, mTestPhaseData.get(iTC_ID).get("Cost_Center"),false,true,"");
	    String sDealTitleUI =fnAddDETDealAccountWithCustomerforBilling(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"),true,false,"","DET - Detailed Invoice");
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		String sPoNumberUI = sPoRandom;
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		//fnSelectCostCenter(1,sCostCenterUI);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_CostObject_id, "0010017050","Cost Object");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_AccountNumber_id, "0073122009","SAP Account Number");
		Thread.sleep(4000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_cost_center_xp, "SET LIGHTING - CA",true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		Thread.sleep(3000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 
	 
	 public  void fnVerifyBillableNonBillableFlag(String Flag) 
		{
		 String targetFileName=null;
		 try {
			 String sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
			 System.out.println(sNewValue);
			 //String sNewValue="685741001";
			 String sDealNumberUI=sNewValue.substring(0,6);
			 String sOrderUI=sNewValue.substring(6,9);

			 String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
			 sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
			 sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
			 TestDriver.conn = objDBUtility.fnOpenDBConnection();
			 TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
			 HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);

			 String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();

			 String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
			 //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
			 System.out.println(sDeptSyssNumberRandom);
			 if(Flag.equalsIgnoreCase("Billable")){
				 targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation1\\TestData\\","SLGRIPN1117_TC_Billable_648.txt");
				 System.out.println(targetFileName);
			 }else 
				 if(Flag.equalsIgnoreCase("NonBillable")){
					 targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation1\\TestData\\","SLGRIPN1117_TC_NonBillable_648.txt");
					 System.out.println(targetFileName);	 
				 }
			 BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
			 BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);	
			 BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
			 BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
			 Thread.sleep(10000);			

			 // BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);

			 WebDriverWait waitForTableLoad;	
			 waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			 fnClickSubMenuElement("Billing","ARC");
			 waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
			 WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
			 objGenericFunctionLibrary.HighlightElement(Title);

			 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 Thread.sleep(4000);

			 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
			 {
				 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
				 objGenericFunctionLibrary.fnLoadingPageWait();
				 Thread.sleep(4000);
				 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
				 {

					 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
					 Thread.sleep(6000);
					 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1))
					 {

						 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
						 objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
						 //ClickByXpath(sFilterBtn, "Filter btn", true);
						 Thread.sleep(4000);
						 WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

						 if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
						 {
							 obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
							 System.out.println("Transactions exist");	

						 }
						 else{
							 obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


						 }
					 }

				 }

			 }
			 
			    WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
				List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
				System.out.println("Data Rows Size>>>>"+arrTableRows.size());
				
				for(int iRow=0;iRow<arrTableRows.size();iRow++)  //Exclude first header row 
	 			{	
	 				List<WebElement> arrTableColumns = arrTableRows.get(iRow).findElements(By.xpath("./td"));  //Get the table data rows
	 				arrTableColumns.get(0).findElement(By.xpath("./input")).click();  //Select the checkbox
	 					

	 		    }
						
				 if(Flag.equalsIgnoreCase("Billable"))
				 {
				objGenericFunctionLibrary.ClickById(SphereModules.Users_ViewUser_BtnBulkActions_id, "BulkActions", true);
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Approved_BulkOption_Non_Bilable_xp, "Non-Billable", true);
	 			Thread.sleep(4000);
	 			
	 			WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereModules.ARC_Screen_MakeTransactionNonBillableForm_Title_xp));
	 			objGenericFunctionLibrary.HighlightElement(Titleele);
	 			Titleele.click();		
	 			Thread.sleep(5000);
	 				 			
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_MakeTransactionNonBillableForm_Continue_Btn_xp, "Continue Btn", true);
	 			Thread.sleep(4000);
	 			
	 			if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Suspend_Error_xp))
				{
					obj.repAddData( "Verify  error text on suspend transaction page: ", "error text Should be dispalyed", "Validation successful for error message ", "Pass");  
					System.out.println("Transactions exist");	
					
				}
				else
				{
					obj.repAddData( "Verify  error text on suspend transaction page: ", "error text Should be dispalyed", "Validation not successful for error message ", "Fail");
					
				
				}
			 			
	 			objGenericFunctionLibrary.SendKeyById(SphereModules.ARC_Screen_notes_id,"Testing","Notes text box");
	 			Thread.sleep(3000);

	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_MakeTransactionNonBillableForm_Continue_Btn_xp, "Continue Btn", true);
	 			Thread.sleep(6000);

	 			//ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
	 			//Thread.sleep(4000);
	 			//WebElement ArcTable = driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

	 			if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
	 			{
	 				obj.repAddData( "Verify  transactions on ARC Screen: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should  be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
	 				System.out.println("Transactions exist");	


	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify  transactions on ARC Screen: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


	 			}
	 			
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_DealPanel_Clear_Btn, "Deal clear", true);
	 			Thread.sleep(4000);
	 			
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
	 			objGenericFunctionLibrary.fnLoadingPageWait();
	 			Thread.sleep(4000);
	 			
	 			if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
	 			{
	 				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
	 				objGenericFunctionLibrary.fnLoadingPageWait();
	 				Thread.sleep(4000);
	 				
	 				fnSelectDynamicFilters("Billable Category","Non-Billable Revenue",2);
	 				
	 				
	 				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
	 				{

	 					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
	 					Thread.sleep(6000);
	 					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_2)){

	 						objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_2, "Order", true);
	 						objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
	 						//ClickByXpath(sFilterBtn, "Filter btn", true);
	 						Thread.sleep(4000);
	 						WebElement ArcTable1 = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

	 						if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
	 						{
	 							obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
	 							System.out.println("Transactions exist");	

	 						}
	 						else{
	 							obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


	 						}
	 					}

	 				}

	 			}
	 			
	 			
		 }
				 
				 
			if(Flag.equalsIgnoreCase("NonBillable"))
				 {
				objGenericFunctionLibrary.ClickById(SphereModules.Users_ViewUser_BtnBulkActions_id, "BulkActions", true);
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Approved_BulkOption_Bilable_xp, "Billable", true);
	 			Thread.sleep(4000);
	 			
	 			WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereModules.ARC_Screen_MakeTransactionBillableForm_Title_xp));
	 			objGenericFunctionLibrary.HighlightElement(Titleele);
	 			Titleele.click();		
	 			Thread.sleep(5000);
	 			objGenericFunctionLibrary.fnCheckFieldDoesNotExistById(SphereModules.ARC_Screen_notes_id,"notes field",true);
	 				 				 			
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_MakeTransactionBillableForm_Continue_Btn_xp, "Continue Btn", true);
	 			Thread.sleep(4000);


	 			if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
	 			{
	 				obj.repAddData( "Verify  transactions on ARC Screen: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
	 				System.out.println("Transactions exist");	


	 			}
	 			else
	 			{
	 				obj.repAddData( "Verify  transactions on ARC Screen: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


	 			}
	 			
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_DealPanel_Clear_Btn, "Deal clear", true);
	 			Thread.sleep(4000);
	 			
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
	 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
	 			objGenericFunctionLibrary.fnLoadingPageWait();
	 			Thread.sleep(4000);
	 			
	 			if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
	 			{
	 				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
	 				objGenericFunctionLibrary.fnLoadingPageWait();
	 				Thread.sleep(4000);
	 				
	 				fnSelectDynamicFilters("Billable Category","Billable Revenue",2);
	 				
	 				
	 				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
	 				{

	 					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
	 					Thread.sleep(6000);
	 					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_2)){

	 						objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_2, "Order", true);
	 						objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
	 						//ClickByXpath(sFilterBtn, "Filter btn", true);
	 						Thread.sleep(4000);
	 						WebElement ArcTable1 = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

	 						if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
	 						{
	 							obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
	 							System.out.println("Transactions exist");	

	 						}
	 						else{
	 							obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


	 						}
	 					}

	 				}

	 			}
	 		
		 }
	  
	  

		


		 } catch (Exception e) {
			 System.out.println("Error occurred"+ e.getMessage());
		 } 
		}

	 
	 
	 
	 public  void fnVerifyOldBackGroundColor(String sExceptionColXpath, String sColName,String ResolvedColXpath) 
		{
			
			try {
				String pinkColor="rgba(202, 2, 74, 0.74902)";
				String Whitecolor="rgb(255, 255, 255)";
				String lightcolor="rgb(249, 249, 249)";
				String color=TestDriver.driver.findElement(By.xpath(sExceptionColXpath)).getCssValue("background-color");
				System.out.println(color);
								
				if(color!=null){
					obj.repAddData( "Verifying cost object exception color ", "", "", "");
					
					if(color.equals(pinkColor))
					{	
						obj.repAddData( "Verifying exception color for " +sColName, " exception color should be displayed in pink color", pinkColor+ " color is displayed ", "Pass");
				    }
					else
				    {
				    	obj.repAddData( "Verifying exception color for " +sColName, " exception color  should be displayed in pink color", pinkColor+ " color is not displayed ", "Fail");
				    }
					 
				}else
				{
					obj.repAddData( "Verifying cost object Resolved color ", "", "", "");
					String resolvedcolor=TestDriver.driver.findElement(By.xpath(ResolvedColXpath)).getCssValue("background-color");
					System.out.println(resolvedcolor);
					if(resolvedcolor.equals(Whitecolor)||resolvedcolor.equals(lightcolor))
					{	
						obj.repAddData( "Verifying Resolved color for " +sColName, " Resolved color should be displayed in white color", Whitecolor+ " color is displayed ", "Pass");
				    }
					else
				    {
				    	obj.repAddData( "Verifying Resolved color for " +sColName, " Resolved color  should be displayed in White color", Whitecolor+ " color is not displayed ", "Fail");
				    }
					 
				}
				//if(driver.findElement(By.xpath(objSphereModules.BillingRequest_OrderNumber_xp)).getCssValue("background-color").toString().equals(Redcolor));
				
				
				
			} catch (Exception e) {
				System.out.println("Error occurred"+ e.getMessage());
			} 
		}
	 
	 public  void fnVerifyBackGroundColor(String sColName,String sExceptionColXpath) 
		{
			
			try {
				//String pinkColor="rgba(202, 2, 74, 0.74902)";
				String pinkColor="rgba(202, 2, 74, 0.75)";
				String Whitecolor="rgb(255, 255, 255)";
				String lightcolor="rgb(249, 249, 249)";
				String color=TestDriver.driver.findElement(By.xpath(sExceptionColXpath)).getCssValue("background-color");
				System.out.println(color);
								
				if(color!=null){
					obj.repAddData( "Verifying cost object exception color ", "", "", "");
					
					if(color.equals(pinkColor))
					{	
						obj.repAddData( "Verifying exception color for " +sColName, " exception color should be displayed in pink color", pinkColor+ " color is displayed ", "Pass");
				    }
					else
				    {
				    	obj.repAddData( "Verifying exception color for " +sColName, " exception color  should be displayed in pink color", pinkColor+ " color is not displayed ", "Fail");
				    }
					 
				
					 
				}
				//if(driver.findElement(By.xpath(objSphereModules.BillingRequest_OrderNumber_xp)).getCssValue("background-color").toString().equals(Redcolor));
				
				
				
			} catch (Exception e) {
				System.out.println("Error occurred"+ e.getMessage());
			} 
		}
	 public  void fnVerifyDSNAllPopUps(String sDeptSyssNumberRandom,String InterceptMenuOptionXpath,String InterceptMenuOptionName,String PopupTitleXpath) 
		{
			
			try {
				
				objGenericFunctionLibrary.RightClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row");
				Thread.sleep(3000);
				objGenericFunctionLibrary.ClickByXpath(InterceptMenuOptionXpath, InterceptMenuOptionName, true);
				Thread.sleep(4000); 
				objGenericFunctionLibrary.ClickByXpath(PopupTitleXpath, "Poupup Title", true);
				Thread.sleep(4000);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_PopMenu_DSN_Number_xp, "DSN Number", true);
				Thread.sleep(4000);
	 		   
				String Exptext="SL"+sDeptSyssNumberRandom;
				String ActualText=TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_PopMenu_DSN_Number_xp)).getText().trim();
	 			
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_PopMenu_DSN_Number_xp))
				{
					if(ActualText.contains(Exptext))
					{
						obj.repAddData( "Verify  DSN number text in popups: ", "DSN number Should be dispalyed", "DSN number is dispalyed", "Pass");  
						System.out.println(ActualText);	
					}else
					{
						obj.repAddData( "Verify  DSN number text in popups: ", "DSN number Should be dispalyed", "DSN number is not dispalyed", "Fail");	
					}
				}else
				{
					obj.repAddData( "Verify  DSN number is displayed: ", "DSN number Should be dispalyed", "DSN number is not dispalyed", "Fail");

				}
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Popup_Close_xp, "Close Button", true);
				Thread.sleep(4000);
				
			} catch (Exception e) {
				System.out.println("Error occurred"+ e.getMessage());
			} 
		}
	 
	 public  void fnVerifyExceptionTextWithMouse(String sColName,String sExceptionColXpath,String sActExceptionTextXpath,String sExpexctedText) 
		{
			
			try {
												
				WebElement Ele =TestDriver.driver.findElement(By.xpath(sExceptionColXpath));
				Actions builder = new Actions(TestDriver.driver);
				builder.moveToElement(Ele).build().perform();
				Thread.sleep(4000);
				String ActualText=TestDriver.driver.findElement(By.xpath(sActExceptionTextXpath)).getText().trim();;
				String ExpInvalidCostObjectText=sExpexctedText;
				objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpInvalidCostObjectText,ActualText);
				Thread.sleep(6000);
			
			
			} catch (Exception e) {
				System.out.println("Error occurred"+ e.getMessage());
			} 
		}
	 
	 public  void fnVerifyExceptionTextOnSlideOut(String sColName,String sSlideOut,String sActExceptionTextXpath,String sExpexctedText) throws Exception 
		{
			
		try {
	 
		
		String expText=sExpexctedText;
		String ActText=TestDriver.driver.findElement(By.xpath(sActExceptionTextXpath)).getText().trim();
		String ActTextColor=TestDriver.driver.findElement(By.xpath(sActExceptionTextXpath)).getCssValue("color");
		System.out.println(ActTextColor);
		String redColor="rgba(202, 2, 74, 1)";
		
		if(ActText.contains(expText)&&
				ActTextColor.equals(redColor))
			{
					obj.repAddData( "Verify invalid  text and text color on " +sSlideOut, expText+ " text should be displayed on " +sSlideOut, expText+ " text and " +redColor+ " displayed succesfully on " +sSlideOut, "Pass");
			}
			 else
			{
					obj.repAddData( "Verify invalid  text and text color on " +sSlideOut, expText+ " text should be displayed on " +sSlideOut, expText+ " text and " +redColor+ " not displayed on " +sSlideOut, "Fail");
			}
			
			
} catch (Exception e) {
	obj.repAddData("Element not found on the page", " "," ","Fail");
	System.out.println("Error occurred"+ e.getMessage());
} 
}

	 
	 
	 public  void fnVerifyAmountDealnotexistCostobjectexception() 
		{

		 try {
			 
		
		obj.repAddData( "Verifying  Billing Request Amount,Deal not exist,cost object exception alert message verification", "", "", "");
		
		obj.repAddData( "File upload to shared drive is a prerequisite", "", "", "");
		
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    String sDealNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
	    //String sDealNumberRandom="677900";
	    String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
	    //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	    
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_DC - AmountCostObjectException.TXT");
	    System.out.println(targetFileName);
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",sDealNumberRandom);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	   
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);

	    //String DealNumberDB="678741";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(SphereModules.BillingRequest_Table_xp));
			
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(SphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sDealNumberRandom , "Search Box");
		Thread.sleep(6000);
       
		obj.repAddData( "Verifying column color and Deal not exist alert message", "", "", "");
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
		fnVerifyBackGroundColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DealNumber_xp, "Deal Number", true);
        Thread.sleep(6000);
        fnClickExceptionVerifyPopUp();
        
        obj.repAddData( "Verifying column color and Amount exception alert message", "", "", "");
        fnVerifyBackGroundColor("Deal",SphereModules.BillingRequest_Amount_xp);
        objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_Amount_xp, "Amount", true);
        Thread.sleep(6000);
        fnClickExceptionVerifyPopUp();
		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}
		
        	
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }
}

	 public  void fnVerifyAmountDealnotexistexception() 
		{

		 try {
			 
		
		obj.repAddData( "Verifying  Billing Request Amount,Deal not exist alert message verification", "", "", "");
		
		obj.repAddData( "File upload to shared drive is a prerequisite", "", "", "");
		
	   
	    String sDealNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
	    //String sDealNumberRandom="677900";
	    String sDeptSyssNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	    
	    String targetFileName=fnnewArchiveFile("C:\\Merged_Automation_Workspace\\SphereAutomation\\TestData\\","CHSLGRIP_DC - DealAmountException.TXT");
	    System.out.println(targetFileName);
	    
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",sDealNumberRandom);
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	   
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);

	    //String DealNumberDB="678741";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(SphereModules.BillingRequest_Table_xp));
			
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(SphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, sDealNumberRandom , "Search Box");
		Thread.sleep(6000);
    
		obj.repAddData( "Verifying column color and Deal not exist alert message", "", "", "");
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			
		fnVerifyBackGroundColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DealNumber_xp, "Deal Number", true);
        Thread.sleep(6000);
        fnClickExceptionVerifyPopUp();
     
        obj.repAddData( "Verifying column color and Amount exception alert message", "", "", "");
        fnVerifyBackGroundColor("Deal",SphereModules.BillingRequest_Amount_xp);
        objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_Amount_xp, "Amount", true);
        Thread.sleep(6000);
        fnClickExceptionVerifyPopUp();
		
		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}
		
     	
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }
}

	 
	 public  void fnClickExceptionVerifyPopUp() 
		{

		 try {
			 
			    
		        objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.BillingRequest_PopupMessage_msg, SphereModules.BillingRequest_PopupMessage_xp);
		        Thread.sleep(6000);

		        objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_PopupMessage_OK_xp, "OK button", true);
		        Thread.sleep(6000);				
				
				
				if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
				{
					obj.repAddData( "Verifying exception record is exists after clicking alert message ", " exception record should exist after clicking alert message"," Exception record exists after after clicking alert message ", "Pass");
				}else
				{
					obj.repAddData( "Verifying exception record is exists after clicking alert message ", " exception record should exist after clicking alert message"," Exception record not exists after after clicking alert message ", "Fail");
				}
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }
}

	 public  String fnCreateandCloseDeal()throws Exception 
		{
        String DealNumber="";
		try {
		
	    obj.repAddData( "Create deal and closing the deal", "", "", "");
	    
	    String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    DealNumber=mTableDataDB1.get(1).get(1).toString().trim();
	    //String DealNumberDB="672763";
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumber , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
			    
	   
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

            return DealNumber;
		}

	 
	 public void fnVerifyDealnotopenCostobjectexception()throws Exception 
		{

		try {
		
	    obj.repAddData( "Create deal and closing the deal", "", "", "");

	    obj.repAddData( "Creating  deal is prerequisite", "", "", "");
	   	    
	   String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	   
	   // String DealNumberDB="684259";
	    
	    fnClickMainMenuElement("Deals");
		WebDriverWait wait = new WebDriverWait(TestDriver.driver, 80);
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
			    
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    
	    String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
	    //String sDeptSyssNumberRandom = String.valueOf(fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	    
	    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_DC - DealNotOpenCostObject.TXT");
	    System.out.println(targetFileName);
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",DealNumberDB);
	    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
	    Thread.sleep(7000);
	   // String DealNumberDB="672441";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(objSphereModules.BillingRequest_Table_xp));
			
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(objSphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
		
		fnVerifyBackGroundColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DealNumber_xp, "Deal Number", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusOpen_xp, "Deal Open Status", true);	
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Billing Request Row", true);
		//Thread.sleep(6000);
		
		fnVerifyResolvedColor("Deal",SphereModules.BillingRequest_DealNumber_xp);
		
		/*obj.repAddData( "order status update to open", "", "", "");
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_OrderNumber_xp, "Order Number", true);
		Thread.sleep(6000);
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		
		obj.repAddData( "Verifying the order column color after the order status is updated ", "", "", "");
		
		fnVerifyResolvedColor("Order",objSphereModules.BillingRequest_OrderNumber_xp);*/
								
        obj.repAddData( "Verifying cost object invalid  text on Billing Request Slide out ", "", "", "");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Dept Sys Number", true);
		Thread.sleep(6000);
		fnVerifyExceptionTextOnSlideOut("Cost Object","Billing Request Slide out",SphereModules.BillingRequest_CostObjectInvalid_Text_xp,"Cost Object Invalid");
					
		
		String validCostObject="000004800004";
		objGenericFunctionLibrary.SendKeyById(objSphereModules.Transaction_costObject_id, validCostObject , "Cost Object");
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_BtnSave_xp, "Save", true);
		Thread.sleep(6000);
		
		Thread.sleep(6000);
				
		obj.repAddData( "Verifying cost object Exception resolved color ", "", "", "");
		fnVerifyResolvedColor("Cost Object",objSphereModules.BillingRequest_CostObject_xp);
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is displayed on exception screen", "Exception records validation failed", "Fail");

		}else
		{
			obj.repAddData( "Verify exception records on exception screen", "Exception record is not displayed on exception screen", "Exception records validation successful", "Pass");
		}

		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}



		} catch (Exception e) {
			System.out.println("ERROR: unable to read file " );
			e.printStackTrace();  
		}


		}

	 
	 public  void fnVerifyDETDealTaxexception()throws Exception 
	 {

		 try {

	    obj.repAddData( "Creating  deal is prerequisite", "", "", "");
	   
	    
	    String sDealTitleUI = fnAddDealAccount(18,TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    //String DealNumberDB="673110";
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		
	    obj.repAddData( "Reading text file and replacing the deal number", "", "", "");
	    
	    String sDeptSyssNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1000001, 9999999));
	    System.out.println(sDeptSyssNumberRandom);
	    
	    String targetFileName=fnnewArchiveFile("C:\\Merged_Automation_Workspace\\SphereAutomation\\TestData\\","CHSLGRIP_DC - TaxValidation.TXT");
	    System.out.println(targetFileName);
	    
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"Deal",DealNumberDB);
	    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
	    
	    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);

	   // String DealNumberDB="672441";
	    fnClickSubMenuElement("Billing","Exceptions");
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.BillingRequest_Table_xp)));
		Thread.sleep(4000);
		WebElement arrTBodies =TestDriver.driver.findElement(By.xpath(objSphereModules.BillingRequest_Table_xp));
			
		List<WebElement> arrRows = arrTBodies.findElements(By.xpath(objSphereModules.BillingRequest_Table_xp));
		
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		Thread.sleep(6000);
		
		if(TestDriver.driver.findElements(By.xpath(SphereModules.Transaction_Accordian_Table_DealMngCol_xp)).size()>0==true)

		{

			objGenericFunctionLibrary.ClickByXpath(SphereModules.BillingRequest_DeptSysNumber_xp, "Billing Request Row", true);
			Thread.sleep(6000);


		}
		else
		{
			obj.repAddData( "Verify exception records on exception screen", "Expected exception record should be displayed on exception screen", "Exception record is not displayed", "Fail");
		}

		 } catch (Exception e) {
			 System.out.println("ERROR: unable to read file " );
			 e.printStackTrace();  
		 }


	 }
	 

	 @SuppressWarnings("static-access")
	 public String fnAddIntegrationSLPropertyDealAccountDeptSystems(int iCostCenter, String sCostCenterNumber) throws Exception
	 {
		 String sDealTitleUI ="";

		 try
		 {

			 String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
			 String sPoNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
			 String sCreditRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
			 sDealTitleUI = "AUTOTESTDEAL"+sRandom;
			 /*if(sCostCenterUI.equalsIgnoreCase("Office Services"))
				{
					sDealTitleUI = "AUTOTESTDEALOFFICESERVICES50OFFICESERVICES50_"+sRandom;
				}*/
			 //sDealTitleUI = "Deal update validation";
			 Date date = new Date();
			 String sDuplicateDate= new SimpleDateFormat("MMddyyyy").format(date);
			 if(TestDriver.iTC_ID==15151)
			 {
				 sDealTitleUI = "DuplicateDeal_"+sDuplicateDate;
			 }
			 String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			 if(TestDriver.iTC_ID==15152)
			 {
				 sDealTitleUI = sCustomerUI;
			 }

			 String sSalesForceID=sRandom;
			 String sCreditLimitUI=sRandom+".00";


			 String sFirstName="AutoTestFirstName"+sRandom;
			 String sLastName="AutoTestLastName"+sRandom;
			 String sContactTitleUI="AutoTitle"+sRandom;
			 String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";

			 //String sDealMakerUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("DealMaker").trim();
			 String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
			 String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
			 String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
			 String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
			 String sCreditApproverUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Credit_Approver").trim();
			 String sCostCenterCodeUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("CostCenter_Code").trim();
			 //String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
			 String [] arrCostCenter =TestDriver. mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim().split(":");
			 sCostCenterNumber = arrCostCenter[0].toString().trim();
			 String sCostCenterName = arrCostCenter[1].toString().trim();
			 String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat

			 Date dexpiredday = DateUtils.addDays(new Date(), +5);
			 SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			 String sEndDateUI2 = sdf.format(dexpiredday);

			 fnClickMainMenuElement("Deals");
			 WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			 waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp)));


			 objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			 objGenericFunctionLibrary.fnLoadingPageWait();

			 objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);

			 //objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboDealMaker_id,sDealMakerUI);
			 //objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_ComboCostCenter_xp,sCostCenterUI);
			 fnSelectCostCenter(iCostCenter,sCostCenterName);

			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			 Thread.sleep(2000);
			 //objGenericFunctionLibrary.ToClickOnEnter(SphereModules.Deals_AddDeal_SearchCustomers_xp, sCustomerUI); 
			 objGenericFunctionLibrary.fnLoadingPageWait();

			 objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);

			 objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			 /*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);

				//////////////////////////
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();

				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();

				//String sCountryUI = "United States of America (USA)";
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);

				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");

				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");

				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
				objGenericFunctionLibrary.fnLoadingPageWait();

				/////////////////////////////
			  */

			 objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			 objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			 //objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, sPoNumberUI, "PO Number");
			 objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, sPoNumberRandom, "PO Number");

			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);

			 //objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);


			 //objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
			 //objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");

			 /*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
				Thread.sleep(10000);*/

			 objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "Test Title Name", "Title");
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "7344621245", "Phone Number");
			 //Fax Number depreciated
			 //objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
			 ///objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			 ///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			 objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealCheckboxInsuranceCertified_id, "Insurance Certified", true);

			 objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"11/23/2018","Insurance Expiration");
			 objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			 /*if(sCostCenterName.equalsIgnoreCase("Office Services"))
				{
					objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxNo_id, "Tax", true);	
				}else{
					objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
				}*/

			 objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			 ///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			 objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			 objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);


			 objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			 objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			 ///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");

			 //objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			 //objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio, "Studio", true);//Removed from Deal page
			 //objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboCreditApprover_id,sCreditApproverUI);
			 //objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");

			 //if(TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_ComboCustomerCode_id)).isDisplayed())
			 if(TestDriver.driver.findElements(By.id(SphereModules.Deals_AddDeal_ComboCustomerCode_id)).size()>0)
			 {
				 objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCustomerCode_id,"CENTL");
			 }

			 ////For non-permanent customers////

			 if(TestDriver.driver.findElements(By.id(SphereModules.Deal_Departmentcredit_id)).size()>0)
			 {
				 //click Deals_AddDeal_CheckboxDepartmentCrdeit_id
				 objGenericFunctionLibrary.ClickById(SphereModules.Deal_Departmentcredit_id, "Department Credit", true);
				 objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboCreditApprover_id,sCreditApproverUI);
				 objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditRandom, "Credit Number");
			 }

			 ////

			 objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			 objGenericFunctionLibrary.fnLoadingPageWait();


			 String sQuery = objSQLConfig.sDeals_RegAddDeal_Query;
			 sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			 TestDriver.conn = objDBUtility.fnOpenDBConnection();
			 TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			 HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			 HashMap<Integer, HashMap<Integer, String>> createHashmp =  mTableDataDB;
			 objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			 String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			 String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			 String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			 String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();

			 String sMainAddressLine1DB = mTableDataDB.get(1).get(5).toString().trim();
			 String sMainAddressLine2DB = mTableDataDB.get(1).get(6).toString().trim();
			 //String sMainAddressLine3DB=mTableDataDB.get(1).get(7).toString().trim();
			 String sMainCityDB=	mTableDataDB.get(1).get(8).toString().trim();
			 String sMainZipcodeDB=	mTableDataDB.get(1).get(9).toString().trim();
			 String sCountryDB = mTableDataDB.get(1).get(10).toString().trim();
			 String sStateDB=mTableDataDB.get(1).get(11).toString().trim();
			 //String srevenueDB=mTableDataDB.get(1).get(12).toString().trim();
			 //String slot=mTableDataDB.get(1).get(13).toString().trim();
			 //String scostplusDB=mTableDataDB.get(1).get(14).toString().trim();
			 String sInsuranceDB=mTableDataDB.get(1).get(15).toString().trim();
			 String sInuranceExpiration=mTableDataDB.get(1).get(16).toString().trim();
			 String sIsTaxDB=mTableDataDB.get(1).get(17).toString().trim();
			 String sPoNumberDB=mTableDataDB.get(1).get(18).toString().trim();
			 //String sSalesForceProjectDB=mTableDataDB.get(1).get(19).toString().trim();
			 String sCreditApprovedDB=mTableDataDB.get(1).get(20).toString().trim();
			 String sDealStatusDB=mTableDataDB.get(1).get(21).toString().trim();
			 String sinvoiceformatCodeidDB=mTableDataDB.get(1).get(22).toString().trim();
			 String scredit_limitDB=mTableDataDB.get(1).get(23).toString().trim();
			 String is_credit_approvedDB=mTableDataDB.get(1).get(24).toString().trim();
			 String is_credit_permanentDB=mTableDataDB.get(1).get(25).toString().trim();
			 String credit_expirationDB=mTableDataDB.get(1).get(26).toString().trim();
			 String is_Department_CreditDB=mTableDataDB.get(1).get(27).toString().trim();
			 String Department_credit_limitDB=mTableDataDB.get(1).get(28).toString().trim();

			 String PhoneNumberDB=mTableDataDB.get(1).get(29).toString().trim();	
			 String sCustomerNumberDB=mTableDataDB.get(1).get(30).toString().trim();
			 String sCustomerisActiveDB=mTableDataDB.get(1).get(31).toString().trim();
			 String sCustomerTypeDB=mTableDataDB.get(1).get(32).toString().trim();

			 /*select if(deal.has_department_credit = 1, 'APPROVED', if(credit_approved_code_id is not null, 'APPROVED', 'UNAPPROVED')) as credit_approved, 
				if(deal.has_department_credit = 1, customer.credit_expiration, if(credit_approved_code_id is not null, '2069-12-31', null)) as credit_expiration, 
				deal.* from deal inner join customer on deal.customer_id = customer.customer_id;*/
			 //if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
			 if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&
					 sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
					 sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			 {	
				 if(sCustomerisActiveDB.contains("1"))
				 {
					 sCustomerisActiveDB = "ACTIVE";
				 }
				 else if (sCustomerisActiveDB.contains("0"))
				 {
					 sCustomerisActiveDB = "INACTIVE";
				 }
				 if(sInsuranceDB.contains("1"))
				 {
					 sInsuranceDB = "True";
				 }
				 else if(sInsuranceDB.contains("0"))
				 {
					 sInsuranceDB = "False";
				 }
				 if(is_credit_approvedDB.contains("1"))
				 {
					 is_credit_approvedDB = "APPROVED";
				 }
				 else if(is_credit_approvedDB.contains("0"))
				 {
					 is_credit_approvedDB = "NOT APPROVED";
				 }

				 if(sIsTaxDB.contains("1"))
				 {
					 sIsTaxDB = "True";
				 }
				 else if(sIsTaxDB.contains("0"))
				 {
					 sIsTaxDB = "False";
				 }

				 if(sDealStatusDB.contains("Open Deal"))
				 {
					 sDealStatusDB = "OPEN";
				 }
				 else if(sDealStatusDB.contains("Closed Deal"))
				 {
					 sDealStatusDB = "CLOSED";
				 }
				 if(sStateDB.contains("CALIFORNIA"))
				 {
					 sStateDB = "CA";
				 }
				 else if(sStateDB.contains("ILLINOIS")){
					 sStateDB = "IL";
				 }
				 else if(sStateDB.contains("GEORGIA")){
					 sStateDB = "GA";
				 }
				 else if(sStateDB.contains("NEW MEXICO")){
					 sStateDB = "NM";
				 }
				 if(sCountryDB.contains("UNITED STATES"))
				 {
					 sCountryDB = "USA";
				 }
				 if(is_Department_CreditDB.contains("1"))
				 {
					 is_Department_CreditDB = "APPROVED";
				 }
				 else if(is_Department_CreditDB.contains("0"))
				 {
					 is_Department_CreditDB = "NOT APPROVED";
				 }
				 if(is_credit_approvedDB.contains("NOT APPROVED")&&
						 is_credit_permanentDB.contains("0")&&
						 scredit_limitDB.contains(""))
				 {
					 credit_expirationDB = "12/31/2069";
				 }
				 String UseCustomer="True";
				 String OfficeLocation=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("OfficeLocation").trim();
				 String BillingCycle="WEEKLY";
				 String Type="N";
				 String CostObject="B"+"-"+sDealNumberDB;
				 String Account="17090005";
				 String UPayType="UNIV INVOICE";
				 String ParentNumber=sCustomerNumberDB;
				 String TaxType="TX";
				 String PaymentType="";
				 String Contact="";
				 //TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal");
				 String sDeptSystemsStatus = BusinessFunctionLibrary.fnVerifyDeptSystems(sDealTitleUI);
				 //TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,,,,"+sDeptSystemsStatus);
				 //TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,"+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sCountryDB+","+sMainZipcodeDB+","+is_credit_permanentDB+","+credit_expirationDB+","+scredit_limitDB+","+sPoNumberDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+",,"+sDeptSystemsStatus+","+sCostCenterUI+","+sDealTypeDB+","+Department_credit_limitDB);
				 //bw2.write("Test Case Id,Test Case Name,CustomerNumber,Name,ManagingDept,CustomerStatus,Type,CustomerAddress1,CustomerAddress2,CustomerCity,CustomerState,CustomerZip,CustomerCountry,CustomerPhoneNo,CreditStatus,Through,Amount,Certification,ValidThrough,TaxStatus,DealNumber,Dealname,Dealtype,Address1,Address2,Status,City,State,Zip,Country,MainPhone,Status,CreditThrough,Certification,ValidThrough,TaxStatus,Department,PoNumber");

				 //below code old for department credit approved
				 //TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNumberDB+","+sCustomerNameDB+","+sCostCenterName+","+sCostCenterCodeUI+","+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_Department_CreditDB+","+credit_expirationDB+","+Department_credit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sCostCenterName+","+sCostCenterCodeUI+","+sPoNumberDB);

				 //below report is for studio credit approved customer
				 //TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNumberDB+","+sCustomerNameDB+","+sCostCenterName+","+sCostCenterCodeUI+","+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+",,,"+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sCostCenterName+","+sCostCenterCodeUI+","+sPoNumberDB);
				 if(sCostCenterName.equalsIgnoreCase("Property")|| sCostCenterName.equalsIgnoreCase("Costume"))

				 {
					 TestDriver.bw2.append("\n"+sCustomerNumberDB+","+sCustomerNameDB+",,"+sCostCenterCodeUI+",,"+sCustomerisActiveDB+",,"+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+",,,,,,,,"+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+",,,,"+sDealNumberDB+",\'"+sDealTitleDB+","+ParentNumber+",,"+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+",,,"+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+",,"+TaxType+","+sCostCenterName+","+sCostCenterCodeUI+","+sPoNumberDB+",,,,,"+PaymentType+","+Contact);
				 }else if(sCostCenterName.equalsIgnoreCase("Editorial Facilities"))
				 {
					 BillingCycle="MONTHLY";			
					 TestDriver.bw2.append("\n"+sCustomerNumberDB+","+sCustomerNameDB+",,,,"+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+UseCustomer+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+",,,"+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+",,,"+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+BillingCycle+","+UPayType+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+",,"+sCostCenterName+",,"+sPoNumberDB+","+Type+","+Account+",,"+UPayType+",,,");
				 }else if(sCostCenterName.equalsIgnoreCase("Sound Services"))
				 {
					 //BillingCycle="MONTHLY";			
					 TestDriver.bw2.append("\n"+sCustomerNumberDB+","+sCustomerNameDB+",,,,"+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+",,,,,,,,,,,,,,"+sDealNumberDB+",\'"+sDealTitleDB+",,,"+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+",,,,,,"+sInsuranceDB+","+sInuranceExpiration+",,,"+sCostCenterName+",,"+sPoNumberDB+",,,,,,,");
				 }else if(sCostCenterName.equalsIgnoreCase("Transportation"))
				 {
					 //BillingCycle="MONTHLY";			
					 TestDriver.bw2.append("\n"+sCustomerNumberDB+","+sCustomerNameDB+",,,,"+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+",,,,,,,,"+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+",,,"+sDealNumberDB+",\'"+sDealTitleDB+",,,"+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+",,,"+is_credit_approvedDB+",,,"+sInsuranceDB+","+sInuranceExpiration+",,,"+sCostCenterName+",,"+sPoNumberDB+",,,,,,,");
				 }			

				 else if(sCostCenterName.equalsIgnoreCase("OFFICE SERVICES"))
				 {
					 BillingCycle="MONTHLY";

					 TestDriver.bw2.append("\n"+sCustomerNumberDB+","+sCustomerNameDB+",,"+sCostCenterCodeUI+",,"+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+UseCustomer+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+",,,"+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+",,"+OfficeLocation+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+BillingCycle+","+UPayType+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+",,"+sCostCenterName+","+sCostCenterCodeUI+","+sPoNumberDB+","+Type+","+Account+",,"+UPayType+","+PaymentType+","+Contact);
				 }	
				 else
				 {
					 TestDriver.bw2.append("\n"+sCustomerNumberDB+","+sCustomerNameDB+",,"+sCostCenterCodeUI+",,"+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+UseCustomer+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+",,,"+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+",,"+OfficeLocation+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+BillingCycle+","+UPayType+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+",,"+sCostCenterName+","+sCostCenterCodeUI+","+sPoNumberDB+","+Type+","+Account+","+CostObject+","+UPayType+",,,");
				 }
				 obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");

			 }
			 else
			 {
				 obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			 }

				
			} catch (Exception e) {
		   System.out.println("fnAddIntegrationDealAccountWithDepartmentCreditDeptSystems --------------Failed");    
		   obj.repAddData( "Verify Deal", "New deal should be created", "New deal not created", "Fail");
		   TestDriver.log.error("fnAddIntegrationDealAccountWithDepartmentCreditDeptSystems failed",e);
		   }
			
			return sDealTitleUI;
			
			
		}

	 @SuppressWarnings("static-access")
		public String fnAddIntegrationDealAccountWithDepartmentCredit(int iCostCenter, String sCostCenterUI) throws Exception
		{
			String sDealTitleUI ="";
			
			try
			{
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
				String sCreditRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
				sDealTitleUI = "AUTOTESTDEAL"+sRandom;
				if(sCostCenterUI.equalsIgnoreCase("Office Services"))
				{
					sDealTitleUI = "AUTOTESTDEALOFFICESERVICES50OFFICESERVICES50_"+sRandom;
				}
				//sDealTitleUI = "Deal update validation";
				Date date = new Date();
			    String sDuplicateDate= new SimpleDateFormat("MMddyyyy").format(date);
				if(TestDriver.iTC_ID==15151)
				{
					sDealTitleUI = "DuplicateDeal_"+sDuplicateDate;
				}
				String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
				if(TestDriver.iTC_ID==15152)
				{
					sDealTitleUI = sCustomerUI;
				}
				
				String sPoNumberUI = "AutoPONumber_"+sRandom;
				//String sAddr1UI = "AutoAddr1_"+sRandom;
				//String sAddr2UI = "AutoAddr2_"+sRandom;
				//String sAddr3UI = "AutoAddr3_"+sRandom;
				String sSalesForceID=sRandom;
				String sCreditLimitUI=sRandom+".00";
				//String sProjectName="BATES MOTEL";
				//String sProjectNameUI="AutoTestProject_"+sRandom;
				//String sProjectClusterUI="AutoTestProjectCluster_"+sRandom;
				//String sCustomerUI="custdeal";
				
				String sFirstName="AutoTestFirstName"+sRandom;
				String sLastName="AutoTestLastName"+sRandom;
				String sContactTitleUI="AutoTitle"+sRandom;
				String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
				//String sCityUI = "AutoCity_"+sRandom;
				//String sStateUI = "CA";
				//String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				//String sZipUI = sRandom;
				//String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				//String sCountryUI = "United States of America (USA)";
				//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
				//String sDealMakerUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("DealMaker").trim();
				String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
			    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
			    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
			    String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
			    String sCreditApproverUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Credit_Approver").trim();
			    
				//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
				
			   String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
				
				Date dexpiredday = DateUtils.addDays(new Date(), +5);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
				String sEndDateUI2 = sdf.format(dexpiredday);
				
				
				//objBusinessLib.fnClickMainMenuElement("Administration");
				fnClickMainMenuElement("Deals");
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
				objGenericFunctionLibrary.fnLoadingPageWait();
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp)));
				 

				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
				
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboDealMaker_id,sDealMakerUI);
				//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_ComboCostCenter_xp,sCostCenterUI);
				fnSelectCostCenter(iCostCenter,sCostCenterUI);
				//No need to select below check-box as Multi-Department would be automatically selected
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxMultipleDepartment_id, "Multiple Department", true);
				
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
				Thread.sleep(2000);
				//objGenericFunctionLibrary.ToClickOnEnter(SphereModules.Deals_AddDeal_SearchCustomers_xp, sCustomerUI); 
				objGenericFunctionLibrary.fnLoadingPageWait();
				//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp,sCustomerUI);
				//Thread.sleep(4000);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxMultipleDepartment_id, "Multiple Department", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxInternal_id, "Internal", true);	
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddCustomer_xp, "Add New Customer", true);
				
				
				//String sCustomer="";
				//sCustomer=fnAddCustomer(sCustomer, "Add");
				//System.out.println(sCustomer);
				
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
				/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
				
				//////////////////////////
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				
				//String sCountryUI = "United States of America (USA)";
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				/////////////////////////////
				*/
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
					
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
				
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, sPoNumberUI, "PO Number");
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
				
				
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
				
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
				
				
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
				
				/*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
				Thread.sleep(10000);*/
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "Test Title Name", "Title");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "7344621245", "Phone Number");
				//Fax Number depreciated
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
				///objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealCheckboxInsuranceCertified_id, "Insurance Certified", true);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"04/23/2018","Insurance Expiration");
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
				
			
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
				///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
				
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio, "Studio", true);//Removed from Deal page
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboCreditApprover_id,sCreditApproverUI);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
				
				//if(TestDriver.driver.findElement(By.id(SphereModules.Deals_AddDeal_ComboCustomerCode_id)).isDisplayed())
				if(TestDriver.driver.findElements(By.id(SphereModules.Deals_AddDeal_ComboCustomerCode_id)).size()>0)
				{
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboCustomerCode_id,"CENTL");
				}
				
				////For non-permanent customers////
				
				if(TestDriver.driver.findElements(By.id(SphereModules.Deal_Departmentcredit_id)).size()>0)
				{
					//click Deals_AddDeal_CheckboxDepartmentCrdeit_id
					objGenericFunctionLibrary.ClickById(SphereModules.Deal_Departmentcredit_id, "Department Credit", true);
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboCreditApprover_id,sCreditApproverUI);
					objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditRandom, "Credit Number");
				}
				
				
				////
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
			   /* try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
	   
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					
					if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
					}
					else
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					}
					
					//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					//obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					e.printStackTrace();
				}*/
		        						
			    String sQuery = objSQLConfig.sDeals_RegAddDeal_Query;
			    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				HashMap<Integer, HashMap<Integer, String>> createHashmp =  mTableDataDB;
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
				String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
				String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
				String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
			    
				String sMainAddressLine1DB = mTableDataDB.get(1).get(5).toString().trim();
				String sMainAddressLine2DB = mTableDataDB.get(1).get(6).toString().trim();
				//String sMainAddressLine3DB=mTableDataDB.get(1).get(7).toString().trim();
				String sMainCityDB=	mTableDataDB.get(1).get(8).toString().trim();
				String sMainZipcodeDB=	mTableDataDB.get(1).get(9).toString().trim();
				String sCountryDB = mTableDataDB.get(1).get(10).toString().trim();
				String sStateDB=mTableDataDB.get(1).get(11).toString().trim();
				//String srevenueDB=mTableDataDB.get(1).get(12).toString().trim();
				//String slot=mTableDataDB.get(1).get(13).toString().trim();
				//String scostplusDB=mTableDataDB.get(1).get(14).toString().trim();
				String sInsuranceDB=mTableDataDB.get(1).get(15).toString().trim();
				String sInuranceExpiration=mTableDataDB.get(1).get(16).toString().trim();
				String sIsTaxDB=mTableDataDB.get(1).get(17).toString().trim();
				String sPoNumberDB=mTableDataDB.get(1).get(18).toString().trim();
				//String sSalesForceProjectDB=mTableDataDB.get(1).get(19).toString().trim();
				String sCreditApprovedDB=mTableDataDB.get(1).get(20).toString().trim();
				String sDealStatusDB=mTableDataDB.get(1).get(21).toString().trim();
				String sinvoiceformatCodeidDB=mTableDataDB.get(1).get(22).toString().trim();
				String scredit_limitDB=mTableDataDB.get(1).get(23).toString().trim();
				String is_credit_approvedDB=mTableDataDB.get(1).get(24).toString().trim();
				String is_credit_permanentDB=mTableDataDB.get(1).get(25).toString().trim();
				String credit_expirationDB=mTableDataDB.get(1).get(26).toString().trim();
				String is_Department_CreditDB=mTableDataDB.get(1).get(27).toString().trim();
				String Department_credit_limitDB=mTableDataDB.get(1).get(28).toString().trim();
				
				String PhoneNumberDB=mTableDataDB.get(1).get(29).toString().trim();	
				String sCustomerNumberDB=mTableDataDB.get(1).get(30).toString().trim();
				String sCustomerisActiveDB=mTableDataDB.get(1).get(31).toString().trim();
				String sCustomerTypeDB=mTableDataDB.get(1).get(32).toString().trim();
				
				/*select if(deal.has_department_credit = 1, 'APPROVED', if(credit_approved_code_id is not null, 'APPROVED', 'UNAPPROVED')) as credit_approved, 
				if(deal.has_department_credit = 1, customer.credit_expiration, if(credit_approved_code_id is not null, '2069-12-31', null)) as credit_expiration, 
				deal.* from deal inner join customer on deal.customer_id = customer.customer_id;*/
				
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
				{	
									
					
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal");
					String sDeptSystemsStatus = BusinessFunctionLibrary.fnVerifyDeptSystems(sDealTitleUI);
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,,,,"+sDeptSystemsStatus);
					TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,"+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sCountryDB+","+sMainZipcodeDB+","+is_credit_permanentDB+","+credit_expirationDB+","+scredit_limitDB+","+sPoNumberDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+",,"+sDeptSystemsStatus+","+sCostCenterUI+","+sDealTypeDB+","+Department_credit_limitDB);
					//bw2.write("Test Case Id,Test Case Name,CustomerNumber,Name,ManagingDept,CustomerStatus,Type,CustomerAddress1,CustomerAddress2,CustomerCity,CustomerState,CustomerZip,CustomerCountry,CustomerPhoneNo,CreditStatus,Through,Amount,Certification,ValidThrough,TaxStatus,DealNumber,Dealname,Dealtype,Address1,Address2,Status,City,State,Zip,Country,MainPhone,Status,CreditThrough,Certification,ValidThrough,TaxStatus,Department,PoNumber");
					TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNumberDB+","+sCustomerNameDB+","+sCostCenterUI+","+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_approvedDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_permanentDB+","+credit_expirationDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sCostCenterUI+","+sPoNumberDB);
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
				
				
			} catch (Exception e) {
		   System.out.println("fnAddIntegrationDealAccountWithDepartmentCredit --------------Failed");    
		   obj.repAddData( "Verify Deal", "New deal should be created", "New deal not created", "Fail");
		   TestDriver.log.error("fnAddIntegrationDealAccountWithDepartmentCredit failed",e);
		   }
			
			return sDealTitleUI;
		
		}
		

	 
	 @SuppressWarnings("static-access")
		public String fnRegAddDealAccount(int iCostCenter, String sCostCenterUI) throws Exception
		{
			String sDealTitleUI ="";
			
			try
			{
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));
				sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
				//sDealTitleUI = "Deal update validation";
				
				String sPoNumberUI = "AutoPONumber_"+sRandom;
				//String sAddr1UI = "AutoAddr1_"+sRandom;
				//String sAddr2UI = "AutoAddr2_"+sRandom;
				//String sAddr3UI = "AutoAddr3_"+sRandom;
				String sSalesForceID=sRandom;
				//String sCreditLimitUI=sRandom+".00";
				//String sProjectName="BATES MOTEL";
				String sProjectNameUI="AutoTestProject_"+sRandom;
				String sProjectClusterUI="AutoTestProjectCluster_"+sRandom;
				//String sCustomerUI="custdeal";
				//String sCustomerUI="Test Customer creation";
				String sCustomerUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
				String sFirstName="AutoTestFirstName"+sRandom;
				String sLastName="AutoTestLastName"+sRandom;
				String sContactTitleUI="AutoTitle"+sRandom;
				String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
				//String sCityUI = "AutoCity_"+sRandom;
				//String sStateUI = "CA";
				//String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				//String sZipUI = sRandom;
				//String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				//String sCountryUI = "United States of America (USA)";
				//String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
				//String sDealMakerUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("DealMaker").trim();
				String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
			    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
			    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
			    String sProjectName=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project_Type").trim();
			   // String sCreditApproverUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Credit_Approver").trim();
			    Date date = new Date();
				//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
				
			   String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
				
				Date dexpiredday = DateUtils.addDays(new Date(), +5);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
				String sEndDateUI2 = sdf.format(dexpiredday);
				
				
				//objBusinessLib.fnClickMainMenuElement("Administration");
				fnClickMainMenuElement("Deals");
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
				objGenericFunctionLibrary.fnLoadingPageWait();
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp)));
				 

				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
				
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_ComboDealMaker_id,sDealMakerUI);
				//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_ComboCostCenter_xp,sCostCenterUI);
				fnSelectCostCenter(iCostCenter,sCostCenterUI);
				
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,"creation", "Search customer");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
				Thread.sleep(2000);
				//objGenericFunctionLibrary.ToClickOnEnter(SphereModules.Deals_AddDeal_SearchCustomers_xp, sCustomerUI); 
 				objGenericFunctionLibrary.fnLoadingPageWait();
				//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp,sCustomerUI);
				//Thread.sleep(4000);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxMultipleDepartment_id, "Multiple Department", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_CheckBoxInternal_id, "Internal", true);	
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddCustomer_xp, "Add New Customer", true);
				
				
				//String sCustomer="";
				//sCustomer=fnAddCustomer(sCustomer, "Add");
				//System.out.println(sCustomer);
				
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
				/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
				
				//////////////////////////
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				
				//String sCountryUI = "United States of America (USA)";
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				/////////////////////////////
				*/
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
					
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
				
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, sPoNumberUI, "PO Number");
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "675466", "PO Number");
				
				
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
				
				/*objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
				
				
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
				Thread.sleep(10000);*/
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "Test Title Name", "Title");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, "7344621245", "Phone Number");
				//Fax Number depreciated
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
				///objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealCheckboxInsuranceCertified_id, "Insurance Certified", true);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"10/31/2019","Insurance Expiration");
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
				
			
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
				///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);  //Removed from Deal Page
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio, "Studio", true);//Removed from Deal page
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboCreditApprover_id,sCreditApproverUI);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
			   /* try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
	   
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					
					if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
					}
					else
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					}
					
					//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					//obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					e.printStackTrace();
				}*/
		        
							
			  /*  String sQuery = objSQLConfig.sDeals_AddDeal_Query;
			    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
				String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
				String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
				String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
			    
			/*	String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
				String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
				String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
				String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
				String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
				String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
				String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
				String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
				String slot=mTableDataDB.get(1).get(12).toString().trim();
				String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
				String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
				String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
				String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
				String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
				String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
				String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
				String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();*/
				
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
				/*if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal");
					String sDeptSystemsStatus = BusinessFunctionLibrary.fnVerifyDeptSystems(sDealTitleUI);
					TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,,,,"+sDeptSystemsStatus);
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}*/
				
				String sQuery = objSQLConfig.sDeals_RegAddDeal_Query;
			    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
				String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
				String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
				String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
			    
				String sMainAddressLine1DB = mTableDataDB.get(1).get(5).toString().trim();
				String sMainAddressLine2DB = mTableDataDB.get(1).get(6).toString().trim();
				//String sMainAddressLine3DB=mTableDataDB.get(1).get(7).toString().trim();
				String sMainCityDB=	mTableDataDB.get(1).get(8).toString().trim();
				String sMainZipcodeDB=	mTableDataDB.get(1).get(9).toString().trim();
				String sCountryDB = mTableDataDB.get(1).get(10).toString().trim();
				String sStateDB=mTableDataDB.get(1).get(11).toString().trim();
				//String srevenueDB=mTableDataDB.get(1).get(12).toString().trim();
				//String slot=mTableDataDB.get(1).get(13).toString().trim();
				//String scostplusDB=mTableDataDB.get(1).get(14).toString().trim();
				String sInsuranceDB=mTableDataDB.get(1).get(15).toString().trim();
				String sInuranceExpiration=mTableDataDB.get(1).get(16).toString().trim();
				String sIsTaxDB=mTableDataDB.get(1).get(17).toString().trim();
				String sPoNumberDB=mTableDataDB.get(1).get(18).toString().trim();
				//String sSalesForceProjectDB=mTableDataDB.get(1).get(19).toString().trim();
				String sCreditApprovedDB=mTableDataDB.get(1).get(20).toString().trim();
				String sDealStatusDB=mTableDataDB.get(1).get(21).toString().trim();
				String sinvoiceformatCodeidDB=mTableDataDB.get(1).get(22).toString().trim();
				String scredit_limitDB=mTableDataDB.get(1).get(23).toString().trim();
				String is_credit_approvedDB=mTableDataDB.get(1).get(24).toString().trim();
				String is_credit_permanentDB=mTableDataDB.get(1).get(25).toString().trim();
				String credit_expirationDB=mTableDataDB.get(1).get(26).toString().trim();
				String is_Department_CreditDB=mTableDataDB.get(1).get(27).toString().trim();
				String Department_credit_limitDB=mTableDataDB.get(1).get(28).toString().trim();
				
				String PhoneNumberDB=mTableDataDB.get(1).get(29).toString().trim();	
				String sCustomerNumberDB=mTableDataDB.get(1).get(30).toString().trim();
				String sCustomerisActiveDB=mTableDataDB.get(1).get(31).toString().trim();
				String sCustomerTypeDB=mTableDataDB.get(1).get(32).toString().trim();
				
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) &&
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal");
					String sDeptSystemsStatus = BusinessFunctionLibrary.fnVerifyDeptSystems(sDealTitleUI);
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,,,,"+sDeptSystemsStatus);
					TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sDealTitleDB+",\'"+sDealNumberDB+",Create,Deal,,"+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sCountryDB+","+sMainZipcodeDB+","+is_credit_permanentDB+","+credit_expirationDB+","+scredit_limitDB+","+sPoNumberDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+",,"+sDeptSystemsStatus+","+sCostCenterUI+","+sDealTypeDB+","+Department_credit_limitDB);
					TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNumberDB+","+sCustomerNameDB+","+sCostCenterUI+","+sCustomerisActiveDB+","+sCustomerTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_permanentDB+","+credit_expirationDB+","+scredit_limitDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sDealNumberDB+",\'"+sDealTitleDB+","+sDealTypeDB+","+sMainAddressLine1DB+","+sMainAddressLine2DB+","+sDealStatusDB+","+sMainCityDB+","+sStateDB+","+sMainZipcodeDB+","+sCountryDB+","+PhoneNumberDB+","+is_credit_permanentDB+","+credit_expirationDB+","+sInsuranceDB+","+sInuranceExpiration+","+sIsTaxDB+","+sCostCenterUI+","+sPoNumberDB);
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
				
				
			} catch (Exception e) {
		   System.out.println("fnAddDealAccount --------------Failed");    
		   obj.repAddData( "Verify Deal", "New deal should be created", "New deal not created", "Fail");
		   TestDriver.log.error("fnAddDealAccount failed",e);
		   }
			
			return sDealTitleUI;
			
			
		}

	 public String fnAddCustomerwithCreditExpirationdate(String sCustomerNameUI, String sOperation) throws Exception
		{
			//sCustomerNameUI ="";
			try
			{
				HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(70001, 99999));
				String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
				if(!sOperation.equalsIgnoreCase("Duplicate"))
				{
					sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
				}
				
				String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
				String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
				
				Date dTomorrow = DateUtils.addDays(new Date(), +1);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");
				String sStartDateUI1 = sdf.format(dTomorrow);
				sdf.applyPattern("yyyy-MM-dd");
				String sStartDateUIDBpattern=sdf.format(dTomorrow);
				
				/*Date date = new Date();
				//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
				String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
				
				Date dYesterday = DateUtils.addDays(new Date(), -1);
				SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
				String sStartDateUI2 = sdf.format(dYesterday);*/
			
				
				//Date sCreditexpiredDate = DateUtils.addYears(new Date(),+3);
				Date sCreditexpiredDate = DateUtils.addDays(new Date(),+365);
				//Date sCreditexpiredDate2=DateUtils.addYears(new Date(),+3);
				Date sCreditexpiredDate2 = DateUtils.addDays(new Date(), +365);
				
				SimpleDateFormat sdf1 = new SimpleDateFormat("MM/dd/yyyy");
				
				String sCreditexpiredDateUI = sdf1.format(sCreditexpiredDate);//UI value
				String sCreditexpiredDateDBformat = sdf.format(sCreditexpiredDate2);//DB Value
				
				String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
				//String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
				//String sLegalEntityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Legal_Entity").trim();
				
				
			//	String sEmailUI = "AutoEmail_"+sRandom+"@nbcuni.com";
				/*String sAddr1UI = "AutoAddr1_"+sRandom;
				String sAddr2UI = "AutoAddr2_"+sRandom;
				String sAddr3UI = "AutoAddr3_"+sRandom;
				String sCityUI = "AutoCity_"+sRandom;
				String sZipUI = sRandom;*/
				
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				//String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				
				//String sCountryUI = "United States of America (USA)";
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				
				
			
				
				//objBusinessLib.fnClickMainMenuElement("Administration");
				fnClickSubMenuElement("Customers Master","Customers");
				objGenericFunctionLibrary.fnLoadingPageWait();
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
				Thread.sleep(4000);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
				
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
				
				
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
				/*objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
			    
				/*objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
				objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
				
				
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "06162016", "Production Start Date");
				
				
				TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
				
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sRandom+sRandom, "Phone Number");
				String sPhoneNumber = "734"+String.valueOf(objGenericFunctionLibrary.fnRandomNum(3333333, 9999999));
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sPhoneNumber, "Phone Number");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
				
				String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(200000001, 999999999))+"6";
				String sContactPhone ="7346788899";
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle", "Title");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "Automail"+sContactFax+"@nbcuni.com", "Email");
				//Below two not implemented yet
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxMainContact_xp,"Main Contact Checkbox",true);
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxRecInvoice_xp,"Receive Invoice Checkbox",true);
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				///////////////////////////////////////////////////////////////////////////////////////
				
				/////////////////Adding Customer Address Start//////////////////
				//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
				//bjGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
			    
				//Below line is temprory 
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,"ARUBA");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
				if(!sStateUI.equalsIgnoreCase(""))
				{
					objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
				}
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
				
				//Support Multiple Addresses is by default feature now
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
				/////////////////Adding Customer Address End//////////////////
				
				//Add group code here
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				
				String sCreditLimitUI=sRandom+".00";
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit"); //Code already handled .00
				//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sCreditLimitUI, "Credit Limit");
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
				//objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerNo_id, "No radio button", true);
				
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputCreditExpDate_id, "Credit Expiration Date", true);
				TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputCreditExpDate_id)).clear();
				TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputCreditExpDate_id)).sendKeys(sCreditexpiredDateUI);
				
				
				if(sOperation.equalsIgnoreCase("Cancel"))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_AddEditModules_BtnFormExitConfirmation_xp)));
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_BtnFormExitConfirmation_xp, "Confirmation Button", false);
					objGenericFunctionLibrary.fnLoadingPageWait();
				}
				else
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
									
				}
				
				//objGenericFunctionLibrary.fnLoadingPageWait();
			    
			    
			    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
			    {
			    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    	 int iRow = 1; //for add 
					    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
						TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
						if(sOperation.equalsIgnoreCase("Duplicate"))
						{
							iRow = 1; //for duplicate, now checking descending, so no need to set it to 2
						}
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
						String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
						String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
						String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
						String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
						String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
						String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
						String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
						String sCreditExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
						
						String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
						
						String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
						String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
						String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
						String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
						String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
						String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
						String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
						String sMultEmailDB = mTableDataDB.get(iRow).get(17).toString().trim();
						String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(18).toString().trim();
						
						String sCustomerStatusDB = mTableDataDB.get(iRow).get(24).toString().trim();//isactive field in DB
						String sCustomerPhoneNumberDB = mTableDataDB.get(iRow).get(25).toString().trim();
						
						if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) && 
								sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
								sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB)&&
								sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB)&&//&&sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB)
								sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
								sStartDateUIDBpattern.equalsIgnoreCase(sStartDateDB) && 
								sCreditPermanentDB.equalsIgnoreCase("0") && 
								sCreditexpiredDateDBformat.equalsIgnoreCase(sCreditExpirationDB))
						{	
							//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
							TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sCountryDB+","+sZipDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
							
							TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameDB+",,"+sCustomerStatusDB+","+sCustomerTypeDB+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
							
							obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
						
						}
						else
						{
							obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
						}
						
						//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
						if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && 
								sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
								//sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
								sCountryUI.equalsIgnoreCase(sCountryDB) && 
								sStateUI.equalsIgnoreCase(sStateDB) && 
								sCityUI.equalsIgnoreCase(sCityDB) && 
								sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
						{	
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
						}
						else
						{
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
						}
			    }
			    else if(sOperation.equalsIgnoreCase("Cancel"))
			    {
			    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
				    
				    TestDriver.conn = objDBUtility.fnOpenDBConnection();
				    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					int iTotalRows = 0;
					while(TestDriver.rset.next())
					{
						iTotalRows = iTotalRows+1;
					}
					
					System.out.println(String.valueOf(iTotalRows));
					if(iTotalRows==1)
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
					}
					else
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
					}
			    }
			   
			    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			
			} catch (Exception e) {
		   System.out.println("fnAddCustomerwithCreditExpirationdate --------------Failed");    
		   TestDriver.log.error("fnAddCustomerwithCreditExpirationdate failed",e);
		   }
			
			return sCustomerNameUI;
			
		}

	 public String fnRegAddCustomerMultiAddressesContacts(String sCustomerNameUI, String sOperation, boolean bMultiContact, int iContactCount, boolean bMultiAddress, int iAddressCount) throws Exception
		{
			//sCustomerNameUI ="";
			try
			{
				
				HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				HashMap<Integer, HashMap<Integer, String>> mAltAddressDataUI = new HashMap<Integer,HashMap<Integer, String>>();
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(70001, 99999));
				String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
				if(!sOperation.equalsIgnoreCase("Duplicate"))
				{
					sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
				}
				
				String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
				String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
				
				Date date = new Date();
				//String sStartDateUI1= new SimpleDateFormat("MMddyyyy").format(date);
				String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
				
				Date dYesterday = DateUtils.addDays(new Date(), -1);
				SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
				String sStartDateUI2 = sdf.format(dYesterday);
				
				//String sStartDateUI2= new SimpleDateFormat("yyyy-MM-dd").format(date);
				
				String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
				//String sCollectorUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Collector").trim();
				//String sLegalEntityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Legal_Entity").trim();
				
				
				
			//	String sEmailUI = "AutoEmail_"+sRandom+"@nbcuni.com";
				/*String sAddr1UI = "AutoAddr1_"+sRandom;
				String sAddr2UI = "AutoAddr2_"+sRandom;
				String sAddr3UI = "AutoAddr3_"+sRandom;
				String sCityUI = "AutoCity_"+sRandom;
				String sZipUI = sRandom;*/
				
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				
				//String sCountryUI = "United States of America (USA)";
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
						
				
				//objBusinessLib.fnClickMainMenuElement("Administration");
				fnClickSubMenuElement("Customers Master","Customers");
				objGenericFunctionLibrary.fnLoadingPageWait();
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
				Thread.sleep(4000);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
				
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
				
				
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
				/*objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
			    
				/*objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboCollector_id,sCollectorUI);
				objGenericFunctionLibrary.fnSelectFromJSComboBox(SphereModules.CustomersMaster_AddCustomer_ComboLegalEntity_id,sLegalEntityUI);*/
				
				
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "06162016", "Production Start Date");
				
				
				TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
				
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sRandom+sRandom, "Phone Number");
				
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sRandom+sRandom, "Phone Number");
				String sPhoneNumber = "734"+String.valueOf(objGenericFunctionLibrary.fnRandomNum(3333333, 9999999));
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, sPhoneNumber, "Phone Number");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
				
				/////////////////Adding Customer Address Start//////////////////
				//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, sEmailUI, "Email");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
			    
				//Below line is temporary 
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,"ARUBA");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
				//Support Multiple Addresses is by default feature now
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
				
				if(bMultiContact==true)
				{
					//HashMap<Integer, HashMap<Integer, String>> mContactDataUI = new HashMap<Integer,HashMap<Integer, String>>();
					for(int i=1;i<=iContactCount;i++)
					{
						String sContactPhone = "734"+String.valueOf(objGenericFunctionLibrary.fnRandomNum(3333333, 9999999));
						String sContactFax = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
						
						objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddPlusLink_xp,"Add Contact Link",true);
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFirstName_xp, "AutoContactFirstName_"+sRandom, "First Name");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputLastName_xp, "AutoContactLastName_"+sRandom, "Last Name");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputTitle_xp, "AutoTitle_"+i, "Title");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputPhone_xp, sContactPhone, "Phone");
						//Fax number depreciated
						//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputFax_xp, sContactFax, "Fax");
						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddContact_InputEmail_xp, "AutoEmail"+sContactFax+"@nbcuni.com", "Email");
						
						//Below two not implemented yet
						//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxMainContact_xp,"Main Contact Checkbox",true);
						//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_CheckboxRecInvoice_xp,"Receive Invoice Checkbox",true);
						
						objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddContact_BtnAdd_xp,"Add Contact Button",true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						///////////////////////////////////////////////////////////////////////////////////////

						mContactDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
						mContactDataUI.get(i).put(1,"AutoContactFirstName_"+sRandom);
						mContactDataUI.get(i).put(2,"AutoContactLastName_"+sRandom);
						mContactDataUI.get(i).put(3,"AutoTitle_"+i);
						mContactDataUI.get(i).put(4,sContactPhone);
						//Fax Number depreciated
						//mContactDataUI.get(i).put(5,sContactFax);
						mContactDataUI.get(i).put(5,"AutoEmail"+sContactFax+"@nbcuni.com");
						
						////////////////////////////////////////////////////////////////////////////////////////
						
						
					}
					
				}
				
				String sAltAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress1").trim();
				String sAltAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress2").trim();
				String sAltAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltAddress3").trim();
				String sAltCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCity").trim();
				String sAltZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltZip").trim();
				
				String sAltStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltState").trim();
				//String sCountryUI = "United States of America (USA)";
				String sAltCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("AltCountry").trim();
				
				if(bMultiAddress==true)
				{		
					for(int i=1;i<=iAddressCount;i++)
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
						
						objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_ButtonAddDesc_xp,"Add Desc Button",true);
						objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrDesc_id, "AutoAltAddrDesc_"+i, "Alternate Address Description");
						
						//Below two not implemented yet
						//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo1_id, "AutoAltAddnlInfo1_"+i, "Alternate Additional Info 1");
						//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddnlInfo2_id, "AutoAltAddnlInfo2_"+i, "Alternate Additional Info 2");
						
						objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAltAddr1UI, "Alternate Address Line 1");
						objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAltAddr2UI+" "+i+"00", "Alternate Address Line 2");
						objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAltAddr3UI+" "+i+"00", "Alternate Address Line 3");
						
						//Below line is temporary
						objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,"ARUBA");
						
						objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sAltCountryUI);
						objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sAltStateUI);
						objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sAltCityUI, "Alt City");
						objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sAltZipUI, "Alt Zip");
						
						objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						///////////////////////////////////////////////////////////////////////////////////////
						
						mAltAddressDataUI.put(i, new HashMap<Integer, String>());  //Map row starts with 1, so add 1 to iRow
						mAltAddressDataUI.get(i).put(1,"AUTOALTADDRDESC_"+i);
						mAltAddressDataUI.get(i).put(2,sAltAddr1UI.toUpperCase());
						mAltAddressDataUI.get(i).put(3,sAltAddr2UI.toUpperCase()+" "+i+"00");
						mAltAddressDataUI.get(i).put(4,sAltAddr3UI.toUpperCase()+" "+i+"00");
						mAltAddressDataUI.get(i).put(5,sAltCountryUI.toUpperCase());
						mAltAddressDataUI.get(i).put(6,sAltStateUI.toUpperCase());
						mAltAddressDataUI.get(i).put(7,sAltCityUI.toUpperCase());
						mAltAddressDataUI.get(i).put(8,sAltZipUI.toUpperCase());
						////////////////////////////////////////////////////////////////////////////////////////
						
					}
				}
				
				/////////////////Adding Customer Address End//////////////////
				
				//Add group code here
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAddGroup_xp, "Add Group button", true);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputGroupName_xp, "AutoTestGroup_"+sRandom, "Group Name");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnGroupSave_xp, "Save Group button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				
				String sCreditLimitUI=sRandom+".00";
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxFirstGroup_xp, "Select First Group", true);
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
				
				
				
				if(sOperation.equalsIgnoreCase("Cancel"))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_AddEditModules_BtnFormExitConfirmation_xp)));
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_BtnFormExitConfirmation_xp, "Confirmation Button", false);
					objGenericFunctionLibrary.fnLoadingPageWait();
				}
				else
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
					//objGenericFunctionLibrary.fnLoadingPageWait();
					
				/*	try {
						waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)));
						String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp)).getText();
						
						objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.CustomersMaster_AddCustomer_MsgSuccess_xp);
						System.out.println(sSuccessMsg);
						objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.CustomersMaster_AddCustomer_Success_msg, sSuccessMsg.trim());
					} catch (Exception e) {
						// TODO Auto-generated catch block
						obj.repAddData( "Verify Success Message", "Success message should be displayed", "Success message not displayed", "Fail");
						e.printStackTrace();
						//throw(e);
					}*/
				}
				
				objGenericFunctionLibrary.fnLoadingPageWait();
			    
			    
			    if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
			    {
			    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
			    	 int iRow = 1; //for add 
					    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
						TestDriver.conn = objDBUtility.fnOpenDBConnection();
						TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
						HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
						if(sOperation.equalsIgnoreCase("Duplicate"))
						{
							iRow = 2; //for duplicate
						}
						objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
						String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
						String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
						String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
						String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
						String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
						String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
						String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
						String sCreditExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
						
						String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
						
						String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
						String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
						String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
						String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
						String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
						String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
						String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
						String sMultEmailDB = mTableDataDB.get(iRow).get(17).toString().trim();
						String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(18).toString().trim();
						
						String sCustomerStatusDB = mTableDataDB.get(iRow).get(24).toString().trim();//isactive field in DB
						String sCustomerPhoneNumberDB = mTableDataDB.get(iRow).get(25).toString().trim();
						
						if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&
								sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) &&
								sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB))
								
								/*sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
								
								sStartDateUI2.equalsIgnoreCase(sStartDateDB) &&
								sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB) && 
								sCreditPermanentDB.equalsIgnoreCase("1") && 
								sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))*/
						{	
							//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
							TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sCountryDB+","+sZipDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
							TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameDB+",,"+sCustomerStatusDB+","+sCustomerTypeDB+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
							obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
						}
						else
						{
							obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
						}
						
						//Verify Address  //Include  sMultEmailDB.equalsIgnoreCase("1")) in If condition once it's implemented
						if(sAddr1UI.equalsIgnoreCase(sAddr1DB) &&
								sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
								sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
								sCountryUI.equalsIgnoreCase(sCountryDB) && 
								sStateUI.equalsIgnoreCase(sStateDB) && 
								sCityUI.equalsIgnoreCase(sCityDB) && 
								sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
						{	
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
						}
						else
						{
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
						}
			    }
			    else if(sOperation.equalsIgnoreCase("Cancel"))
			    {
			    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
				    
				    TestDriver.conn = objDBUtility.fnOpenDBConnection();
				    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					int iTotalRows = 0;
					while(TestDriver.rset.next())
					{
						iTotalRows = iTotalRows+1;
					}
					
					System.out.println(String.valueOf(iTotalRows));
					if(iTotalRows==1)
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
					}
					else
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
					}
			    }
			   
			    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			    
			    ///////////////////////////////////////Verifying Contacts Start//////////////////////////////////////////////////////
			    if(bMultiContact==true)
			    {
			    String sQuery = objSQLConfig.sMasterCustomers_MultiContacts_Query;
			    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
			    fnVerifyMultiContactsAddresses(sQuery,mContactDataUI,"Contacts");
				/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mContactTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
			    }
				/////////////////////////////////////Verifying Contacts End//////////////////////////////////////////////////////
				
				
				///////////////////////////////////////Verifying Alternate Addresses Start//////////////////////////////////////////////////////
			    if(bMultiAddress==true)
			    {
				String sQuery = objSQLConfig.sMasterCustomers_MultiAddresses_Query;
				sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
				fnVerifyMultiContactsAddresses(sQuery,mAltAddressDataUI,"Alternate Addresses");
				/*TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mAltAddressTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);*/
			    }
				/////////////////////////////////////Verifying Alternate Addresses End//////////////////////////////////////////////////////
			
			} catch (Exception e) {
		   System.out.println("fnAddCustomer --------------Failed");    
		   TestDriver.log.error("fnAddCustomer failed",e);
		   }
			
			return sCustomerNameUI;
			
		}
		
	 public void fnVerifyARCscreenBulkoptions(String sColname,String sDealNumberUI,String sOrderUI,String sFilterBtn) throws Exception
	 {

		 try
		 {
			 WebDriverWait waitForTableLoad;	
			 waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			 fnClickSubMenuElement("Billing","ARC");
			 waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
			 WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
			 objGenericFunctionLibrary.HighlightElement(Title);
			 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
			 {
				 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
				 objGenericFunctionLibrary.fnLoadingPageWait();
				 Thread.sleep(4000);
				 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
				 {
					 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
					 objGenericFunctionLibrary.fnLoadingPageWait();
					 Thread.sleep(6000);
					 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

						 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
						 objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);

						 objGenericFunctionLibrary.ClickByXpath(sFilterBtn, "Filter btn", true);
						 Thread.sleep(4000);


						 WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
						 if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
						 {
							 obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
							 System.out.println("Transactions exist");	

						 }
						 else{
							 obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


						 }
					 }

				 }

			 }


			 WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
			 List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
			 System.out.println("Data Rows Size>>>>"+arrTableRows.size());

			 for(int iRow=0;iRow<arrTableRows.size();iRow++)  //Exclude first header row 
			 {	
				 List<WebElement> arrTableColumns = arrTableRows.get(iRow).findElements(By.xpath("./td"));  //Get the table data rows

				 arrTableColumns.get(0).findElement(By.xpath("./input")).click();  //Select the checkbox



			 }

			 objGenericFunctionLibrary.ClickById(SphereModules.Users_ViewUser_BtnBulkActions_id, "BulkActions", true);
			 //fnVerifyCombolistByXpath("Approved_BulkList","Bulk Actions" ,SphereModules.BulkActionsList_xp);	
			 String sExplist = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get(sColname).trim();
			 //String sExplist = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Approved_BulkList").trim(); 
			 String [] arrExpList = sExplist.split(";");

			 List<String> arrExpMenuList = Arrays.asList(arrExpList);
			 List<String> arrActMenuList = new ArrayList<String>();


			 List<WebElement> eleNavList = TestDriver.driver.findElements(By.xpath(SphereModules.BulkActionsList_xp));
			 Integer iNavListSize = eleNavList.size();
			 for(int i=0;i<iNavListSize; i++)
			 {
				 objGenericFunctionLibrary.HighlightElement(eleNavList.get(i).findElement(By.xpath("./a")));
				 String sOption = eleNavList.get(i).findElement(By.xpath("./a")).getText();
				 System.out.println(sOption);
				 arrActMenuList.add(i, sOption);

			 }

			 if(arrActMenuList.equals(arrExpMenuList))
			 {
				 obj.repAddData( "Verify Bulk Action Options on Arc Page", "All options should be available in correct order", "All  options are verified with correct values and order : ", "Pass");
			 }
			 else
			 {
				 obj.repAddData( "Verify Bulk Action Options  on Arc Page", "All  options should be available in correct order", " options check failed with incorrect values or order : ", "Fail");
			 }
			 //objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_DealNumber_Clear_Btn_xp, "Clear", true);
			 //Thread.sleep(4000);

			 /*objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_DealNumber_Clear_Btn_xp, "Clear", true);
	 			Thread.sleep(4000);
	 			objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
	 			objGenericFunctionLibrary.fnLoadingPageWait();*/


		 } catch (Exception e) {
			 System.out.println("fnVerifyARCscreenBulkoptions--------------Failed");    
			 TestDriver.log.error("fnVerifyARCscreenBulkoptions failed",e);
		 }

	 }


	 public void fnVerifyARCscreenBulkoptionMessages(String sColname,String sDealNumberUI,String sOrderUI,String sFilterBtn) throws Exception
	 {

		 try
		 {
			 WebDriverWait waitForTableLoad;	
			 waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			 fnClickSubMenuElement("Billing","ARC");
			 waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
			 WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
			 objGenericFunctionLibrary.HighlightElement(Title);
			 WebElement ele=TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_Clear_Btn_xp));
			 if(ele.isDisplayed()){
			 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 }
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
			 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
			 objGenericFunctionLibrary.fnLoadingPageWait();
			 Thread.sleep(6000);
			 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
			 {
				 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
				 objGenericFunctionLibrary.fnLoadingPageWait();
				 Thread.sleep(4000);
				 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
				 {
					 objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
					 objGenericFunctionLibrary.fnLoadingPageWait();
					 Thread.sleep(6000);
					 if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

						 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
						 objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
						 objGenericFunctionLibrary.ClickByXpath(sFilterBtn, "Filter btn", true);
						 Thread.sleep(4000);
						 WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
						 if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
						 {
							 obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
							 System.out.println("Transactions exist");	

						 }
						 else{
							 obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


						 }
					 }

				 }

			 }


			 WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
			 List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
			 System.out.println("Data Rows Size>>>>"+arrTableRows.size());

			 //for(int iRow=0;iRow<arrTableRows.size();iRow++)  //Exclude first header row 
			 //{	
			 List<WebElement> arrTableColumns = arrTableRows.get(1).findElements(By.xpath("./td"));  //Get the table data rows
			 /*String sColValue = arrTableColumns.get(iMatchCol).getText();//.toString();
	 				if(sColValue.equalsIgnoreCase(sMatchValue))
	 				{*/
			 arrTableColumns.get(0).findElement(By.xpath("./input")).click();  //Select the checkbox
			 //obj.repAddData( "Select '"+sMatchValue+"'", "'"+sMatchValue+"' should be selected", "'"+sMatchValue+"' selected successfully", "Pass");
			 //}


			 //}



			 objGenericFunctionLibrary.ClickById(SphereModules.Users_ViewUser_BtnBulkActions_id, "BulkActions", true);

			 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Approved_BulkOption_Reassign_xp, "Reassign", true);
			 Thread.sleep(4000);

			 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_ReassignForm_Title_xp, "Reassign Page Title", true);
			 Thread.sleep(4000);

			 WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereModules.ARC_Screen_Reassign_Btn_xp));
			 objGenericFunctionLibrary.HighlightElement(Titleele);
			 Titleele.click();		
			 Thread.sleep(5000);
			 //waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
			 //sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
			 String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Common_AddEditModules_MsgSuccess_xp)).getText().trim();

			 String sExpSuccessMsg = AppMessages.ARC_Screen_Reassign_Success_Msg;
			 objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpSuccessMsg, sSuccessMsg.trim());


			 objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_AddEditModules_MsgSuccess_xp, "Success Message", true);
			 //Thread.sleep(4000);


			 objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_DealNumber_Clear_Btn_xp, "Clear", true);
			 Thread.sleep(4000);
			 //objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
			// objGenericFunctionLibrary.fnLoadingPageWait();


		 } catch (Exception e) {
			 System.out.println("fnVerifyARCscreenBulkoptionMessages--------------Failed");    
			 TestDriver.log.error("fnVerifyARCscreenBulkoptionMessages failed",e);
		 }

	 }

	 @SuppressWarnings("static-access")
		public String fnVerifyDSNinARCscreenPopUps() throws Exception
		{
			String sDeptSyssNumberRandom ="";
			
			try
			{
				
				obj.repAddData( "Verifying Transactions appear in ARC Screen ", "", "", "");
				
				String sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
				System.out.println(sNewValue);
				//String sNewValue="682612001";
				String sDealNumberUI=sNewValue.substring(0,6);
				String sOrderUI=sNewValue.substring(6,9);
				
				String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
				sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
				sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
			    
				
				sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
				System.out.println(sDeptSyssNumberRandom);
			   	
			    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - BulkSuspend.txt");
			    System.out.println(targetFileName);
			   
			    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
			    
			    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
			    Thread.sleep(10000);			
			   // BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    
			    WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				fnClickSubMenuElement("Billing","ARC");
				waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
				WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
				objGenericFunctionLibrary.HighlightElement(Title);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
				objGenericFunctionLibrary.fnLoadingPageWait();
				Thread.sleep(4000);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(4000);
					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
					{

						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(6000);
						if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

							objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
							//ClickByXpath(sFilterBtn, "Filter btn", true);
							Thread.sleep(4000);
							WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

							if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
								System.out.println("Transactions exist");	

							}
							else
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


							}
						}

					}

				}
				else
				{
					obj.repAddData( "Verifying  Deal on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for deal "+sDealNumberUI+ "Should be dispalyed", "Validation failed for :\t Deal Number: "+sDealNumberUI, "Fail");


				}
					
					WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
					List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
					System.out.println("Data Rows Size>>>>"+arrTableRows.size());
					
					
					fnVerifyDSNAllPopUps(sDeptSyssNumberRandom,SphereModules.ARC_Screen_InterceptMenu_Send_Btn_xp,"Send",SphereModules.ARC_Screen__Send_Popup_Title_xp);
					fnVerifyDSNAllPopUps(sDeptSyssNumberRandom,SphereModules.ARC_Screen_InterceptMenu_Non_Billable_Btn_xp,"Reassign",SphereModules.ARC_Screen_ReassignForm_Title_xp);
					fnVerifyDSNAllPopUps(sDeptSyssNumberRandom,SphereModules.ARC_Screen_InterceptMenu_Reject_Btn_xp,"Reject",SphereModules.ARC_Screen__Reject_Popup_Title_xp);
					fnVerifyDSNAllPopUps(sDeptSyssNumberRandom,SphereModules.ARC_Screen_InterceptMenu_Non_Billable_Btn_xp,"Non Billable",SphereModules.ARC_Screen_Make_Transaction_Non_Billable_Popup_Title_xp);
					fnVerifyDSNAllPopUps(sDeptSyssNumberRandom,SphereModules.ARC_Screen_InterceptMenu_Suspend_Btn_xp,"Suspend",SphereModules.ARC_Screen__Suspend_Popup_Title_xp);
		 			
				
			} catch (Exception e)
			{
		   System.out.println("fnViewARCscreenTranscationforDSN --------------Failed");    
		   obj.repAddData( "Verify Transaction", "New Transaction should be created", "New Transaction not created", "Fail");
		   TestDriver.log.error("fnAddDealAccount failed",e);
		   }
			
			return sDeptSyssNumberRandom;
		}
	 
	 @SuppressWarnings("static-access")
		public String fnSendDETDepositTransactionsToDraftBill() throws Exception
		{
			String sDealNumberUI ="";
			
			try
			{
				
				obj.repAddData( "Verifying Transactions appear in ARC Screen and approve and send to Draft Bill ", "", "", "");
				
				String sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
				System.out.println(sNewValue);
				//String sNewValue="682612001";
				sDealNumberUI=sNewValue.substring(0,6);
				String sOrderUI=sNewValue.substring(6,9);
				
				String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
				sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
				sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
				
				String sQuery2 = objSQLConfig.sDraftBill_DealId_Query;
				sQuery2 = sQuery2.replaceAll("deal_number_param",sDealNumberUI);
				
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    
				String DealIdDB=mTableDataDB2.get(1).get(1).toString().trim();
				
				String sQuery3 = objSQLConfig.sDraftBill_DealId_Update_Query;
				sQuery3 = sQuery3.replaceAll("deal_id_param",DealIdDB);
				
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.stmt.executeUpdate(sQuery3);
				
				String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
				System.out.println(sDeptSyssNumberRandom);
			   	
			    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - PrePayment_Invoice.txt");
			    System.out.println(targetFileName);
			   
			    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
			    
			    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
			    Thread.sleep(10000);			
			   // BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    
			    WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				fnClickSubMenuElement("Billing","ARC");
				waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
				WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
				objGenericFunctionLibrary.HighlightElement(Title);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
				objGenericFunctionLibrary.fnLoadingPageWait();
				Thread.sleep(4000);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(4000);
					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
					{

						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(6000);
						if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

							objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
							//ClickByXpath(sFilterBtn, "Filter btn", true);
							Thread.sleep(4000);
							WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

							if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
								System.out.println("Transactions exist");	

							}
							else
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


							}
						}

					}

				}
				else
				{
					obj.repAddData( "Verifying  Deal on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for deal "+sDealNumberUI+ "Should be dispalyed", "Validation failed for :\t Deal Number: "+sDealNumberUI, "Fail");


				}
					
					WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
					List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
					System.out.println("Data Rows Size>>>>"+arrTableRows.size());
					
					objGenericFunctionLibrary.RightClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row");
				    Thread.sleep(3000);
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_InterceptMenu_Send_Btn_xp, "Send btn", true);
				    objGenericFunctionLibrary.fnLoadingPageWait();
				    Thread.sleep(4000); 
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Popup_Title_xp, "Send Poupup Title", true);
			 		Thread.sleep(4000);
			 		objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Btn_xp, "Send button", true);
			 		Thread.sleep(4000);
		 			
				
			} catch (Exception e) {
		   System.out.println("fnSendARCTransactionsToDraftBill --------------Failed");    
		   obj.repAddData( "Verify Transaction", "New Transaction should be created", "New Transaction not created", "Fail");
		   TestDriver.log.error("fnSendARCTransactionsToDraftBill failed",e);
		   }
			
			return sDealNumberUI;
			
			
		}

	 @SuppressWarnings("static-access")
		public String fnSendDCSTransactionsToDraftBill() throws Exception
		{
			String sDealNumberUI ="";
			
			try
			{
				
				obj.repAddData( "Verifying Transactions appear in ARC Screen and approve and send to Draft Bill ", "", "", "");
				
				String sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
				System.out.println(sNewValue);
				//String sNewValue="682612001";
				sDealNumberUI=sNewValue.substring(0,6);
				String sOrderUI=sNewValue.substring(6,9);
				
				String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
				sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
				sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
				
				String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
				System.out.println(sDeptSyssNumberRandom);
			   	
			    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - PrePayment_Invoice.txt");
			    System.out.println(targetFileName);
			   
			    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
			    
			    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
			    Thread.sleep(10000);			
			   // BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    
			    WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				fnClickSubMenuElement("Billing","ARC");
				waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
				WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
				objGenericFunctionLibrary.HighlightElement(Title);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
				objGenericFunctionLibrary.fnLoadingPageWait();
				Thread.sleep(4000);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(4000);
					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
					{

						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(6000);
						if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

							objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
							//ClickByXpath(sFilterBtn, "Filter btn", true);
							Thread.sleep(4000);
							WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

							if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
								System.out.println("Transactions exist");	

							}
							else
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


							}
						}

					}

				}
				else
				{
					obj.repAddData( "Verifying  Deal on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for deal "+sDealNumberUI+ "Should be dispalyed", "Validation failed for :\t Deal Number: "+sDealNumberUI, "Fail");


				}
					
					WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
					List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
					System.out.println("Data Rows Size>>>>"+arrTableRows.size());
					
					objGenericFunctionLibrary.RightClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row");
				    Thread.sleep(3000);
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_InterceptMenu_Send_Btn_xp, "Send btn", true);
				    objGenericFunctionLibrary.fnLoadingPageWait();
				    Thread.sleep(4000); 
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Popup_Title_xp, "Send Poupup Title", true);
			 		Thread.sleep(4000);
			 		objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Btn_xp, "Send button", true);
			 		Thread.sleep(4000);
		 			
				
			} catch (Exception e) {
		   System.out.println("fnSendDCSTransactionsToDraftBill --------------Failed");    
		   obj.repAddData( "Verify Transaction", "New Transaction should be created", "New Transaction not created", "Fail");
		   TestDriver.log.error("fnSendDCSTransactionsToDraftBill failed",e);
		   }
			
			return sDealNumberUI;
			
		}
	 @SuppressWarnings("static-access")
		public String fnCreateimmediateDCSDraftBill() throws Exception
		{
			String sDealNumberUI ="";
			
			try
			{
				
				obj.repAddData( "Verifying Transactions appear in ARC Screen and approve and send to Draft Bill ", "", "", "");
				WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				//String sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
				//System.out.println(sNewValue);
				String sNewValue=fnCreateDCSDealOrder("Open Order","Open Deal");
				System.out.println(sNewValue);
				//String sNewValue="686848001";
				sDealNumberUI=sNewValue.substring(0,6);
				String sOrderUI=sNewValue.substring(6,9);
				
				String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
				sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
				sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
				
				String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
				System.out.println(sDeptSyssNumberRandom);
			   	
			    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - PrePayment_Invoice.txt");
			    System.out.println(targetFileName);
			   
			    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
			    
			    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
			    Thread.sleep(10000);			
			   // BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    
			    //WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				fnClickSubMenuElement("Billing","ARC");
				waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
				WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
				objGenericFunctionLibrary.HighlightElement(Title);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
				objGenericFunctionLibrary.fnLoadingPageWait();
				Thread.sleep(4000);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(4000);
					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
					{

						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(6000);
						if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

							objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
							//ClickByXpath(sFilterBtn, "Filter btn", true);
							Thread.sleep(4000);
							WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

							if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
								System.out.println("Transactions exist");	

							}
							else
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


							}
						}

					}

				}
				else
				{
					obj.repAddData( "Verifying  Deal on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for deal "+sDealNumberUI+ "Should be dispalyed", "Validation failed for :\t Deal Number: "+sDealNumberUI, "Fail");


				}
					
					WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
					List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
					System.out.println("Data Rows Size>>>>"+arrTableRows.size());
					
					objGenericFunctionLibrary.RightClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row");
				    Thread.sleep(3000);
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_InterceptMenu_Send_Btn_xp, "Send btn", true);
				    objGenericFunctionLibrary.fnLoadingPageWait();
				    Thread.sleep(4000); 
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Popup_Title_xp, "Send Poupup Title", true);
			 		Thread.sleep(4000);
			 		objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Btn_xp, "Send button", true);
			 		Thread.sleep(4000);
			 					 		
			 		fnClickSubMenuElement("Billing","Draft Billing");
					waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp)));
					WebElement DraftBillingTitle = TestDriver.driver.findElement(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp));
					objGenericFunctionLibrary.HighlightElement(DraftBillingTitle);
					
					WebElement ClearAllEle = TestDriver.driver.findElement(By.xpath(objSphereModules.Billings_Suspense_ClearAll_Btn_xp));

					if(ClearAllEle.isDisplayed())
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Billings_Suspense_ClearAll_Btn_xp, "Clear All Button", true);
					}


					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,"","Deal Number");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,sDealNumberUI,"Deal Number");
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(5000);

					if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_Deal_list_1))
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Deal_list_1, "Deal", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(4000);

						if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_DraftBill_List_xp))

						{
							String sDraftBillNumber =TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_DraftBill_Number_xp)).getText().trim();                  
							System.out.println(sDraftBillNumber);
							Thread.sleep(3000);
							String sExpTitle="Direct Charge Summary";
							objGenericFunctionLibrary.RightClickByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "Draft Bill");
							Thread.sleep(4000);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Intercept_View_Edit_DraftBill_xp, "View Edit", true);
							Thread.sleep(3000);
							waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Billing_DraftBilling_Edit_Title_xp)));
							//fnVerifyLabelMsgTextByXpath(sExpTitle, SphereModules.Billing_DraftBilling_Edit_Title_xp);
							WebElement DirectChargePageTitle=TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_Edit_Title_xp));
							objGenericFunctionLibrary.HighlightElement(DirectChargePageTitle);
							//SendKeyById(SphereModules.Billing_DraftBilling_percent_id, "" , "Search Box");
							//TestDriver.driver.findElement(By.id(SphereModules.Billing_DraftBilling_percent_id)).click();

							//TestDriver.driver.findElement(By.id(SphereModules.Billing_DraftBilling_percent_id)).sendKeys(Keys.HOME);
							//TestDriver.driver.findElement(By.id(SphereModules.Billing_DraftBilling_percent_id)).sendKeys("10");
							Thread.sleep(3000);

							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Edit_Create_xp, "Edit", true);
							Thread.sleep(3000);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_immediate_xp, "immeadiate", true);
							Thread.sleep(3000);
							WebElement PopupTitle1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Billing_DraftBilling_createImmediate_PopUp_Title_xp));
							objGenericFunctionLibrary.HighlightElement(PopupTitle1);

							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_createImmediate_PopUp_YesBtn_xp, "immeadiate", true);
							Thread.sleep(9000);

							//fnCheckFieldDisplayByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "list 1", true, true);
							//fnCheckFieldDoesNotExistByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "list 1", true);						

							if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_DraftBill_List_xp)==false)
							{
								obj.repAddData( "Verify  Draft Bill disappeared after creating immediate: ", "Draft Bill list should not be dispalyed", "Draft Bill list is not displayed", "Pass");
							}
							else
							{
								obj.repAddData( "Verify  Draft Bill disappeared after creating immediate: ", "Draft Bill list should not be dispalyed", "Draft Bill list is still displayed", "Fail");
							}
						}
					}
			} catch (Exception e) 
			{
		   System.out.println("fnCreateimmediateDCSDraftBill --------------Failed");    
		   obj.repAddData( "Verify Transaction", "New Transaction should be created", "New Transaction not created", "Fail");
		   TestDriver.log.error("fnCreateimmediateDCSDraftBill failed",e);
		   }
			
			return sDealNumberUI;
			
		}

	 
	 @SuppressWarnings("static-access")
		public String fnVerifyDefaultInvoiceDCS() throws Exception
		{
			String sDealNumberUI ="";
			
			try
			{
				
				obj.repAddData( "Verifying Transactions appear in ARC Screen and approve and send to Draft Bill ", "", "", "");
				WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				//String sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
				//System.out.println(sNewValue);
				String sNewValue=fnCreateDCSDealOrderwithNewCustomer("Open Order","Open Deal");
				System.out.println(sNewValue);
				//String sNewValue="686848001";
				sDealNumberUI=sNewValue.substring(0,6);
				String sOrderUI=sNewValue.substring(6,9);
				
				String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
				sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
				sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
				
				String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
				System.out.println(sDeptSyssNumberRandom);
			   	
			    String targetFileName=fnnewArchiveFile("C:\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - PrePayment_Invoice.txt");
			    System.out.println(targetFileName);
			   
			    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
			    
			    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
			    Thread.sleep(30000);			
			   // BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    
			    //WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				fnClickSubMenuElement("Billing","ARC");
				waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
				WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
				objGenericFunctionLibrary.HighlightElement(Title);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
				objGenericFunctionLibrary.fnLoadingPageWait();
				Thread.sleep(4000);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(4000);
					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
					{

						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(6000);
						if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

							objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
							//ClickByXpath(sFilterBtn, "Filter btn", true);
							Thread.sleep(4000);
							WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

							if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
								System.out.println("Transactions exist");	

							}
							else
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


							}
						}

					}

				}
				else
				{
					obj.repAddData( "Verifying  Deal on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for deal "+sDealNumberUI+ "Should be dispalyed", "Validation failed for :\t Deal Number: "+sDealNumberUI, "Fail");


				}
					
					WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
					List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
					System.out.println("Data Rows Size>>>>"+arrTableRows.size());
					
					objGenericFunctionLibrary.RightClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row");
				    Thread.sleep(3000);
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_InterceptMenu_Send_Btn_xp, "Send btn", true);
				    objGenericFunctionLibrary.fnLoadingPageWait();
				    Thread.sleep(4000); 
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Popup_Title_xp, "Send Poupup Title", true);
			 		Thread.sleep(4000);
			 		objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Btn_xp, "Send button", true);
			 		Thread.sleep(4000);
			 					 		
			 		fnClickSubMenuElement("Billing","Draft Billing");
					waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp)));
					WebElement DraftBillingTitle = TestDriver.driver.findElement(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp));
					objGenericFunctionLibrary.HighlightElement(DraftBillingTitle);
					
					WebElement ClearAllEle = TestDriver.driver.findElement(By.xpath(objSphereModules.Billings_Suspense_ClearAll_Btn_xp));

					if(ClearAllEle.isDisplayed())
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Billings_Suspense_ClearAll_Btn_xp, "Clear All Button", true);
					}


					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,"","Deal Number");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,sDealNumberUI,"Deal Number");
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(5000);

					if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_Deal_list_1))
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Deal_list_1, "Deal", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(4000);

						if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_DraftBill_List_xp))

						{
							String sDraftBillNumber =TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_DraftBill_Number_xp)).getText().trim();                  
							System.out.println(sDraftBillNumber);
							Thread.sleep(3000);
							String sExpTitle="Direct Charge Summary";
							objGenericFunctionLibrary.RightClickByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "Draft Bill");
							Thread.sleep(4000);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Intercept_View_Edit_DraftBill_xp, "View Edit", true);
							Thread.sleep(3000);
							waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Billing_DraftBilling_Edit_Title_xp)));
							//fnVerifyLabelMsgTextByXpath(sExpTitle, SphereModules.Billing_DraftBilling_Edit_Title_xp);
							WebElement DirectChargePageTitle=TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_Edit_Title_xp));
							objGenericFunctionLibrary.HighlightElement(DirectChargePageTitle);
							Thread.sleep(3000);
							String sStatusField=TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_DeliveryMethod_xp)).getText().trim();
							objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Billing_DraftBilling_DeliveryMethod_xp);
							System.out.println(sStatusField);
							String sExpStatusField ="Suppress";
							objGenericFunctionLibrary.fnVerifyLabelMsgText(sExpStatusField, sStatusField.trim());
							objGenericFunctionLibrary.ClickByXpath(SphereModules.InvoiceStatementInquiry_Exit, "click", true);
							Thread.sleep(6000);
							
						}
					}
			} catch (Exception e) 
			{
		   System.out.println("fnVerifyDefaultInvoice --------------Failed");    
		   obj.repAddData( "Verify Transaction", "New Transaction should be created", "New Transaction not created", "Fail");
		   TestDriver.log.error("fnVerifyDefaultInvoice failed",e);
		   }
			
			return sDealNumberUI;
			
		}

	 @SuppressWarnings("static-access")
		public String fnCreateimmediateDCSDraftBillwithFile(String file) throws Exception
		{
			String sDealNumberUI ="";
			String sNewValue="";
			try
			{
				
				obj.repAddData( "Verifying Transactions appear in ARC Screen and approve and send to Draft Bill ", "", "", "");
				
				WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				
			    sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
				System.out.println(sNewValue);
				//String sNewValue="687820001";
				sDealNumberUI=sNewValue.substring(0,6);
				String sOrderUI=sNewValue.substring(6,9);
				
				String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
				sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
				sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
				
			//	String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
			//	System.out.println(sDeptSyssNumberRandom);
				String sDeptSyssNumberRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1000001, 9999999));
				System.out.println(sDeptSyssNumberRandom);
				
			    //String targetFileName=fnnewArchiveFilei81("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\",file);
				//String targetFileName=fnnewArchiveFilei81("C:\\Sphere_Automation\\TestData\\",file);
			    
				/*System.out.println(targetFileName);
			   
			    BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DealOrder",sNewValue);
			    BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			  //BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"PoNumber",ponumberDB);
			    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);*/
			    
			    
			    
			    
			   /* String targetFileName=fnnewArchiveFilei81("C:\\Sphere_Automation\\TestData\\","FI8101.DAT");
			    System.out.println(targetFileName);
			    //BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DealOrder",sNewValue);
			    //BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DealOrder1",sNewValue);
			  	BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);*/
			    
			    
			    
			  	String targetFileName=fnnewArchiveFilei81DAT("C:\\Sphere_Automation\\TestData\\","FI8101_6703529.DAT");
			    System.out.println(targetFileName);
			    //BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DealOrder",sNewValue);
			    //BusinessFunctionLibrary.fnReadReplacei81TextFile(targetFileName,"DealOrder1",sNewValue);
			  	BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
			    
			  	Thread.sleep(90000);
			  	Thread.sleep(90000);
			  	Thread.sleep(90000);
			    Thread.sleep(30000);			
			   // BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
			    
			    //WebDriverWait waitForTableLoad;	
				waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				
				fnClickSubMenuElement("Billing","ARC");
				waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
				WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
				objGenericFunctionLibrary.HighlightElement(Title);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
				objGenericFunctionLibrary.fnLoadingPageWait();
				Thread.sleep(4000);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(4000);
					if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
					{

						objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(6000);
						if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

							objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
							//ClickByXpath(sFilterBtn, "Filter btn", true);
							Thread.sleep(4000);
							WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

							if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
								System.out.println("Transactions exist");	

							}
							else
							{
								obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");


							}
						}

					}

				}
				else
				{
					obj.repAddData( "Verifying  Deal on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for deal "+sDealNumberUI+ "Should be dispalyed", "Validation failed for :\t Deal Number: "+sDealNumberUI, "Fail");


				}
					
					WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
					List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
					System.out.println("Data Rows Size>>>>"+arrTableRows.size());
					
					objGenericFunctionLibrary.RightClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row");
				    Thread.sleep(3000);
				    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_InterceptMenu_Approve_Send_Btn_xp, "Send btn", true);
				    objGenericFunctionLibrary.fnLoadingPageWait();
				    Thread.sleep(4000); 
				    //objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Popup_Title_xp, "Send Poupup Title", true);
			 		//Thread.sleep(4000);
			 		objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Approve_Send_Btn_xp, "Send button", true);
			 		Thread.sleep(4000);
			 					 		
			 		/*fnClickSubMenuElement("Billing","Draft Billing");
					waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp)));
					WebElement DraftBillingTitle = TestDriver.driver.findElement(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp));
					objGenericFunctionLibrary.HighlightElement(DraftBillingTitle);
					
					WebElement ClearAllEle = TestDriver.driver.findElement(By.xpath(objSphereModules.Billings_Suspense_ClearAll_Btn_xp));

					if(ClearAllEle.isDisplayed())
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Billings_Suspense_ClearAll_Btn_xp, "Clear All Button", true);
					}


					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,"","Deal Number");
					objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,sDealNumberUI,"Deal Number");
					objGenericFunctionLibrary.fnLoadingPageWait();
					Thread.sleep(5000);

					if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_Deal_list_1))
					{
						objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Deal_list_1, "Deal", true);
						objGenericFunctionLibrary.fnLoadingPageWait();
						Thread.sleep(4000);

						if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_DraftBill_List_xp))

						{
							String sDraftBillNumber =TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_DraftBill_Number_xp)).getText().trim();                  
							System.out.println(sDraftBillNumber);
							Thread.sleep(3000);
							String sExpTitle="Direct Charge Summary";
							objGenericFunctionLibrary.RightClickByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "Draft Bill");
							Thread.sleep(4000);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Intercept_View_Edit_DraftBill_xp, "View Edit", true);
							Thread.sleep(3000);
							waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Billing_DraftBilling_Edit_Title_xp)));
							//fnVerifyLabelMsgTextByXpath(sExpTitle, SphereModules.Billing_DraftBilling_Edit_Title_xp);
							WebElement DirectChargePageTitle=TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_Edit_Title_xp));
							objGenericFunctionLibrary.HighlightElement(DirectChargePageTitle);
							//SendKeyById(SphereModules.Billing_DraftBilling_percent_id, "" , "Search Box");
							//TestDriver.driver.findElement(By.id(SphereModules.Billing_DraftBilling_percent_id)).click();

							//TestDriver.driver.findElement(By.id(SphereModules.Billing_DraftBilling_percent_id)).sendKeys(Keys.HOME);
							//TestDriver.driver.findElement(By.id(SphereModules.Billing_DraftBilling_percent_id)).sendKeys("10");
							Thread.sleep(3000);

							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Edit_Create_xp, "Edit", true);
							Thread.sleep(3000);
							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_immediate_xp, "immeadiate", true);
							Thread.sleep(3000);
							WebElement PopupTitle1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Billing_DraftBilling_createImmediate_PopUp_Title_xp));
							objGenericFunctionLibrary.HighlightElement(PopupTitle1);

							objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_createImmediate_PopUp_YesBtn_xp, "immeadiate", true);
							Thread.sleep(9000);

							//fnCheckFieldDisplayByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "list 1", true, true);
							//fnCheckFieldDoesNotExistByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "list 1", true);						

							if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_DraftBill_List_xp)==false)
							{
								obj.repAddData( "Verify  Draft Bill disappeared after creating immediate: ", "Draft Bill list should not be dispalyed", "Draft Bill list is not displayed", "Pass");
							}
							else
							{
								obj.repAddData( "Verify  Draft Bill disappeared after creating immediate: ", "Draft Bill list should not be dispalyed", "Draft Bill list is still displayed", "Fail");
							}
						}
					}*/
			} catch (Exception e) 
			{
		   System.out.println("fnCreateimmediateDCSDraftBill --------------Failed");    
		   obj.repAddData( "Verify Transaction", "New Transaction should be created", "New Transaction not created", "Fail");
		   TestDriver.log.error("fnCreateimmediateDCSDraftBill failed",e);
		   }
			
			return sNewValue;
			
		}

	 public void fnVerifydatefilteredvalues(String Startdate,String Enddate,String sTablexpath,int sColnumber,String sFilterBtn,String sStartdatexpath,String sEnddatexpath) throws Exception
	 	{
	 	
	 		try
	 		{
	    
	 
		SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");
		objGenericFunctionLibrary.SendKeyByXpath(sStartdatexpath, Startdate, "Start Date");
		objGenericFunctionLibrary.SendKeyByXpath(sEnddatexpath, Enddate, "End Date");
		
		objGenericFunctionLibrary.ClickByXpath(sFilterBtn, "Filter",true);
		
		HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(sTablexpath);
		System.out.println("Hello");
		
		for(int i=1;i<=mTableDataUI.size(); i++)
		{
			String filterdate = mTableDataUI.get(i).get(sColnumber).toString();
			//String Formatfilterdate= new SimpleDateFormat("MM/dd/yyyy").format(filterdate);
			Date filterdateformat = sdf.parse(filterdate);
			//System.out.println(date);
			System.out.println(sdf.parse(Startdate));
			if(sdf.parse(Startdate).before(filterdateformat) || 
					sdf.parse(Startdate).compareTo(filterdateformat)==0)
			{

			if(filterdateformat.before(sdf.parse(Enddate)) || 
					filterdateformat.compareTo(sdf.parse(Enddate))==0)
			{
				obj.repAddData("Verifying filter date value in "+i+" Row", "Flitered Invoice date "+filterdateformat+" should be in between given start date " +Startdate+ " and end date " +Enddate, "Flitered Invoice date "+filterdateformat+" is in between given start date " +Startdate+ " and end date " +Enddate+" is displayed", "Pass");
          
			}
			else
			{
				obj.repAddData("Verifying filter date value in "+i+" Row", "Flitered Invoice date "+filterdateformat+" should be in less than end date " +Enddate, "Flitered Invoice date "+filterdateformat+" is not less than end date " +Enddate, "Fail");
			//end date not matching

			}


			}
			else
			{
			//start date not matching
				obj.repAddData("Verifying filter date value in "+i+" Row", "Flitered Invoice date "+filterdateformat+" should be greater than given start date " +Startdate, "Flitered Invoice date "+filterdateformat+" is in not greater than given start date " +Startdate, "Fail");
			
		 }
		
		}

	} catch (Exception e) {
System.out.println("fnVerifyARCscreenBulkoptionMessages--------------Failed");    
TestDriver.log.error("fnVerifyARCscreenBulkoptionMessages failed",e);
}
	
}
	 
	 public  void fnVerifyResolvedColor(String sColName,String ResolvedColXpath) 
		{
			
			try {
				//String pinkColor="rgba(202, 2, 74, 0.74902)";
				String pinkColor="rgba(202, 2, 74, 0.75)";
				String Whitecolor="rgb(255, 255, 255)";
				String lightcolor="rgb(249, 249, 249)";
				
					String resolvedcolor=TestDriver.driver.findElement(By.xpath(ResolvedColXpath)).getCssValue("background-color");
					System.out.println(resolvedcolor);
					//if(resolvedcolor.equals(Whitecolor)||resolvedcolor.equals(lightcolor))
					if(resolvedcolor.equals(pinkColor))
					{	
						
						obj.repAddData( "Verifying Resolved color for " +sColName, " Resolved color  should be displayed in White color", Whitecolor+ " color is not displayed ", "Fail");
					}
					else
				    {
						obj.repAddData( "Verifying Resolved color for " +sColName, " Resolved color should be displayed in white color", Whitecolor+ " color is displayed ", "Pass");
				    }
					 
				
				//if(driver.findElement(By.xpath(objSphereModules.BillingRequest_OrderNumber_xp)).getCssValue("background-color").toString().equals(Redcolor));
				
				
				
			} catch (Exception e) {
				System.out.println("Error occurred"+ e.getMessage());
			} 
		}
	 
	 
	

	 
	
//*******************************************************************Code added by Surja*************************************************************
	 
	 
	 
	 
	 
	 

	 
	 
	 public  String fnCreateDealOrderforexception3(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		//String sPoNumberUI = "PO_"+sRandom;
		//String sPoNumberUI = sPoRandom;
		String sPoNumberUI = "501128";
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(7000);
		List<WebElement> options = TestDriver.driver.findElements(By.xpath("//ul[@class='ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu ng-scope'and @position='down']//div[starts-with(@id,'ui-select-choices-')]"));
		System.out.println(options.size());
        for(int i=0;i<=options.size();i++){
        String optionName = options.get(i).getText();
        System.out.println(optionName);
        String DealNumUI = optionName.substring(0, 6);
        System.out.println(DealNumUI);
        if(DealNumUI.equals(DealNumberDB))
        {

       options.get(i).click();
        break;
        }
        }
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		/*objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");*/
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		
		//fnSelectCostCenter(1,sCostCenterUI);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}

	//Function for: TC089_ORB-3191_Billing_Transaction_ Request date.
		 //To validate that Request date will not be shown on Add Transaction slide out.
		 
		 public void fnVerifyRequestDateNotDisplayed(String sDealNumberUI,String sOrderUI,String sFilterBtn) throws Exception
		 	{
		 	try
		 		{
		 			
		 			{
		 				
		 				
		 				/*obj.repAddData( "Navigate to exceptions link in billing", "", "", "");
		 				
		 			    fnClickSubMenuElement("Billing","Exceptions");*/
		 			    
		 				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		 				/*waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.BillingRequest_Table_xp)));
		 				Thread.sleep(4000);*/
		 				
			 			obj.repAddData( "Navigate to ARC link in billing", "", "", "");
			 			
			 			fnClickSubMenuElement("Billing","ARC");
			 			
			 			waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
			 			WebElement Title = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
			 			objGenericFunctionLibrary.HighlightElement(Title);
			 			
			 			//objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
			 			//objGenericFunctionLibrary.fnLoadingPageWait();
			 			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
			 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
			 			objGenericFunctionLibrary.fnLoadingPageWait();
			 			objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Clear_Btn_xp, "Clear button", true);
			 			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Billing_ARC_Deal_Visibility_xp)));
			 			
			 			if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
			 			{
			 				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
			 				objGenericFunctionLibrary.fnLoadingPageWait();
			 				Thread.sleep(4000);
			 				
			 				if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
			 			{
			 			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
			 			objGenericFunctionLibrary.fnLoadingPageWait();
			 			Thread.sleep(4000);
			 			
			 			if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1)){

			 				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
			 				Thread.sleep(4000);
			 				
			 				if(objGenericFunctionLibrary.ElementFound(SphereModules.Common_ViewModules_LinkAll_xp1)){
				 			//System.out.println("Link visible");
			 			 	objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp1, "All Link", true);
			 				//objGenericFunctionLibrary.ClickByXpath(sFilterBtn, "Filter btn", true);
			 				Thread.sleep(4000);
			 				
			 				if(objGenericFunctionLibrary.ElementFound(SphereModules.Common_ARC_ViewTransaction_xp));{
			 				objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ARC_ViewTransaction_xp, "View Transaction", true);
			 				Thread.sleep(4000);
			 				
			 				List<WebElement> divs= TestDriver.driver.findElements(By.xpath("//div[@class='sideview-form-container']//div[@class='ng-isolate-scope']"));
			 						List l1 = new ArrayList();
			 						    for(WebElement e : divs){

			 						      l1.add(e.getText());
			 						      System.out.println(l1);
			 						     

			 						    }
			 						 						 		     
			 						    Boolean isDatePresent = l1.contains("Request Date");
			 						    System.out.println(isDatePresent);
			 						    
			 			 				if(isDatePresent==false){
			 			 				obj.repAddData( "Verify request date is not displayed","Request date should not be displayed","The Request date is not displayed in Add Transaction Page","Pass");	
			 			 				
			                      		                                 
			 							}
			 			 				else
			 			 				{
			 			 					obj.repAddData(  "Verify request date is not displayed","Request date should not be displayed","The Request date is displayed in Add Transaction Page","Fail");	
			 			 				}
			 				
			 				
			 			}
			 			
			 			}
			 			
			 			}
		 			
		 			
		 			
		 		}
			 			}
		 			}
		 		}
		 			
		 
		 catch (Exception e) {
	System.out.println("fnVerifyRequestDateNotDisplayed--------------Failed");    
	TestDriver.log.error("fnVerifyRequestDateNotDisplayed failed",e);
	}
		
		 			
		 			
		 
		 			}

	//To create a deal with WIP Charge Method as Cost Plus
	//Reference TC102_ORB-3399_Billing_ARC-Transaction _ Charge Method
	public  String fnCreateDealOrderforexception2(String OrderStatus, String DealStatus)throws Exception 
			{
			 String sNewValue="";
			 try {
			
		    obj.repAddData( "Creating deal started", "", "", "");
			
			String sDealTitleUI =fnAddDealAccount2(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
			System.out.println(sDealTitleUI);
			String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
			sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
		    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
		    
		    
		    obj.repAddData( "Creating Order started", "", "", "");
			String UIorderNumber="001";
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
			String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
			//String sPoNumberUI = "AutoPONumber_"+sRandom;
			String sPoNumberUI= "501128";
			String sTotalEstimateAmountUI=sRandom+".00";
			String sEpisodeNumber="AutoEpNumber_"+sRandom;
			String sRequestorName="AutoRequestorName_"+sRandom;
			String sApproverName="AutoApproverName_"+sRandom;
		
			String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
			String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
			//String sChargeMethod = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("WIP_Charge_Method").trim();
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
			fnClickMainMenuElement("Dashboard");
			waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
			WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
			objGenericFunctionLibrary.HighlightElement(Titleele);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
			
			//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(4000);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
			waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
			WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
			objGenericFunctionLibrary.HighlightElement(Titleele1);					
			
			
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
		    
			WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
			List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
			System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
			objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
			
			//String sExpcostCenter ="338 SET LIGHTING - IL";
			
			//fnSelectCostCenter(1,sCostCenterUI);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
			objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.WIP_Charge_Method_xp,"Cost Plus");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
			
			//////////////////DBb Validation for order//////////////////
			String sQuery = objSQLConfig.sAdd_Orders_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
		    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
		    //use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
			String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
			String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
			String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
			String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
			
			//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
					UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
					sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
					iSbillableDB.equalsIgnoreCase("1")&&
					orderStatusDB.equalsIgnoreCase("Open"))
			{	
				
				obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
		    
		    }
			
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
			//objGenericFunctionLibrary.fnLoadingPageWait();
			
			
			if(OrderStatus.equalsIgnoreCase("Closed Order"))
			{
				
				
			String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
			objGenericFunctionLibrary.fnCloseOpenedForm();
			Thread.sleep(6000);
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
			//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
			}
			
			if(DealStatus.equalsIgnoreCase("Closed Deal"))
			{
		    fnClickMainMenuElement("Deals");
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 
		    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
			Thread.sleep(4000);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(4000);
			//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
			}	    
			sNewValue=DealNumberDB+UIorderNumber;
			
			
			 } catch (Exception e) {
				    System.out.println("ERROR: unable to read file " );
				    e.printStackTrace();  
				 }

			 return sNewValue;
			}
	
	public  String fnVerifyDETTablesDraftBill(String DepositStatus)throws Exception 
	{
	 String sDealNumberUI="";
	 try {
	
	obj.repAddData( "Verify table on Draft Bill for DET deal", "", "", "");
	obj.repAddData( "Creating deal started", "", "", "");
    
	//String sDealNumberUI="683703";
	//String sOrderUI="001";
	WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
	String sNewValue=fnCreateDealOrderforexception("Open Order","Open Deal");
	System.out.println(sNewValue);
	
	//String sNewValue="683893001";
	sDealNumberUI=sNewValue.substring(0,6);
	String sOrderUI=sNewValue.substring(6,9);
	
	String sQuery1 = objSQLConfig.sNew_Add_Orders_Query;
	sQuery1 = sQuery1.replaceAll("deal_number_param",sDealNumberUI);
	sQuery1 = sQuery1.replaceAll("order_number_param",sOrderUI);
	TestDriver.conn = objDBUtility.fnOpenDBConnection();
	TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
	HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
    
	String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
	if(DepositStatus.equalsIgnoreCase("With Deposit"))
	{
	String sQuery2 = objSQLConfig.sDraftBill_DealId_Query;
	sQuery2 = sQuery2.replaceAll("deal_number_param",sDealNumberUI);
	
	TestDriver.conn = objDBUtility.fnOpenDBConnection();
	TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
	HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
    
	String DealIdDB=mTableDataDB2.get(1).get(1).toString().trim();
	
	String sQuery3 = objSQLConfig.sDraftBill_DealId_Update_Query;
	sQuery3 = sQuery3.replaceAll("deal_id_param",DealIdDB);
	
	TestDriver.conn = objDBUtility.fnOpenDBConnection();
	TestDriver.stmt.executeUpdate(sQuery3);
	}
	
	String sDeptSyssNumberRandom = String.valueOf(new SimpleDateFormat("ddMMHHmmss").format(new Date()));
	System.out.println(sDeptSyssNumberRandom);
   	
    String targetFileName=fnnewArchiveFile("C:\\Automation_Workspace\\Sphere_Automation\\TestData\\","CHSLGRIP_0511_008_DC - PrePayment_Invoice.txt");
    System.out.println(targetFileName);
   
    BusinessFunctionLibrary.fnReadReplaceTextFile(targetFileName,"DealOrder",sNewValue);
    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"DeptSysNum",sDeptSyssNumberRandom);
    BusinessFunctionLibrary.fnNewReadReplaceTextFile(targetFileName,"PoNumber",ponumberDB);
    
    BusinessFunctionLibrary.fnCopyFileToSharedDrive(targetFileName,FileLocSetter.sBillingSharedDrive);
    Thread.sleep(10000);
	
    fnClickSubMenuElement("Billing","ARC");
    waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.ARC_Title_xp)));
    WebElement ArcTitle = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Title_xp));
    objGenericFunctionLibrary.HighlightElement(ArcTitle);
  
    objGenericFunctionLibrary.ClickByXpath(SphereModules.Billings_Suspense_ClearAll_Btn_xp, "Clear All Button", true);
    Thread.sleep(4000);

    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,"","Deal Number");
    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_Deal_Search_Bar_xp,sDealNumberUI,"Deal Number");
    objGenericFunctionLibrary.fnLoadingPageWait();
	Thread.sleep(4000);
	
	if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Deal_list_1))
	{
		objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Deal_list_1, "Deal", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp))
		{

			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.ARC_Screen_OrderNumber_SearchBar_xp,sOrderUI,"Order Number");
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(6000);
			if(objGenericFunctionLibrary.ElementFound(SphereModules.ARC_Screen_Order_list_1))
			{

				objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_Order_list_1, "Order", true);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
				//ClickByXpath(sFilterBtn, "Filter btn", true);
				Thread.sleep(4000);
				WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));

				if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
				{
					obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation successful for  : \t Order Number: "+sOrderUI, "Pass");  
					System.out.println("Transactions exist");	

				}
				else
				{
					obj.repAddData( "Verify  transactions on ARC Screen for: " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should be dispalyed", "Validation failed for  : \t Order Number: "+sOrderUI, "Fail");

				}

			}

		}

	}

		WebElement ArcTable = TestDriver.driver.findElement(By.xpath(objSphereModules.ARC_Screen_transaction_table_xp));
		List<WebElement> arrTableRows = ArcTable.findElements(By.xpath("./tr"));  //Get the table data rows
		System.out.println("Data Rows Size>>>>"+arrTableRows.size());
		
		//objBusinessLib.fnSelectDynamicFilters("Billable Category","Billable Revenue",2);
				
		objGenericFunctionLibrary.RightClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Account Row");
	    Thread.sleep(3000);
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen_InterceptMenu_Send_Btn_xp, "Send btn", true);
	    objGenericFunctionLibrary.fnLoadingPageWait();
	    Thread.sleep(4000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Popup_Title_xp, "Send Poupup Title", true);
 		Thread.sleep(4000);
 		objGenericFunctionLibrary.ClickByXpath(SphereModules.ARC_Screen__Send_Btn_xp, "Send button", true);
 		Thread.sleep(4000);
 		
 		if(TestDriver.driver.findElements(By.xpath(SphereModules.Order_Table_Col4_xp)).size()>0==true)
		{
			obj.repAddData( "Verify  transactions on ARC Screen after clicking on send : " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should not be dispalyed", "Validation failed for : \t Order Number: "+sOrderUI, "Fail");  
			System.out.println("Transactions exist");	

		}
		else
		{
			obj.repAddData( "Verify  transactions on ARC Screen after clicking on send : " +sDealNumberUI+ "-" +sOrderUI, "Transactions for Order "+sOrderUI+ "Should not be dispalyed", "Validation successful for : \t Order Number: "+sOrderUI, "Pass");

		}
 		
	    fnClickSubMenuElement("Billing","Draft Billing");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp)));
		WebElement DraftBillingTitle = TestDriver.driver.findElement(By.xpath(objSphereModules.Billing_DraftBilling_Title_xp));
		objGenericFunctionLibrary.HighlightElement(DraftBillingTitle);

		objGenericFunctionLibrary.ClickByXpath(SphereModules.Billings_Suspense_ClearAll_Btn_xp, "Clear All Button", true);
		Thread.sleep(4000);
        
        objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,"","Deal Number");
        objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Billing_DraftBilling_DealSearchBar_xp,sDealNumberUI,"Deal Number");
        objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		
		if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_Deal_list_1))
		{
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_Deal_list_1, "Deal", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			Thread.sleep(4000);
				
				if(objGenericFunctionLibrary.ElementFound(SphereModules.Billing_DraftBilling_DraftBill_List_xp))
					
				{
					String sDraftBillNumber =TestDriver.driver.findElement(By.xpath(SphereModules.Billing_DraftBilling_DraftBill_Number_xp)).getText().trim();                  
					System.out.println(sDraftBillNumber);
					Thread.sleep(3000);
					
					String sExpTitle="Direct Charge Summary";
					
					objGenericFunctionLibrary.ClickByXpath(SphereModules.Billing_DraftBilling_DraftBill_List_xp, "Draft Bill",true);
					
					WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Billing_DraftBilling_Available_Prepayment_Table_xp));
					List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
					System.out.println("Rows Size>>>>"+arrHeaderColumns.size());
					if(DepositStatus.equalsIgnoreCase("With Deposit"))
					{
						
						if(arrHeaderColumns.size()==4)
						{
							objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Invoice Amount");
							objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Applied Prepayment");
							objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Invoice Net Amount");

							objGenericFunctionLibrary.fnMatchText(SphereModules.Billing_DraftBilling__Table_column_Deal_xp, "Deal", "Deal");
							objGenericFunctionLibrary.fnMatchText(SphereModules.Billing_DraftBilling__Table_column_Selected_xp, "Selected", "Selected");
							Thread.sleep(4000);
						}else
						{
							obj.repAddData( "Verify  columns size  : ", " 3 Columns Should be dispalyed", "3 Columns not displayed", "Fail");
						}
					}
					else
					{
					
						if(arrHeaderColumns.size()==2)
						{
							objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Invoice Amount");

							objGenericFunctionLibrary.fnMatchText(SphereModules.Billing_DraftBilling__Table_column_Deal_xp, "Deal", "Deal");
							objGenericFunctionLibrary.fnMatchText(SphereModules.Billing_DraftBilling__Table_column_Selected_xp, "Selected", "Selected");
							Thread.sleep(4000);
						}else
						{
							obj.repAddData( "Verify  columns size  : ", " 3 Columns Should be dispalyed", "3 Columns not displayed", "Fail");
						}
					}
					
					
				}
					
										
				}
 		 		  		
		
	
	
	 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " );
		    e.printStackTrace();  
		 }

	 return sDealNumberUI;
	}
	
	
	

	
//*******************************************************Created by Surja******************************************************	
	
	
	public String fnAddDealAccount2(int iCostCenter, String sCostCenterUI) throws Exception
	
	{
		String sDealTitleUI ="";
		try
		{
			
			String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));
		
			sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
			String sPoNumberUI = "AutoPONumber_"+sRandom;
			System.out.println("iTC_Project "+TestDriver.mTestPhaseData.get("Project"));
			System.out.println("iTC_ID "+TestDriver.iTC_ID);
			//System.out.println(get(TestDriver.iTC_ID).get("Project"));
			String sProjectName= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
			
			//String sCustomerUI="AUTOTESTDEALCUSTOMER";
			String sFirstName="AutoTestFirstName"+sRandom;
			String sLastName="AutoTestLastName"+sRandom;
			String sContactTitleUI="AutoTitle"+sRandom;
			String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
			String sphoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
			String sContactPhone ="248"+sphoneRandom;
			String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
			String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
		    //String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
		    
		    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
		  
		    Date date = new Date();
		    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
			Date dexpiredday = DateUtils.addDays(new Date(), +5);
			SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
			String sEndDateUI2 = sdf.format(dexpiredday);
			
			fnClickMainMenuElement("Deals");
			WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
			waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
			Thread.sleep(10000); 

			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
			
			fnSelectCostCenter(iCostCenter,sCostCenterUI);
						
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
			
			/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
			
			//////////////////////////
			String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
			String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
			String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
			String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
			String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
			
			String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
			
			//String sCountryUI = "United States of America (USA)";
			String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
			
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
			objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
			/////////////////////////////
			*/
			
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
			
			
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
			objGenericFunctionLibrary.fnLoadingPageWait();
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
			
			//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
			/*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
			Thread.sleep(10000);*/
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle", "Title");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
			//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
			objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
			objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
			///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
			
			//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Create_deal_invoice_format_xp, "DET - Detailed Invoice");
			objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
			///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
			//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
			//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
			objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
			objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
			//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Create_deal_invoice_format_xp, "DET - Detailed Invoice");
			
			objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
			objGenericFunctionLibrary.fnLoadingPageWait();
			
		   /* try {
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
				String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
   
				objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
				System.out.println(sSuccessMsg);
				
				if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
				}
				else
				{
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				}
				
				//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
			} catch (Exception e) {
				// TODO Auto-generated catch block
				obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
				e.printStackTrace();
			}*/
	        
		/*	HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
			System.out.println("Hello");
			String sTempDealnumber= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText().trim();
			for(int i=1;i<=mTableDataUI.size(); i++)
			{
				String sDealNumberUI = mTableDataUI.get(i).get(2).toString();
				
				if(sDealNumberUI.equalsIgnoreCase(sTempDealnumber))
				{
					obj.repAddData( "Verify :" +sTempDealnumber,   " should  be displayed in table.", sTempDealnumber + " displayed in table.", "Pass");
					 System.out.println("success");
					 break;
				}
				
			}	
		*/
				
		    String sQuery = objSQLConfig.sDeals_AddDeal_Query;
		    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
			TestDriver.conn = objDBUtility.fnOpenDBConnection();
			TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
			HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
			
			objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
			String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
			String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
			String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
		    
			String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
			String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
			String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
			String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
			String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
			String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
			String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
			String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
			String slot=mTableDataDB.get(1).get(12).toString().trim();
			String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
			String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
			String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
			String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
			String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
			String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
			String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
			String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
			
				//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
			
				if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
						sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
						sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
			{	
				//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
			}
			else
			{
				obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
			}
			
			
			
		} catch (Exception e) {
	   System.out.println("fnAddDealAccount --------------Failed");    
	   TestDriver.log.error("fnAddDealAccount failed",e);
	   }
		
		return sDealTitleUI;
}	

	public boolean fnCompareTableData(String xpath1,String xpath2) throws Exception
	
	{
		
		Boolean bFlag = null;
		
		try
		{ 
			WebElement tran1 = TestDriver.driver.findElement(By.xpath(xpath1));
			WebElement tran2 = TestDriver.driver.findElement(By.xpath(xpath2));
			String trans1 = tran1.getText().toString();
			System.out.println(trans1);
			String trans2 = tran2.getText().toString();
			System.out.println(trans2);
			
			bFlag=trans1.equals(trans2);
				
		}
		
		catch (Exception e) {
			   System.out.println("fnCompareTableData --------------Failed");    
			   TestDriver.log.error("fnCompareTableData failed",e);
			   }
 return bFlag;
}

	public  String fnCreateDealOrderforexception(String OrderStatus, String DealStatus)throws Exception 
	{
	 String sNewValue="";
	 try {
	
    obj.repAddData( "Creating deal started", "", "", "");
	
	String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
	System.out.println(sDealTitleUI);
	String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
	sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
	TestDriver.conn = objDBUtility.fnOpenDBConnection();
	TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
	HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
    
    
    obj.repAddData( "Creating Order started", "", "", "");
	String UIorderNumber="001";
	String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
	String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
	String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
	//String sPoNumberUI = "PO_"+sRandom;
	String sPoNumberUI = sPoRandom;
	String sTotalEstimateAmountUI=sRandom+".00";
	String sEpisodeNumber="AutoEpNumber_"+sRandom;
	String sRequestorName="AutoRequestorName_"+sRandom;
	String sApproverName="AutoApproverName_"+sRandom;

	String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
	String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
	WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
	fnClickMainMenuElement("Dashboard");
	waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
	WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
	objGenericFunctionLibrary.HighlightElement(Titleele);
	objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
	
	//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
	objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
	objGenericFunctionLibrary.fnLoadingPageWait();
	Thread.sleep(4000);
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
	objGenericFunctionLibrary.fnLoadingPageWait();
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
	waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
	WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
	objGenericFunctionLibrary.HighlightElement(Titleele1);					
	
	
	waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
    
	WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
	List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
	System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

	objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
	objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
	objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
	objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
	objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
	objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
	objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
	//objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");
	
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
	objGenericFunctionLibrary.fnLoadingPageWait();
	objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
	
	//String sExpcostCenter ="338 SET LIGHTING - IL";
	
	//fnSelectCostCenter(1,sCostCenterUI);
	
	objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
	objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
	objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
	objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
	objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
	
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
	objGenericFunctionLibrary.fnLoadingPageWait();
	//////////////////DBb Validation for order//////////////////
	/*String sQuery = objSQLConfig.sAdd_Orders_Query;
    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
    //use Deal Number here instead of DealTitle;
	TestDriver.conn = objDBUtility.fnOpenDBConnection();
	TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
	HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
	
	objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
	String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
	String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
	String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
	String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
	String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
	
	//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
	if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
			UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
			sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
			iSbillableDB.equalsIgnoreCase("1")&&
			orderStatusDB.equalsIgnoreCase("Open"))
	{	
		
		obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
	}
	else
	{
		obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
    
    }*/
	
	//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
	//objGenericFunctionLibrary.fnLoadingPageWait();
	
	
	if(OrderStatus.equalsIgnoreCase("Closed Order"))
	{
		
		
	String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
	objGenericFunctionLibrary.fnLoadingPageWait();
	
	objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
	
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
	objGenericFunctionLibrary.fnCloseOpenedForm();
	Thread.sleep(6000);
	//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
	//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
	//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
	}
	if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
	{
		
		
	String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
	objGenericFunctionLibrary.fnLoadingPageWait();
	
	objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
	
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
	objGenericFunctionLibrary.fnCloseOpenedForm();
	Thread.sleep(6000);
	//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
	//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
	//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
	
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
	objGenericFunctionLibrary.fnLoadingPageWait();
	
	objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
	
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
	objGenericFunctionLibrary.fnCloseOpenedForm();
	Thread.sleep(6000);
	}
	if(DealStatus.equalsIgnoreCase("Closed Deal"))
	{
    fnClickMainMenuElement("Deals");
	waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
	Thread.sleep(10000); 
    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
	Thread.sleep(4000);
	objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
	objGenericFunctionLibrary.fnLoadingPageWait();
	Thread.sleep(4000);
	//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
	objGenericFunctionLibrary.fnLoadingPageWait();
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
	objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
	}	    
	sNewValue=DealNumberDB+UIorderNumber;
	
	
	 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " );
		    e.printStackTrace();  
		 }

	 return sNewValue;
	}
	
	public static void fnReadReplaceTextFile1(String sDestFilePath,String sFieldName, String sNewValue) 
	{
	 //String file = FileLocSetter.sTestDataPath+"TEST.TXT";

	 try {
		int iStartLoc = 0; 
		int iEndLoc = 0; 
		if(sFieldName.equalsIgnoreCase("Deal"))
		{
			iStartLoc = 20;
			iEndLoc = 26;
		}
		if(sFieldName.equalsIgnoreCase("DealOrder"))
		{
			iStartLoc = 20;
			iEndLoc = 29;
		}
		if(sFieldName.equalsIgnoreCase("DeptSysNum"))
		{
			iStartLoc = 3;
			iEndLoc = 12;
		}
		if(sFieldName.equalsIgnoreCase("SLDeptSysNum"))
		{
			iStartLoc = 5;
			iEndLoc = 12;
		}
		
		
		 
	    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sDestFilePath)));
	    String line;
        BufferedWriter output = null;
	    // Uncomment the line below if you want to skip the fist line (e.g if headers)
	    // line = br.readLine();
	    String sFinalText = "";
	    while ((line = br.readLine()) != null) {
	    	if ( line.trim().length() == 0 ) {
	    		//new BufferedWriter(new FileWriter(sDestFilePath)).newLine();
	    		//Files.newBufferedWriter(output, charset).newLine();
	    	    continue;  // Skip blank lines
	    	  }
	    	else
	    	{
	    	sFinalText = sFinalText+line+"\r\n";
    		//String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);
	    	String sDeal = line.substring(iStartLoc, iEndLoc);
    		sFinalText = sFinalText.replaceAll(sDeal, sNewValue);
    		output = new BufferedWriter(new FileWriter(sDestFilePath));
	    	output.write(sFinalText+"\n"+"\n");
	    	
	    	}

	    }
    	/*output = new BufferedWriter(new FileWriter(sDestFilePath));
    	output.write(sFinalText);*/
    	output.close();    
	    br.close();
	    	 
	 } catch (Exception e) {
	    System.out.println("ERROR: unable to read file " + sDestFilePath);
	    e.printStackTrace();  
	 }
} 

	public void fnCheckUploadInDB(final String filename1) throws Exception 
	 
	 {
		 System.out.println("Function called....");
		 try
		 {
		 System.out.println("Entering try....");	 
	
	  String archiveFile = "\\\\tfayd.com\\Shared\\StudioOpsDeptsysBillingQA\\us-ush\\share\\archive";
	  System.out.println(archiveFile);
	 
	 
	  File f = new File(archiveFile);
    FilenameFilter filter = new FilenameFilter() {
       public boolean accept (File dir, String name) { 
          return name.endsWith(filename1);
       } 
    }; 
    String[] children = f.list(filter);
    if (children == null) {
       System.out.println("Either dir does not exist or is not a directory"); 
    } else { 
       for (int i=0; i< children.length; i++) {
          String filename = children[i];
          System.out.println(filename);
          String batchJobID = filename.substring(0, 5);
          System.out.println(batchJobID);
          System.out.println("Starting DB....");
          TestDriver.conn = objDBUtility.fnOpenDBConnection();
  		String sQuery1 = objSQLConfig.sBillingRequest_upload_check_in_DB_Query+batchJobID;
  		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
  		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
  		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
  		System.out.println(mTableDataDB1.toString());
  		String sStatusDB = mTableDataDB1.get(1).get(2).toString();
  		System.out.println(sStatusDB);
  		if (sStatusDB.equals("COMPLETED"))
  		
  		{
  			obj.repAddData( "Verify the transaction in database", "Transaction status should be completed", "Status is completed", "Pass");
  		}
  		
  		else
  		{
  			obj.repAddData( "Verify the transaction in database", "Transaction status should be completed","Status is not completed", "Fail");
  		}	
  			
  		/*String sFirstNameDB = mTableDataDB1.get(1).get(2).toString();
			String sLastNameDB = mTableDataDB1.get(1).get(3).toString();
			String sRoleDB = mTableDataDB1.get(1).get(6).toString();
			String sCostCenterDB = mTableDataDB1.get(1).get(7).toString();
			*/
          
          
       } 
    } 
	 

}
	 catch (Exception e) {
		    System.out.println("ERROR: Unable to validate data in DB");
		    e.printStackTrace();  
		 }
}
	
	public void fnCheckUploadInDB1(final String filename1) throws Exception 
	 
	 {
		 System.out.println("Function called....");
		 try
		 {
		 System.out.println("Entering try....");	 
	
	  String archiveFile = "\\\\tfayd.com\\Shared\\StudioOpsDeptsysBillingQA\\us-ush\\share\\archive";
	  System.out.println(archiveFile);
	 
	 
	  File f = new File(archiveFile);
    FilenameFilter filter = new FilenameFilter() {
       public boolean accept (File dir, String name) { 
    	  System.out.println("Enter....");
          return name.endsWith(filename1);
       } 
    }; 
    String[] children = f.list(filter);
    if (children == null) {
       System.out.println("Either dir does not exist or is not a directory"); 
    } else { 
       for (int i=0; i< children.length; i++) {
          String filename = children[i];
          System.out.println(filename);
          String batchJobID = filename.substring(0, 5);
          System.out.println("Job instance ID is : "+batchJobID);
          System.out.println("Starting DB....");
          TestDriver.conn = objDBUtility.fnOpenDBConnection();
  		String sQuery1 = objSQLConfig.sTransaction_D_record_type_Query+batchJobID;
  		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
  		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
  		String sQuery2 = objSQLConfig.sTransaction_note_record_type_Query+batchJobID;
  		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
  		HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
  		
  		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
  		//System.out.println(mTableDataDB1.toString());
  		//System.out.println(mTableDataDB2.toString());
  		//String sStatusDB = mTableDataDB1.get(1).get(2).toString();
  		//System.out.println(sStatusDB);
  		if (mTableDataDB1.toString()!=null)
  		
  		{
  			obj.repAddData( "Verify the transaction in database for D record", "Transaction should exist", "Transaction exists", "Pass");
  		}
  		
  		else
  		{
  			obj.repAddData( "Verify the transaction in database for D record", "Transaction should exist","Transaction doesnot exist", "Fail");
  		}	
  			
  		    String sNotejobinstanceid = mTableDataDB2.get(1).get(6).toString();
  		    System.out.println("Job instance id is : "+sNotejobinstanceid);
  		    String sExtNotejobinstanceid = mTableDataDB2.get(2).get(6).toString();
  		    String sNotetransactionlineid = mTableDataDB2.get(1).get(7).toString();
  		    System.out.println("Note transaction line id is : "+sNotetransactionlineid);
  		    String sExtNotetransactionlineid = mTableDataDB2.get(2).get(7).toString();
  		    System.out.println("Extended note transaction line id is : "+sExtNotetransactionlineid);
  		    String sNotenotetext = mTableDataDB2.get(1).get(4).toString();
  		    String sExtNotenotetext = mTableDataDB2.get(2).get(4).toString();
  		    System.out.println("Extended note text is : "+sExtNotenotetext);
  		    ArrayList<String> dBValues = new ArrayList<>();
  		    dBValues.add(sNotejobinstanceid);
  		    dBValues.add(sExtNotejobinstanceid);
  		    dBValues.add(sNotetransactionlineid);
  		    dBValues.add(sExtNotetransactionlineid);
  		    dBValues.add(sNotenotetext);
  		    dBValues.add(sExtNotenotetext);
  		    //System.out.println(dBValues);
  		  
  		 if(dBValues.contains(null) || dBValues.contains(""))  
  		{
   			obj.repAddData( "Verify display of all the N & E record type transactions with job_instance_id,transaction_line_id and note_text", "Records should display correctly", "Records are not displayed correctly", "Fail");
   		}
   		
   		else
   		{
   			obj.repAddData( "Verify display of all the N & E record type transactions with job_instance_id,transaction_line_id and note_text", "Records should display correctly", "Records are displayed correctly", "Pass");
   		}	
  		
  		TestDriver.conn = objDBUtility.fnOpenDBConnection();
  		String sQuery3 = objSQLConfig.sTransaction_N_and_E_record_type_Query+"("+sNotetransactionlineid+","+sExtNotetransactionlineid+")";
  		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
  		HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
  		
  		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
  		
  	    String sRecordTypeN = mTableDataDB3.get(1).get(14).toString();
	    String sRecordTypeE = mTableDataDB3.get(2).get(14).toString();
	    String sLineDescN = mTableDataDB3.get(1).get(19).toString();
		String sLineDescE = mTableDataDB3.get(2).get(19).toString();
		 if(sRecordTypeN.equals("N") && sRecordTypeE.equals("E") && sLineDescN.equals("PROPS BURN STAGE CABLE") && sLineDescE.equals("PROPS BURN STAGE CABLE"))  
	   		{
	    			obj.repAddData( "Verify display of all the N & E record type transactions with record_type and line_description", "Records should display correctly", "Records are displayed correctly", "Pass");
	    		}
	    		
	    		else
	    		{
	    			obj.repAddData( "Verify display of all the N & E record type transactions with record_type and line_description", "Records should display correctly", "Records are not displayed correctly", "Fail");
	    		}	
       } 
    } 
	 

}
	 catch (Exception e) {
		    System.out.println("ERROR: Unable to validate data in DB");
		    e.printStackTrace();  
		 }
}
	
	 public  String fnCreateDealAndOrder()throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    /*obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		String sPoNumberUI = "AutoPONumber_"+sRandom;
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);*/
		fnClickMainMenuElement("Dashboard");
		
	    WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
	    waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		WebDriverWait waitForTableLoad1 = new WebDriverWait(TestDriver.driver, 60);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		/*WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");*/
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		
		//fnSelectCostCenter(1,sCostCenterUI);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_cost_center_xp1,  "Input", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_cost_center_xp, "SET LIGHTING - CA",true);
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, "TEST", "Order Description");
		/*objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		*/
		//Thread.sleep(6000);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
	/*	//////////////////DBb Validation for order//////////////////
		String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		*/
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		/*if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
*/		sNewValue=DealNumberDB+"001";
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 

	 public  void fnTextOnMouseHover(String sColName,String sExceptionColXpath,String sActExceptionTextXpath,String sExpexctedText) 
		{
			
			try {
												
				WebElement Ele =TestDriver.driver.findElement(By.xpath(sExceptionColXpath));
				Actions builder = new Actions(TestDriver.driver);
				builder.moveToElement(Ele).build().perform();
				Thread.sleep(4000);
				String ActualText=TestDriver.driver.findElement(By.xpath(sActExceptionTextXpath)).getText().trim();;
				String ExpInvalidCostObjectText=sExpexctedText;
				objGenericFunctionLibrary.fnVerifyLabelMsgText(ExpInvalidCostObjectText,ActualText);
				Thread.sleep(6000);
			
			
			} catch (Exception e) {
				System.out.println("Error occurred"+ e.getMessage());
			} 
		}
	 
	 public  String fnCreateDealOrderforexception118(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		//String sPoNumberUI = "PO_"+sRandom;
		//String sPoNumberUI = sPoRandom;
		String sPoNumberUI = "501128";
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		List<WebElement> options = TestDriver.driver.findElements(By.xpath("//ul[@class='ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu ng-scope'and @position='down']//div[starts-with(@id,'ui-select-choices-')]"));
		System.out.println(options.size());
	    for(int i=0;i<=options.size();i++){
	    String optionName = options.get(i).getText();
	    System.out.println(optionName);
	    String DealNumUI = optionName.substring(0, 6);
	    System.out.println(DealNumUI);
	    if(DealNumUI.equals(DealNumberDB))
	    {

	   options.get(i).click();
	    break;
	    }
	    }
		
		//ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		/*objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");*/
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		
		fnSelectCostCenter(1,sCostCenterUI);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		String sapAccountNumber=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("SAP_Account_Number").trim();
	    String sapCostobject=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("SAP_Cost_Object").trim();  
	    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Transaction_sapaccountNumber, sapAccountNumber, "Sap Account Number");
	    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Transaction_sapcostObject, sapCostobject, "Sap Cost Object"); 

		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 
	 public String fnCreateDealOrderforexception10(String OrderStatus, String DealStatus)throws Exception

	 {

	 String sNewValue="";

	 try {

	 obj.repAddData( "Creating deal started", "", "", "");

	 String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));

	 System.out.println(sDealTitleUI);

	 String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;

	 sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);

	 TestDriver.conn = objDBUtility.fnOpenDBConnection();

	 TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);

	 HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);

	 String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();

	 obj.repAddData( "Creating Order started", "", "", "");

	 String UIorderNumber="001";

	 String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));

	 String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));

	 String sOrderDescUI = "AUTOTESTORDER_"+sRandom;

	 //String sPoNumberUI = "PO_"+sRandom;

	 //String sPoNumberUI = sPoRandom;

	 String sPoNumberUI = "78945";

	 String sTotalEstimateAmountUI=sRandom+".00";

	 String sEpisodeNumber="AutoEpNumber_"+sRandom;

	 String sRequestorName="AutoRequestorName_"+sRandom;

	 String sApproverName="AutoApproverName_"+sRandom;

	 String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();

	 
	 
	 
	 

	 WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);

	 sNewValue=DealNumberDB;

	 } catch (Exception e) {

	 System.out.println("ERROR: unable to read file " );

	 e.printStackTrace();

	 }

	 return sNewValue;

	 }

	 public static void fnReadReplaceTextFile10(String sDestFilePath,String sFieldName, String sNewValue)

	 {

	 //String file = FileLocSetter.sTestDataPath+"TEST.TXT";

	 try {

	 int iStartLoc = 0;

	 int iEndLoc = 0;

	 if(sFieldName.equalsIgnoreCase("Deal"))

	 {

	 iStartLoc = 20;

	 iEndLoc = 26;

	 }

	 if(sFieldName.equalsIgnoreCase("DealOrder"))

	 {

	 iStartLoc = 20;

	 iEndLoc = 26;

	 }

	 if(sFieldName.equalsIgnoreCase("DeptSysNum"))

	 {

	 /*iStartLoc = 2;

	 iEndLoc = 12;*/

	 iStartLoc = 3;

	 iEndLoc = 12;

	 }

	 if(sFieldName.equalsIgnoreCase("SLDeptSysNum"))

	 {

	 iStartLoc = 5;

	 iEndLoc = 12;

	 }
	 
	 if(sFieldName.equalsIgnoreCase("CostObject"))

	 {

	 iStartLoc = 243;

	 iEndLoc = 250;

	 }
	 BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sDestFilePath)));

	 String line;

	 BufferedWriter output = null;

	 // Uncomment the line below if you want to skip the fist line (e.g if headers)

	 // line = br.readLine();

	 String sFinalText = "";

	 // int length=br.readLine().lenght();

	 while ((line = br.readLine()) != null) {

	 System.out.println("ERROR: unable to read file " + line.length());

	 sFinalText = sFinalText+line+"\r\n";

	 //String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);

	 String sDeal = line.substring(iStartLoc, iEndLoc);

	 sFinalText = sFinalText.replaceAll(sDeal, sNewValue);

	 

	 }

	 output = new BufferedWriter(new FileWriter(sDestFilePath));

	 output.write(sFinalText);

	 output.close();

	 br.close();

	 } catch (Exception e) {

	 System.out.println("ERROR: unable to read file " + sDestFilePath);

	 e.printStackTrace();

	 }

	 }

	 public String fnCreateDealOrderforexception20(String OrderStatus, String DealStatus)throws Exception

	 {

	 String sNewValue="";

	 try {

	 obj.repAddData( "Creating deal started", "", "", "");

	 String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));

	 System.out.println(sDealTitleUI);

	 String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;

	 sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);

	 TestDriver.conn = objDBUtility.fnOpenDBConnection();

	 TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);

	 HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);

	 String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();

	 obj.repAddData( "Creating Order started", "", "", "");

	 String UIorderNumber="500";

	 String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));

	 String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));

	 String sOrderDescUI = "AUTOTESTORDER_"+sRandom;

	 //String sPoNumberUI = "PO_"+sRandom;

	 //String sPoNumberUI = sPoRandom;

	 String sPoNumberUI = "78945";

	 String sTotalEstimateAmountUI=sRandom+".00";

	 String sEpisodeNumber="AutoEpNumber_"+sRandom;

	 String sRequestorName="AutoRequestorName_"+sRandom;

	 String sApproverName="AutoApproverName_"+sRandom;

	 String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();

	 String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
	 String sPurposeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Purpose").trim();
	// String sPurposeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Purpose").trim();
	 //objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Add_Order_Purpose, "Testing notes" , "Search Box");
	 
	 
	 
		Thread.sleep(6000);

	 WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);

	 sNewValue=DealNumberDB;

	 } catch (Exception e) {

	 System.out.println("ERROR: unable to read file " );

	 e.printStackTrace();

	 }

	 return sNewValue;

	 }

	 	 
	 public String fnAddCustomer1(String sCustomerNameUI, String sOperation) throws Exception
		{
		
			try
			{
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));

	            String sCustomerTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
				System.out.println(sCustomerTitleRandom);
				

				sCustomerNameUI = "AUTOTESTCUSTOMER_"+sCustomerTitleRandom;
				
				String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
				if(!sOperation.equalsIgnoreCase("Duplicate"))
				{
				
					sCustomerNameUI = "AUTOTESTCUSTOMER_"+sCustomerTitleRandom;
				}
				
				String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
				String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
				
				//Date date = new Date();
				//String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
				
				Date dTomorrow = DateUtils.addDays(new Date(), +1);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");
				String sStartDateUI1 = sdf.format(dTomorrow);
				sdf.applyPattern("yyyy-MM-dd");
				String sStartDateUIDBpattern=sdf.format(dTomorrow);
			/*	Date dYesterday = DateUtils.addDays(new Date(), -1);
				SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
				String sStartDateUI2 = sdf.format(dYesterday);*/
				
				String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				//String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			
				fnClickSubMenuElement("Customers Master","Customers");
				objGenericFunctionLibrary.fnLoadingPageWait();
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
				Thread.sleep(4000);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
				TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, "2487678989", "Phone Number");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
				
				/////////////////Adding Customer Address Start//////////////////
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
				//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
			    
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
				
				String sCreditLimitUI=sRandom+".00";
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
				if(sOperation.equalsIgnoreCase("Cancel"))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
				}
				else
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					
				}
				
				 if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
				    {
				    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
				    	 int iRow = 1; //for add 
						    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
							TestDriver.conn = objDBUtility.fnOpenDBConnection();
							TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
							HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
							if(sOperation.equalsIgnoreCase("Duplicate"))
							{
								iRow = 1; //for duplicate, now checking descending, so no need to set it to 2
							}
							objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
							String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
							String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
							String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
							String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
							String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
							String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
							String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
							String sCreditExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
							
							String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
							
							String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
							String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
							String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
							String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
							String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
							String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
							String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
							String sMultEmailDB = mTableDataDB.get(iRow).get(17).toString().trim();
							String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(18).toString().trim();
							
							String sCustomerStatusDB = mTableDataDB.get(iRow).get(24).toString().trim();//isactive field in DB
							String sCustomerPhoneNumberDB = mTableDataDB.get(iRow).get(25).toString().trim();
							
							if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&                    
									sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) && 
									sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB)&&
									sStartDateUIDBpattern.equalsIgnoreCase(sStartDateDB) && 
									sCreditPermanentDB.equalsIgnoreCase("1") && 
									sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
									sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
								//sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB)
							{	
								//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
								TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sCountryDB+","+sZipDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
								//bw2.write("Test Case Id,Test Case Name,CustomerNumber,Name,CustomerStatus,Type,CustomerAddress1,CustomerAddress2,CustomerCity,CustomerState,CustomerZip,CustomerCountry,CustomerPhoneNo,CreditStatus,Through,Amount,DealNumber,Dealname,Dealtype,Address1,Address2,Status,City,State,Zip,Country,MainPhone,Status,CreditThrough,Certification,ValidThrough,TaxStatus,Department,PoNumber");
								//TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameUI+","+sCustomerStatusDB+","+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
								TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameDB+",,"+sCustomerStatusDB+","+sCustomerTypeDB+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
								obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
							}
							else
							{
								obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
							}
							
						if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && 
								sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
								//sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
								sCountryUI.equalsIgnoreCase(sCountryDB) && 
								sStateUI.equalsIgnoreCase(sStateDB) && 
								sCityUI.equalsIgnoreCase(sCityDB) && 
								sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
						{	
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
						}
						else
						{
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
						}
			    }
			    else if(sOperation.equalsIgnoreCase("Cancel"))
			    {
			    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
				    
				    TestDriver.conn = objDBUtility.fnOpenDBConnection();
				    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					int iTotalRows = 0;
					while(TestDriver.rset.next())
					{
						iTotalRows = iTotalRows+1;
					}
					
					System.out.println(String.valueOf(iTotalRows));
					if(iTotalRows==1)
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
					}
					else
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
					}
			    }
			   
			    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			
			} catch (Exception e) {
		   System.out.println("fnAddCustomer --------------Failed");    
		   TestDriver.log.error("fnAddCustomer failed",e);
		   }
			
			return sCustomerNameUI;
			
		}
	 
	 public String fnAddDealAccount11(int iCostCenter, String sCostCenterUI, String sCustomer) throws Exception
		
		{
			String sDealTitleUI ="";
			try
			{
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));

	            String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
				System.out.println(sDealTitleRandom);
				
				sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;
				//sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
				String sPoNumberUI = "AutoPONumber_"+sRandom;
				
				String sProjectName= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
				//String sCustomerUI="AUTOTESTDEALCUSTOMER";
				String sFirstName="AutoTestFirstName"+sRandom;
				String sLastName="AutoTestLastName"+sRandom;
				String sContactTitleUI="AutoTitle"+sRandom;
				String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
				String sphoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
				String sContactPhone ="248"+sphoneRandom;
				String sCustomerUI= sCustomer;
				String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
			    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
			    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
			  
			    Date date = new Date();
			    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
				Date dexpiredday = DateUtils.addDays(new Date(), +5);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
				String sEndDateUI2 = sdf.format(dexpiredday);
				
				fnClickMainMenuElement("Deals");
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
				Thread.sleep(10000); 

				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
				
				fnSelectCostCenter(iCostCenter,sCostCenterUI);
							
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
				
				/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
				
				//////////////////////////
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				
				//String sCountryUI = "United States of America (USA)";
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				/////////////////////////////
				*/
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
				
				
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
				
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
				/*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
				Thread.sleep(10000);*/
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle", "Title");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
				objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
				
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
				///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
				//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
			   /* try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
	   
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					
					if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
					}
					else
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					}
					
					//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					e.printStackTrace();
				}*/
		        
			/*	HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
				System.out.println("Hello");
				String sTempDealnumber= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText().trim();
				for(int i=1;i<=mTableDataUI.size(); i++)
				{
					String sDealNumberUI = mTableDataUI.get(i).get(2).toString();
					
					if(sDealNumberUI.equalsIgnoreCase(sTempDealnumber))
					{
						obj.repAddData( "Verify :" +sTempDealnumber,   " should  be displayed in table.", sTempDealnumber + " displayed in table.", "Pass");
						 System.out.println("success");
						 break;
					}
					
				}	
			*/
					
			   
				
				String sQuery = objSQLConfig.sDeals_AddDeal_Query;
			    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
				String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
				String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
				String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
			    
				String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
				String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
				String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
				String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
				String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
				String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
				String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
				String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
				String slot=mTableDataDB.get(1).get(12).toString().trim();
				String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
				String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
				String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
				String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
				String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
				String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
				String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
				String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
				
					//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
				
					if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
							sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
							sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
				
				
				
			} catch (Exception e) {
		   System.out.println("fnAddDealAccount --------------Failed");    
		   TestDriver.log.error("fnAddDealAccount failed",e);
		   }
			
			return sDealTitleUI;
	 
		} 
	 public static void fnReadReplacei81TextFile1(String sDestFilePath,String sFieldName, String sNewValue) 
		{
		 //String file = FileLocSetter.sTestDataPath+"TEST.TXT";

		 try {
			int iStartLoc = 0; 
			int iEndLoc = 0; 
			if(sFieldName.equalsIgnoreCase("Deal"))
			{
				iStartLoc = 20;
				iEndLoc = 26;
			}
			if(sFieldName.equalsIgnoreCase("DealOrder"))
			{
				iStartLoc = 65;
				iEndLoc = 74;
			}
			if(sFieldName.equalsIgnoreCase("DealOrder1"))
			{
				iStartLoc = 89;
				iEndLoc = 98;
			}
			if(sFieldName.equalsIgnoreCase("DeptSysNum"))
			{
				//11to21
				iStartLoc = 3;
				iEndLoc = 12;
			}
			 
		    BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(sDestFilePath)));
		    String line;
	        BufferedWriter output = null;
		    // Uncomment the line below if you want to skip the fist line (e.g if headers)
		    // line = br.readLine();
		    String sFinalText = "";
		    while ((line = br.readLine()) != null) {
		    	
		    	sFinalText = sFinalText+line+"\r\n";
	    		//String sDeal = line.split(" ")[0].substring(iStartLoc, iEndLoc);
		    	String sDeal = line.substring(iStartLoc, iEndLoc);
	    		sFinalText = sFinalText.replaceAll(sDeal, sNewValue);


		    }
	    	output = new BufferedWriter(new FileWriter(sDestFilePath));
	    	output.write(sFinalText);
	    	output.close();    
		    br.close();
		 
		 } catch (Exception e) {
		    System.out.println("ERROR: unable to read file " + sDestFilePath);
		    e.printStackTrace();  
		 }
	} 
	 
	 public  String fnCreateDealOrderforexception7(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		//String sPoNumberUI = "PO_"+sRandom;
		//String sPoNumberUI = sPoRandom;
		String sPoNumberUI = "501128";
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		List<WebElement> options = TestDriver.driver.findElements(By.xpath("//ul[@class='ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu ng-scope'and @position='down']//div[starts-with(@id,'ui-select-choices-')]"));
		System.out.println(options.size());
     for(int i=0;i<=options.size();i++){
     String optionName = options.get(i).getText();
     System.out.println(optionName);
     String DealNumUI = optionName.substring(0, 6);
     System.out.println(DealNumUI);
     if(DealNumUI.equals(DealNumberDB))
     {

    options.get(i).click();
     break;
     }
     }
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		/*objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");*/
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		String sCostCenterUI1 = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center1").trim();
		
		fnSelectCostCenter(1,sCostCenterUI1);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 
	 public  String fnCreateDealOrderforexceptionSap(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		//String sPoNumberUI = "PO_"+sRandom;
		//String sPoNumberUI = sPoRandom;
		String sPoNumberUI = "501128";
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		List<WebElement> options = TestDriver.driver.findElements(By.xpath("//ul[@class='ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu ng-scope'and @position='down']//div[starts-with(@id,'ui-select-choices-')]"));
		System.out.println(options.size());
     for(int i=0;i<=options.size();i++){
     String optionName = options.get(i).getText();
     System.out.println(optionName);
     String DealNumUI = optionName.substring(0, 6);
     System.out.println(DealNumUI);
     if(DealNumUI.equals(DealNumberDB))
     {

    options.get(i).click();
     break;
     }
     }
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		/*objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");*/
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		
		//fnSelectCostCenter(1,sCostCenterUI);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		String sapAccountNumber=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("SAP_Account_Number").trim();
	    String sapCostobject=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("SAP_Cost_Object").trim();  
	    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Transaction_sapaccountNumber, sapAccountNumber, "Sap Account Number");
	    objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Transaction_sapcostObject, sapCostobject, "Sap Cost Object"); 

		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		} 
	 
	 public static String fnnewArchiveFilei81DAT(String srcFilePath,String filename) throws Exception
     {
               String targetFileName=null;
                   Date date = new Date();
                    SimpleDateFormat sdf = new SimpleDateFormat("MMddyyyhhmmss");
                    String formattedDate = sdf.format(date);
                    System.out.println(formattedDate);
                    //File srcFile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC.TXT");
                  
                    File srcFile=new File(srcFilePath+filename);
                    String[] arrFileName1 = filename.toString().split("_");
                    String[] arrFileName = arrFileName1[1].toString().split("\\.");
                   
                    try {   
                         // File theDir = new File(FileLocSetter.sTestDataPath+"Arch");
                      File theDir = new File(FileLocSetter.sTestDataPath);
                          if(srcFile.exists())
                          {
                                if (!theDir.exists())
                                {
                                      System.out.println("creating directory: " + theDir);
                                      theDir.mkdirs();
                                }
                                else
                                {
                                    System.out.println("Arch folder already created");
                                }
                               
                                File fDest = new File(FileLocSetter.sTestDataPath+"Arch\\"+arrFileName1[0].toString().trim()+"."+arrFileName[1].toString().trim());
                              //  File fDest = new File(FileLocSetter.sTestDataPath+arrFileName[0].toString().trim()+"_"+formattedDate+"."+arrFileName[1].toString().trim());
                                System.out.println(fDest);
                                System.out.println(srcFile.toPath());
                               /* File copyfile=new File(FileLocSetter.sTestDataPath+"\\CHSLGRIP_0511_008_DC_Copy.TXT");
                                System.out.println(srcFile.getName());
                                Files.copy(srcFile.toPath(), copyfile.toPath(), StandardCopyOption.REPLACE_EXISTING);*/
                               
                              //  Files.copy(copyfile.toPath(),srcFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
                               
                                 Files.copy(srcFile.toPath(), fDest.toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);
                                 //copyfile.renameTo(srcFile);
                                 targetFileName=FileLocSetter.sTestDataPath+"Arch\\"+arrFileName1[0].toString().trim()+"."+arrFileName[1].toString().trim();
                                 targetFileName=fDest.getPath();
                               
                          }
                          else
                          {
                                System.out.println("File not found");
                          }
                          //fnReadtextfile();
                     
                  } catch (Exception e) {
                          System.out.println("Error occurred while making a copy of the source file with timestamp::: "+ e.getMessage());
                    }
                  
     return targetFileName;
         
     
   
     }
	 
	 public  String fnCreateDealOrderforexceptionMultiDepartment(String OrderStatus, String DealStatus)throws Exception 
		{
		 String sNewValue="";
		 try {
		
	    obj.repAddData( "Creating deal started", "", "", "");
		
		String sDealTitleUI =fnAddDealAccount(18, TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center"));
	
		System.out.println(sDealTitleUI);
		String sQuery1 = objSQLConfig.sDeals_AddressDeal_Query;
		sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
	    String DealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
	    
	    
	    obj.repAddData( "Creating Order started", "", "", "");
		String UIorderNumber="001";
		String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(1001, 9999));
		String sPoRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100001, 999999));
		String sOrderDescUI = "AUTOTESTORDER_"+sRandom;
		//String sPoNumberUI = "PO_"+sRandom;
		//String sPoNumberUI = sPoRandom;
		String sPoNumberUI = "501128";
		String sTotalEstimateAmountUI=sRandom+".00";
		String sEpisodeNumber="AutoEpNumber_"+sRandom;
		String sRequestorName="AutoRequestorName_"+sRandom;
		String sApproverName="AutoApproverName_"+sRandom;
	
		String sCostCenterUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center").trim();
		String sCostCenterUIOrder =TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Cost_Center_Order");
		String sLocationUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Location").trim();
		WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
		fnClickMainMenuElement("Dashboard");
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(SphereCommon.Main_HomeDashBoard_xp)));
		WebElement Titleele = TestDriver.driver.findElement(By.xpath(SphereCommon.Main_HomeDashBoard_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele);
		objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Dashboard_SearchBy_Deal_xp,"Deal");
		
		//SendKeyByXpath(SphereModules.Orders_DealNumber_SearchBox_xp,sExpDealNumberDB,"Deal Number");
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Dashboard_Deal_SearchBar_xp,DealNumberDB,"Deal Number");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(7000);
		List<WebElement> options = TestDriver.driver.findElements(By.xpath("//ul[@class='ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu ng-scope'and @position='down']//div[starts-with(@id,'ui-select-choices-')]"));
		System.out.println(options.size());
     for(int i=0;i<=options.size();i++){
     String optionName = options.get(i).getText();
     System.out.println(optionName);
     String DealNumUI = optionName.substring(0, 6);
     System.out.println(DealNumUI);
     if(DealNumUI.equals(DealNumberDB))
     {

    options.get(i).click();
     break;
     }
     }
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_SearchBar_FirstRow_xp, "FirstRow", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Dashboard_Deal_Search_Go_Btn_xp, "Go btn", true);
		waitForTableLoad.until(ExpectedConditions.elementToBeClickable(By.xpath(objSphereModules.Orders_Title_xp)));
		WebElement Titleele1 = TestDriver.driver.findElement(By.xpath(objSphereModules.Orders_Title_xp));
		objGenericFunctionLibrary.HighlightElement(Titleele1);					
		
		
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(objSphereModules.Common_Orders_Table_xp)));
	    
		WebElement eleTable = TestDriver.driver.findElement(By.xpath(objSphereModules.Common_Orders_Table_xp));
		List<WebElement> arrHeaderColumns = eleTable.findElements(By.xpath("../thead/tr/th"));  //Get the header
		System.out.println("Rows Size>>>>"+arrHeaderColumns.size());

		/*objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,1,"Order Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,2,"Order Mng CC");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,3,"Description");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,4,"PO Number");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,5,"Revenue");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,6,"Cost");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,7,"Margin");
		objGenericFunctionLibrary.fnVerifyHeaders(arrHeaderColumns,8,"Charge Method");*/
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Plus_Add_Sign_xp, "Add Order Link", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Order_AddOrder_LabelTitle_msg, SphereModules.Orders_Add_Form_Title_xp);
		
		//String sExpcostCenter ="338 SET LIGHTING - IL";
		
		fnSelectCostCenter(1,sCostCenterUIOrder);
		
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Order_Description_id, sOrderDescUI, "Order Description");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_TotalEstimateAmount_id, sTotalEstimateAmountUI, "Total Estimate Amount");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_POnumber_id, sPoNumberUI, "PO Number");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_Location_id, sLocationUI, "Location");
		objGenericFunctionLibrary.SendKeyById(SphereModules.Orders_Add_Form_EpisodeNumber_id, sEpisodeNumber, "Episode Number");
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//////////////////DBb Validation for order//////////////////
		/*String sQuery = objSQLConfig.sAdd_Orders_Query;
	    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);
	    sQuery = sQuery.replaceAll("order_number_param",UIorderNumber);
	    //use Deal Number here instead of DealTitle;
		TestDriver.conn = objDBUtility.fnOpenDBConnection();
		TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
		HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
		
		objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
		String sDealTitleDB = mTableDataDB.get(1).get(1).toString().trim();
		String sOrderNumberDB=mTableDataDB.get(1).get(2).toString().trim();
		String sOrderDescriptionDB=mTableDataDB.get(1).get(3).toString().trim();
		String iSbillableDB=mTableDataDB.get(1).get(4).toString().trim();
		String orderStatusDB=mTableDataDB.get(1).get(5).toString().trim();
		
		//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
		if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
				UIorderNumber.equalsIgnoreCase(sOrderNumberDB)&&
				sOrderDescUI.equalsIgnoreCase(sOrderDescriptionDB)&&
				iSbillableDB.equalsIgnoreCase("1")&&
				orderStatusDB.equalsIgnoreCase("Open"))
		{	
			
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation successful for deal title : "+ sDealTitleUI+" and Order Number : "+sOrderNumberDB, "Pass");
		}
		else
		{
			obj.repAddData( "Compare order  record for Deal Title : "+ sDealTitleUI, "Order account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI+" Order Number : "+sOrderNumberDB, "Fail");
	    
	    }*/
		
		//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Order_Screen_OrderNumber_SearchBar_xp,UIorderNumber,"Order Number");
		//objGenericFunctionLibrary.fnLoadingPageWait();
		
		
		if(OrderStatus.equalsIgnoreCase("Closed Order"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		}
		if(OrderStatus.equalsIgnoreCase("CloseOpenOrder"))
		{
			
			
		String OrderTablexpath=SphereModules.Order_Screen_Table_xp;
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_ClosedBtnStatus_xp, "Closed", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_Orderclose_xp, "Close Button", true);
		//objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OrderexitYes_xp, "Yes Button", true);
		//button[@class='btn btn-small confirm ng-scope' and @translate='FORM_EXIT_YES_BUTTON']
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Order_Table_Col4_xp,"Order Number",true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		
		objGenericFunctionLibrary.ClickById(SphereModules.Orders_Edit_Order_BtnStatus_id, "Order", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Edit_Order_OpenBtnStatus_xp, "Open", true);
		
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Orders_Add_Form_Save_Btn_xp, "Save Button", true);
		objGenericFunctionLibrary.fnCloseOpenedForm();
		Thread.sleep(6000);
		}
		if(DealStatus.equalsIgnoreCase("Closed Deal"))
		{
	    fnClickMainMenuElement("Deals");
		waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
		Thread.sleep(10000); 
	    objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true);
		Thread.sleep(4000);
		objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Common_ViewModules_InputSearchBox_xp, DealNumberDB , "Search Box");
		objGenericFunctionLibrary.fnLoadingPageWait();
		Thread.sleep(4000);
		//waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_ClickFirstRow_xp)));
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_ClickFirstRow_xp, "First Deal Row", true);
		objGenericFunctionLibrary.fnLoadingPageWait();
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDealBtnStatusClosed_xp, "Closed Status", true);
		objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_EditDeal_BtnSave_xp, "Save Button", true);
		}	    
		sNewValue=DealNumberDB+UIorderNumber;
		
		
		 } catch (Exception e) {
			    System.out.println("ERROR: unable to read file " );
			    e.printStackTrace();  
			 }

		 return sNewValue;
		}
	 
	 
	 public String fnAddCustomerName(String sCustomerNameUI, String sOperation) throws Exception
		{
		
			try
			{
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 99999));

	            String sCustomerTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
				System.out.println(sCustomerTitleRandom);
				

				sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
				
				String sTaxIdUI = String.valueOf(objGenericFunctionLibrary.fnRandomNum(100000001, 999999999));
				if(!sOperation.equalsIgnoreCase("Duplicate"))
				{
				
					sCustomerNameUI = "AUTOTESTCUSTOMER_"+sRandom;
				}
				
				String sCustomerTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Customer_Type").trim();
				String sProductionTypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Production_Type").trim();
				
				//Date date = new Date();
				//String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);
				
				Date dTomorrow = DateUtils.addDays(new Date(), +1);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");
				String sStartDateUI1 = sdf.format(dTomorrow);
				sdf.applyPattern("yyyy-MM-dd");
				String sStartDateUIDBpattern=sdf.format(dTomorrow);
			/*	Date dYesterday = DateUtils.addDays(new Date(), -1);
				SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
				String sStartDateUI2 = sdf.format(dYesterday);*/
				
				String sParentCompanyUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Parent_Company").trim();
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				//String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
			
				fnClickSubMenuElement("Customers Master","Customers");
				objGenericFunctionLibrary.fnLoadingPageWait();
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 60);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewCustomersModule_Table_xp)));
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewModules_LinkAll_xp)));
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Common_ViewModules_LinkAll_xp, "All Link", true); //pre-condition
				Thread.sleep(4000);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_LinkAddPlusSign_xp, "Add Customer Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.CustomersMaster_AddCustomer_LabelTitle_msg, SphereModules.CustomersMaster_AddCustomer_LabelAddCustomerTitle_xp);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputName_id, sCustomerNameUI, "Name");
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboCustomerType_id,sCustomerTypeUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputTaxId_id, sTaxIdUI, "Tax Id");
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Customers_EditNationalAccount_ComboProductionType_id,sProductionTypeUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboParentCompany_id,sParentCompanyUI);
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id, "Production Start Date", true);
				TestDriver.driver.findElement(By.id(SphereModules.CustomersMaster_AddCustomer_InputStartDate_id)).sendKeys(sStartDateUI1);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.CustomersMaster_AddCustomer_InputPhoneNumber_xp, "2487678989", "Phone Number");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputEmail_id, "AutoTestEmail"+sRandom+"@nbcuni.com", "Email");
				
				/////////////////Adding Customer Address Start//////////////////
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine1_id, sAddr1UI, "Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine2_id, sAddr2UI, "Address Line 2");
				//objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputAddressLine3_id, sAddr3UI, "Address Line 3");
			    
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddCustomer_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCity_id, sCityUI, "City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputZip_id, sZipUI, "Zip");
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_CheckBoxSupportMultipleAddresses_xp, "Support Multiple Address Checkbox", true);
				
				String sCreditLimitUI=sRandom+".00";
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddCustomer_InputCreditLimit_id, sRandom, "Credit Limit");
				objGenericFunctionLibrary.ClickById(SphereModules.CustomersMaster_AddCustomer_RadioPermCustomerYes_id, "Yes radio button", true);
				if(sOperation.equalsIgnoreCase("Cancel"))
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnCancel_xp, "Cancel Button", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
				}
				else
				{
					objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddCustomer_BtnAdd_xp, "Add Button", true);
					objGenericFunctionLibrary.fnLoadingPageWait();
					
				}
				
				 if(sOperation.equalsIgnoreCase("Add") || sOperation.equalsIgnoreCase("Duplicate") )
				    {
				    	 String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
				    	 int iRow = 1; //for add 
						    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
							TestDriver.conn = objDBUtility.fnOpenDBConnection();
							TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
							HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
							if(sOperation.equalsIgnoreCase("Duplicate"))
							{
								iRow = 1; //for duplicate, now checking descending, so no need to set it to 2
							}
							objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
							String sCustomerNameDB = mTableDataDB.get(iRow).get(1).toString().trim();
							String sCustomerTypeDB = mTableDataDB.get(iRow).get(2).toString().trim();
							String sTaxIDDB = mTableDataDB.get(iRow).get(3).toString().trim();
							String sProductionTypeDB = mTableDataDB.get(iRow).get(4).toString().trim();
							String sStartDateDB = mTableDataDB.get(iRow).get(5).toString().trim();
							String sCreditLimitDB = mTableDataDB.get(iRow).get(6).toString().trim();
							String sCreditPermanentDB = mTableDataDB.get(iRow).get(7).toString().trim();
							String sCreditExpirationDB = mTableDataDB.get(iRow).get(8).toString().trim();
							
							String sParentCompanyDB = mTableDataDB.get(iRow).get(9).toString().trim();
							
							String sAddr1DB = mTableDataDB.get(iRow).get(10).toString().trim();
							String sAddr2DB = mTableDataDB.get(iRow).get(11).toString().trim();
							String sAddr3DB = mTableDataDB.get(iRow).get(12).toString().trim();
							String sCountryDB = mTableDataDB.get(iRow).get(13).toString().trim();
							String sStateDB = mTableDataDB.get(iRow).get(14).toString().trim();
							String sCityDB = mTableDataDB.get(iRow).get(15).toString().trim();
							String sZipDB = mTableDataDB.get(iRow).get(16).toString().trim();
							String sMultEmailDB = mTableDataDB.get(iRow).get(17).toString().trim();
							String sOrbitCustNumberDB = mTableDataDB.get(iRow).get(18).toString().trim();
							
							String sCustomerStatusDB = mTableDataDB.get(iRow).get(24).toString().trim();//isactive field in DB
							String sCustomerPhoneNumberDB = mTableDataDB.get(iRow).get(25).toString().trim();
							
							if(sCustomerNameUI.equalsIgnoreCase(sCustomerNameDB) &&                    
									sCustomerTypeUI.equalsIgnoreCase(sCustomerTypeDB) && 
									sProductionTypeUI.equalsIgnoreCase(sProductionTypeDB)&&
									sStartDateUIDBpattern.equalsIgnoreCase(sStartDateDB) && 
									sCreditPermanentDB.equalsIgnoreCase("1") && 
									sTaxIdUI.equalsIgnoreCase(sTaxIDDB) && 
									sParentCompanyUI.equalsIgnoreCase(sParentCompanyDB))
								//sCreditLimitUI.equalsIgnoreCase(sCreditLimitDB)
							{	
								//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI);
								TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sCustomerNameUI+","+sOrbitCustNumberDB+",Create,Customer,"+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sCountryDB+","+sZipDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
								//bw2.write("Test Case Id,Test Case Name,CustomerNumber,Name,CustomerStatus,Type,CustomerAddress1,CustomerAddress2,CustomerCity,CustomerState,CustomerZip,CustomerCountry,CustomerPhoneNo,CreditStatus,Through,Amount,DealNumber,Dealname,Dealtype,Address1,Address2,Status,City,State,Zip,Country,MainPhone,Status,CreditThrough,Certification,ValidThrough,TaxStatus,Department,PoNumber");
								//TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameUI+","+sCustomerStatusDB+","+sCustomerTypeUI+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
								TestDriver.bw2.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+","+sOrbitCustNumberDB+","+sCustomerNameDB+",,"+sCustomerStatusDB+","+sCustomerTypeDB+","+sAddr1DB+","+sAddr2DB+","+sCityDB+","+sStateDB+","+sZipDB+","+sCountryDB+","+sCustomerPhoneNumberDB+","+sCreditPermanentDB+","+sCreditExpirationDB+","+sCreditLimitDB);
								obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation successful for customer name : "+ sCustomerNameUI, "Pass");
							}
							else
							{
								obj.repAddData( "Compare customer record for customer name : "+ sCustomerNameUI, "Customer record on UI and DB should match for customer name : "+ sCustomerNameUI, "Validation failed for customer name : "+ sCustomerNameUI, "Fail");
							}
							
						if(sAddr1UI.equalsIgnoreCase(sAddr1DB) && 
								sAddr2UI.equalsIgnoreCase(sAddr2DB) && 
								//sAddr3UI.equalsIgnoreCase(sAddr3DB) && 
								sCountryUI.equalsIgnoreCase(sCountryDB) && 
								sStateUI.equalsIgnoreCase(sStateDB) && 
								sCityUI.equalsIgnoreCase(sCityDB) && 
								sZipUI.equalsIgnoreCase(sZipDB)) // && sMultEmailDB.equalsIgnoreCase("1"))
						{	
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address validation successful for customer name : "+ sCustomerNameUI, "Pass");
						}
						else
						{
							obj.repAddData( "Verify customer address for customer name : "+ sCustomerNameUI, "Customer address on UI and DB should match for customer name : "+ sCustomerNameUI, "Address Validation failed for customer name : "+ sCustomerNameUI, "Fail");
						}
			    }
			    else if(sOperation.equalsIgnoreCase("Cancel"))
			    {
			    	String sQuery = objSQLConfig.sMasterCustomers_AddCustomer_Query;
				    sQuery = sQuery.replaceAll("customer_name_param",sCustomerNameUI);
				    
				    TestDriver.conn = objDBUtility.fnOpenDBConnection();
				    TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
					int iTotalRows = 0;
					while(TestDriver.rset.next())
					{
						iTotalRows = iTotalRows+1;
					}
					
					System.out.println(String.valueOf(iTotalRows));
					if(iTotalRows==1)
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record added for customer name : "+ sCustomerNameUI, "Fail"); 
					}
					else
					{
						obj.repAddData( "Verify record for customer name : "+ sCustomerNameUI, "Record should not be added for customer name : "+ sCustomerNameUI, "Record not added for customer name : "+ sCustomerNameUI, "Pass");
					}
			    }
			   
			    objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
			
			} catch (Exception e) {
		   System.out.println("fnAddCustomer --------------Failed");    
		   TestDriver.log.error("fnAddCustomer failed",e);
		   }
			
			return sCustomerNameUI;
			
		}
	 
	 
	 
	 public String fnVerifyNonStudioPostCostCenterHubNewCustomer_280(String sExpDealNumberDB) throws Exception
		{
			
			try
			{
				String sQuery2 = objSQLConfig.sDeals_Studio_PostHub_Deal;
				sQuery2 = sQuery2.replaceAll("deal_num_param",sExpDealNumberDB);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String hub_integration_data_id=mTableDataDB2.get(1).get(1).toString().trim();
			    String hub_integration_history_id=mTableDataDB2.get(1).get(2).toString().trim();
			    String url=mTableDataDB2.get(1).get(3).toString().trim();
			    String request_headers=mTableDataDB2.get(1).get(4).toString().trim();
			    String request_data=mTableDataDB2.get(1).get(5).toString().trim();
			    String response_headers=mTableDataDB2.get(1).get(6).toString().trim();
			    String response_data=mTableDataDB2.get(1).get(7).toString().trim();
			    String http_status=mTableDataDB2.get(1).get(8).toString().trim();
			    String messages=mTableDataDB2.get(1).get(9).toString().trim();
			   
			   
			
			    if(http_status.equalsIgnoreCase("200"))
			    {
			    	obj.repAddData( "Verify  http_status", 
						"http_status Should be displayed as '200' '' ",
						"http_status is displayed as "+http_status+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  http_status", 
						"http_status is displayed as'' ",
						"http_status is displayed as "+http_status+"", "Fail");
			    
			    	obj.repAddData( "Verify  hub_integration_data_id", 
	 						"hub_integration_data_id Should be displayed as follows''",
	 						"hub_integration_data_id is displayed as "+hub_integration_data_id+"", "Fail");	
			    	

			    	obj.repAddData( "Verify  hub_integration_history_id", 
	 						"hub_integration_history_id is displayed as follows ''",
	 						"hub_integration_history_id is displayed as "+hub_integration_history_id+"", "Fail");
			    	
			    	obj.repAddData( "Verify  url", 
	 						"url is displayed as "+url+"",
	 						"", "Fail");
			    	
			    	obj.repAddData( "Verify  request_headers", 
	 						"request_headers is displayed as follows ''",
	 						"request_headers is displayed as "+request_headers+"", "Fail");
			    	
			    	obj.repAddData( "Verify  request_data", 
	 						"request_data is displayed as follows ''",
	 						"request_data is displayed as "+request_data+"", "Fail");
			    	
			    	obj.repAddData( "Verify  response_headers", 
	 						"response_headers Should be displayed as Blank ''",
	 						"response_headers is displayed as "+response_headers+"", "Fail");
			    	
			    	obj.repAddData( "Verify  response_data", 
	 						"response_data is displayed as follows ''",
	 						"response_data is displayed as "+response_data+"", "Fail");
			    	
			    	obj.repAddData( "Verify  messages", 
	 						"messages is displayed as follows ''",
	 						"messages is displayed as "+messages+"", "Fail");
			    	 }
			    
			 
				
			} catch (Exception e) {
				
		   System.out.println("fnVerifyDealExportData --------------Failed");    
		   TestDriver.log.error("fnVerifyDealExportData failed",e);
		   }
		//	String sExpDealNumberDB = null;
			return sExpDealNumberDB;
			
		}
	 
	 public String fnVerifyNonStudioPostCostCenterHub(String sExpDealNumberDB) throws Exception
		{
			
			try
			{
				String sQuery2 = objSQLConfig.sDeals_Studio_PostHub_Deal;
				sQuery2 = sQuery2.replaceAll("deal_num_param",sExpDealNumberDB);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String hub_integration_data_id=mTableDataDB2.get(1).get(1).toString().trim();
			    String hub_integration_history_id=mTableDataDB2.get(1).get(2).toString().trim();
			    String url=mTableDataDB2.get(1).get(3).toString().trim();
			    String request_headers=mTableDataDB2.get(1).get(4).toString().trim();
			    String request_data=mTableDataDB2.get(1).get(5).toString().trim();
			    String response_headers=mTableDataDB2.get(1).get(6).toString().trim();
			    String response_data=mTableDataDB2.get(1).get(7).toString().trim();
			    String http_status=mTableDataDB2.get(1).get(8).toString().trim();
			    String messages=mTableDataDB2.get(1).get(9).toString().trim();
			   
			   
			
			    if(http_status.equalsIgnoreCase(""))
			    {
			    	obj.repAddData( "Verify  http_status", 
						"http_status Should be displayed as Blank '' ",
						"http_status is displayed as "+http_status+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  http_status", 
						"http_status Should be displayed as Blank '' ",
						"http_status is displayed as "+http_status+"", "Fail");
			    
			    	obj.repAddData( "Verify  hub_integration_data_id", 
	 						"hub_integration_data_id Should be displayed as Blank ''",
	 						"hub_integration_data_id is displayed as "+hub_integration_data_id+"", "Fail");	
			    	

			    	obj.repAddData( "Verify  hub_integration_history_id", 
	 						"hub_integration_history_id Should be displayed as Blank ''",
	 						"hub_integration_history_id is displayed as "+hub_integration_history_id+"", "Fail");
			    	
			    	obj.repAddData( "Verify  url", 
	 						"url is displayed as "+url+"",
	 						"", "Fail");
			    	
			    	obj.repAddData( "Verify  request_headers", 
	 						"request_headers Should be displayed as Blank ''",
	 						"request_headers is displayed as "+request_headers+"", "Fail");
			    	
			    	obj.repAddData( "Verify  request_data", 
	 						"request_data Should be displayed as Blank ''",
	 						"request_data is displayed as "+request_data+"", "Fail");
			    	
			    	obj.repAddData( "Verify  response_headers", 
	 						"response_headers Should be displayed as Blank ''",
	 						"response_headers is displayed as "+response_headers+"", "Fail");
			    	
			    	obj.repAddData( "Verify  response_data", 
	 						"response_data Should be displayed as Blank ''",
	 						"response_data is displayed as "+response_data+"", "Fail");
			    	
			    	obj.repAddData( "Verify  messages", 
	 						"messages Should be displayed as Blank ''",
	 						"messages is displayed as "+messages+"", "Fail");
			    	 }
			    
			 
				
			} catch (Exception e) {
				
		   System.out.println("fnVerifyDealExportData --------------Failed");    
		   TestDriver.log.error("fnVerifyDealExportData failed",e);
		   }
		//	String sExpDealNumberDB = null;
			return sExpDealNumberDB;
			
		}
	 
	 public String fnVerify265CostCenterHub(String sDealTitleUI,String sCustomer,String CustomerNumber) throws Exception
		{
			
			try
			{
				String sCostCenterid="57";
				String sQuery1 = objSQLConfig.sDeals_AddDeal_Query;
				sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
				String sExpDealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
				
				   String sQuery3 = objSQLConfig.sDeals_AddDeal_Query1;
				   sQuery3 = sQuery3.replaceAll("dealNum_param",sExpDealNumberDB);
				   TestDriver.conn = objDBUtility.fnOpenDBConnection();
				   TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
				   HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
				   objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				   String sExpDealidDB=mTableDataDB3.get(1).get(1).toString().trim();
				       
				
				String sQuery2 = objSQLConfig.sDeals_Studio_Post;
				sQuery2 = sQuery2.replaceAll("deal_num_param",sExpDealNumberDB);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String sExpDealNumberDB2=mTableDataDB2.get(2).get(1).toString().trim();
			    String CustomerName=mTableDataDB2.get(2).get(2).toString().trim();
			    String DealTitle=mTableDataDB2.get(2).get(3).toString().trim();
			    String Dealid=mTableDataDB2.get(2).get(4).toString().trim();
			    String CustomerId=mTableDataDB2.get(2).get(5).toString().trim();
			    String CostCenterid=mTableDataDB2.get(2).get(6).toString().trim();
			    String IntegrationType=mTableDataDB2.get(2).get(7).toString().trim();
			    String SystemName=mTableDataDB2.get(2).get(8).toString().trim();
			    String Status=mTableDataDB2.get(2).get(9).toString().trim();
			    //deal number verification
			    if(sExpDealNumberDB2.equalsIgnoreCase(sExpDealNumberDB))
			    {
			    	obj.repAddData( "Verify  Deal Number", 
 						"Deal Number Should be displayed as "+sExpDealNumberDB+" ",
 						"Deal Number is displayed as "+sExpDealNumberDB2+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Deal Number", 
 						"Deal Number Should be displayed as "+sExpDealNumberDB+" ",
 						"Deal Number is displayed as "+sExpDealNumberDB2+"", "Fail");
			    }
			    
			    //customer verification
			    if(CustomerName.equalsIgnoreCase(sCustomer))
			    {
			    	obj.repAddData( "Verify  CustomerName", 
 						"CustomerName Should be displayed as "+sCustomer+" ",
 						"CustomerName is displayed as "+CustomerName+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  CustomerName", 
 						"CustomerName Should be displayed as "+sCustomer+" ",
 						"CustomerName is displayed as "+CustomerName+"", "Fail");
			    }
			    
			    
			    //deal title
			    if(DealTitle.equalsIgnoreCase(sDealTitleUI))
			    {
			    	obj.repAddData( "Verify  DealTitle", 
 						"DealTitle Should be displayed as "+sDealTitleUI+" ",
 						"DealTitle is displayed as "+DealTitle+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  DealTitle", 
 						"DealTitle Should be displayed as "+sDealTitleUI+" ",
 						"DealTitle is displayed as "+DealTitle+"", "Fail");
			    }
			    
			    
			    
			    
			    if(Dealid.equalsIgnoreCase(sExpDealidDB))
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"Dealid Should be displayed as "+sExpDealidDB+" ",
 						"Dealid is displayed as "+Dealid+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"Dealid Should be displayed as "+sExpDealidDB+" ",
 						"Dealid is displayed as "+Dealid+"", "Fail");
			    }
			    
			    
			    String sQuery4 = objSQLConfig.sDeals_customer_id;
				   sQuery4 = sQuery4.replaceAll("customer_num_param",CustomerNumber);
				   TestDriver.conn = objDBUtility.fnOpenDBConnection();
				   TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery4);
				   HashMap<Integer, HashMap<Integer, String>> mTableDataDB5 = objDBUtility.fnWriteResultSet(TestDriver.rset);
				   objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				   String sCustomerId=mTableDataDB5.get(1).get(1).toString().trim();
			   
				   if(CustomerId.equalsIgnoreCase(sCustomerId))
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"CustomerId Should be displayed as "+sCustomerId+" ",
 						"CustomerId is displayed as "+CustomerId+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"CustomerId Should be displayed as "+sCustomerId+" ",
 						"CustomerId is displayed as "+CustomerId+"", "Fail");
			    }
			    
			    if(CostCenterid.equalsIgnoreCase(sCostCenterid))
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"CostCenterid Should be displayed as "+sCostCenterid+" ",
 						"CostCenterid is displayed as "+CostCenterid+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"CostCenterid Should be displayed as "+sCostCenterid+" ",
 						"CostCenterid is displayed as "+CostCenterid+"", "Fail");
			    }
			    
			    String sIntegrationType="create";
			    if(IntegrationType.equalsIgnoreCase(sIntegrationType))
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"IntegrationType Should be displayed as "+sIntegrationType+" ",
 						"IntegrationType is displayed as "+IntegrationType+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"IntegrationType Should be displayed as "+sIntegrationType+" ",
 						"IntegrationType is displayed as "+IntegrationType+"", "Fail");
			    }
			    
			   if(SystemName.equalsIgnoreCase("ScheduallStudioPost"))
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"SystemName Should be displayed as 'ScheduallStudioPost' ",
 						"SystemName is displayed as "+SystemName+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"SystemName Should be displayed as 'ScheduallStudioPost' ",
 						"SystemName is displayed as "+SystemName+"", "Fail");
			    }
			    
			    
			    if(Status.equalsIgnoreCase("FAILURE"))
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"Status Should be displayed as "+"FAILURE"+" ",
 						"Status is displayed as "+Status+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
 						"Status Should be displayed as "+"FAILURE"+" ",
 						"Status is displayed as "+Status+"", "Fail");
			    }
			    
				
			} catch (Exception e) {
				
		   System.out.println("fnVerifyDealExportData --------------Failed");    
		   TestDriver.log.error("fnVerifyDealExportData failed",e);
		   }
			String sExpDealNumberDB = null;
			return sExpDealNumberDB;
			
		}
	 
	 public String fnVerifyCostCenterHub(String sDealTitleUI,String sCustomer,String CustomerNumber) throws Exception
		{
			
			try
			{
				//String sCostCenterid="57";
				String sCostCenterid= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("CostCenterid").trim();
				
				String sQuery1 = objSQLConfig.sDeals_AddDeal_Query;
				sQuery1 = sQuery1.replaceAll("deal_title_param",sDealTitleUI);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB1 = objDBUtility.fnWriteResultSet(TestDriver.rset);
				String sExpDealNumberDB=mTableDataDB1.get(1).get(1).toString().trim();
				String ponumberDB=mTableDataDB1.get(1).get(5).toString().trim();
				
				   String sQuery3 = objSQLConfig.sDeals_AddDeal_Query1;
				   sQuery3 = sQuery3.replaceAll("dealNum_param",sExpDealNumberDB);
				   TestDriver.conn = objDBUtility.fnOpenDBConnection();
				   TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery3);
				   HashMap<Integer, HashMap<Integer, String>> mTableDataDB3 = objDBUtility.fnWriteResultSet(TestDriver.rset);
				   objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				   String sExpDealidDB=mTableDataDB3.get(1).get(1).toString().trim();
				       
				
				String sQuery2 = objSQLConfig.sDeals_Studio_Post;
				sQuery2 = sQuery2.replaceAll("deal_num_param",sExpDealNumberDB);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String sExpDealNumberDB2=mTableDataDB2.get(2).get(1).toString().trim();
			    String CustomerName=mTableDataDB2.get(2).get(2).toString().trim();
			    String DealTitle=mTableDataDB2.get(2).get(3).toString().trim();
			    String Dealid=mTableDataDB2.get(2).get(4).toString().trim();
			    String CustomerId=mTableDataDB2.get(2).get(5).toString().trim();
			    String CostCenterid=mTableDataDB2.get(2).get(6).toString().trim();
			    String IntegrationType=mTableDataDB2.get(2).get(7).toString().trim();
			    String SystemName=mTableDataDB2.get(2).get(8).toString().trim();
			    String Status=mTableDataDB2.get(2).get(9).toString().trim();
			    //deal number verification
			    if(sExpDealNumberDB2.equalsIgnoreCase(sExpDealNumberDB))
			    {
			    	obj.repAddData( "Verify  Deal Number", 
						"Deal Number Should be displayed as "+sExpDealNumberDB+" ",
						"Deal Number is displayed as "+sExpDealNumberDB2+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Deal Number", 
						"Deal Number Should be displayed as "+sExpDealNumberDB+" ",
						"Deal Number is displayed as "+sExpDealNumberDB2+"", "Fail");
			    }
			    
			    //customer verification
			    if(CustomerName.equalsIgnoreCase(sCustomer))
			    {
			    	obj.repAddData( "Verify  CustomerName", 
						"CustomerName Should be displayed as "+sCustomer+" ",
						"CustomerName is displayed as "+CustomerName+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  CustomerName", 
						"CustomerName Should be displayed as "+sCustomer+" ",
						"CustomerName is displayed as "+CustomerName+"", "Fail");
			    }
			    
			    
			    //deal title
			    if(DealTitle.equalsIgnoreCase(sDealTitleUI))
			    {
			    	obj.repAddData( "Verify  DealTitle", 
						"DealTitle Should be displayed as "+sDealTitleUI+" ",
						"DealTitle is displayed as "+DealTitle+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  DealTitle", 
						"DealTitle Should be displayed as "+sDealTitleUI+" ",
						"DealTitle is displayed as "+DealTitle+"", "Fail");
			    }
			    
			    
			    
			    
			    if(Dealid.equalsIgnoreCase(sExpDealidDB))
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"Dealid Should be displayed as "+sExpDealidDB+" ",
						"Dealid is displayed as "+Dealid+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"Dealid Should be displayed as "+sExpDealidDB+" ",
						"Dealid is displayed as "+Dealid+"", "Fail");
			    }
			    
			    
			    String sQuery4 = objSQLConfig.sDeals_customer_id;
				   sQuery4 = sQuery4.replaceAll("customer_num_param",CustomerNumber);
				   TestDriver.conn = objDBUtility.fnOpenDBConnection();
				   TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery4);
				   HashMap<Integer, HashMap<Integer, String>> mTableDataDB5 = objDBUtility.fnWriteResultSet(TestDriver.rset);
				   objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				   String sCustomerId=mTableDataDB5.get(1).get(1).toString().trim();
			   
				   if(CustomerId.equalsIgnoreCase(sCustomerId))
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"CustomerId Should be displayed as "+sCustomerId+" ",
						"CustomerId is displayed as "+CustomerId+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"CustomerId Should be displayed as "+sCustomerId+" ",
						"CustomerId is displayed as "+CustomerId+"", "Fail");
			    }
			    
			    if(CostCenterid.equalsIgnoreCase(sCostCenterid))
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"CostCenterid Should be displayed as "+sCostCenterid+" ",
						"CostCenterid is displayed as "+CostCenterid+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"CostCenterid Should be displayed as "+sCostCenterid+" ",
						"CostCenterid is displayed as "+CostCenterid+"", "Fail");
			    }
			    
			    String sIntegrationType="create";
			    if(IntegrationType.equalsIgnoreCase(sIntegrationType))
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"IntegrationType Should be displayed as "+sIntegrationType+" ",
						"IntegrationType is displayed as "+IntegrationType+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"IntegrationType Should be displayed as "+sIntegrationType+" ",
						"IntegrationType is displayed as "+IntegrationType+"", "Fail");
			    }
			    
			   if(SystemName.equalsIgnoreCase("ScheduallStudioPost"))
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"SystemName Should be displayed as 'ScheduallStudioPost' ",
						"SystemName is displayed as "+SystemName+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"SystemName Should be displayed as 'ScheduallStudioPost' ",
						"SystemName is displayed as "+SystemName+"", "Fail");
			    }
			    
			    
			    if(Status.equalsIgnoreCase("FAILURE"))
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"Status Should be displayed as "+"FAILURE"+" ",
						"Status is displayed as "+Status+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  Dealid", 
						"Status Should be displayed as "+"FAILURE"+" ",
						"Status is displayed as "+Status+"", "Fail");
			    }
			    
				
			} catch (Exception e) {
				
		   System.out.println("fnVerifyDealExportData --------------Failed");    
		   TestDriver.log.error("fnVerifyDealExportData failed",e);
		   }
			String sExpDealNumberDB = null;
			return sExpDealNumberDB;
			
		}
	 public String fnAddDealAccount265(int iCostCenter, String sCostCenterUI) throws Exception
		
		{
			String sDealTitleUI ="";
			try
			{
				
				String sRandom = String.valueOf(objGenericFunctionLibrary.fnRandomNum(10001, 14999));

	            String sDealTitleRandom = String.valueOf(new SimpleDateFormat("ddMMYYHHmmss").format(new Date()));
				System.out.println(sDealTitleRandom);
				
				sDealTitleUI = "AUTOTESTDEAL_"+sDealTitleRandom;
				//sDealTitleUI = "AUTOTESTDEAL_"+sRandom;
				String sPoNumberUI = "AutoPONumber_"+sRandom;
				
				String sProjectName= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Project").trim();
				//String sCustomerUI="AUTOTESTDEALCUSTOMER";
				String sFirstName="AutoTestFirstName"+sRandom;
				String sLastName="AutoTestLastName"+sRandom;
				String sContactTitleUI="AutoTitle"+sRandom;
				String sEmailAddressUI="AutoTestEmail"+"sRandom+@nbcuni.com";
				String sphoneRandom= String.valueOf(objGenericFunctionLibrary.fnRandomNum(2222222, 9999999));
				String sContactPhone ="248"+sphoneRandom;
				String sCustomerUI= TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Customer").trim();
				String sDeal_TypeUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Deal_Type").trim();
			    String sInvoiceFormatUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Invoice_Format").trim();
			    String sBillingScheduleUI=TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Billing_Schedule").trim();
			    String sCustomer_CodeID="PAYTV";
			    Date date = new Date();
			    String sStartDateUI1= new SimpleDateFormat("MM/dd/yyyy").format(date);//not using SimpleDateFormat
				Date dexpiredday = DateUtils.addDays(new Date(), +5);
				SimpleDateFormat sdf = new SimpleDateFormat("MM/dd/yyyy");//changed format due to error
				String sEndDateUI2 = sdf.format(dexpiredday);
				
				fnClickMainMenuElement("Deals");
				WebDriverWait waitForTableLoad = new WebDriverWait(TestDriver.driver, 80);
				waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Common_ViewDealModule_Table_xp)));
				Thread.sleep(10000); 

				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_LinkAddPlusSign_xp, "Add Deal Link", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.fnVerifyLabelMsgTextByXpath(AppMessages.Deals_AddDeal_LabelTitle_Msg, SphereModules.Deals_AddDeal_LabelAddDealTitle_xp);
				
				fnSelectCostCenter(iCostCenter,sCostCenterUI);
							
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchCustomers_xp,sCustomerUI, "Search customer");
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_CustomerListSearch_xp, "First customer Row", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAddress_id, "Customer Address Radio Button", true);
				
				/*objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_RadioCustomerAlternateAddress_id, "Alternate Address Radio Button", true);
				
				//////////////////////////
				String sAddr1UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address1").trim();
				String sAddr2UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address2").trim();
				String sAddr3UI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Address3").trim();
				String sCityUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("City").trim();
				String sZipUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Zip").trim();
				
				String sStateUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("State").trim();
				
				//String sCountryUI = "United States of America (USA)";
				String sCountryUI = TestDriver.mTestPhaseData.get(TestDriver.iTC_ID).get("Country").trim();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAddPlusLink_xp,"Add Address Link",true);
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine1_id, sAddr1UI, "Alternate Address Line 1");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine2_id, sAddr2UI, "Alternate Address Line 2");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputAddrLine3_id, sAddr3UI, "Alternate Address Line 3");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboCountry_id,sCountryUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.CustomersMaster_AddAltAddress_ComboState_id,sStateUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputCity_id, sCityUI, "Alt City");
				objGenericFunctionLibrary.SendKeyById(SphereModules.CustomersMaster_AddAltAddress_InputZip_id, sZipUI, "Alt Zip");
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.CustomersMaster_AddAltAddress_BtnAdd_xp,"Add Alternate Address Button",true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
				/////////////////////////////
				*/
				
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputDealTitle_id, sDealTitleUI, "Deal Title");
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_InputDealType_id,sDeal_TypeUI);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InputPoNumber_id, "5466", "PO Number");
				
				
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_SearchProjects_xp,sProjectName, "Search Project");
				objGenericFunctionLibrary.fnLoadingPageWait();
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_ProjectListSearch_xp, "First customer Row", true);
				
				//objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_xp, "Add New Project", true);
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectName_xp, sProjectNameUI, "Project Name ");
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddProject_ProjectCluster_xp, sProjectClusterUI, "Project Cluster ");
				/*objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDeal_AddProject_Project_Type_xp,sProjectType);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewProject_save_xp,"Save Project", true);
				Thread.sleep(10000);*/
				
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_xp,"Add Contact",true);
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_FirstName_xp, "Test First Name", "First Name ");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_LastName_xp, "Test Last Name", "Last Name");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_AddNewContact_Title_xp, "AutoTitle", "Title");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_PhoneNumber_xp, sContactPhone, "Phone Number");
				//objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_FaxNumber_xp, "123456753", "Fax Number");
				objGenericFunctionLibrary.SendKeyByXpath(SphereModules.Deals_AddDeal_EmailAddress_xp, "test@email.com", "Email Address");
				objGenericFunctionLibrary.ClickById(SphereModules. Deals_AddDeal_MainContact_id, "Main Contact", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDeal_ReceivesInvoice_id, "Receives Invoice", true);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_AddNewContact_save_xp,"Check", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,"09/10/2016","Insurance Expiration");
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnOnLotYes_id, "On Lot", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnTaxYes_id, "Tax", true);
				///objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareYes_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnRevenueShareNo_id, "Revenue Share", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCostPlusYes_id, "Cost Plus", true);
				
				//objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDealComboInvoiceFormat_id,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboInvoiceFormat_xp,sInvoiceFormatUI);
				objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboBillingSchedule_xp,sBillingScheduleUI);
				///objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputSalesForceId_id, sSalesForceID, "Salesforce ID");
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnStatusOpen_id, "Open", true);
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnCreditApprovedStudio_id, "Studio", true);
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnDepartment_CreditApproved_id, "Department Credit", true);
				//objGenericFunctionLibrary.fnSelectFromComboBoxXpath(SphereModules.Deals_AddDealComboCreditApprover_xp,sCreditApproverUI);
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sCreditLimitUI, "Credit Number");
				//objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDealInputCreditLimit_id, sRandom, "Credit Number");
				//objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertifiedYes_id, "Insurance Certified", true);
				objGenericFunctionLibrary.ClickById(SphereModules.Deals_AddDealBtnInsuranceCertified_id, "Insurance Certified", true);
				objGenericFunctionLibrary.SendKeyById(SphereModules.Deals_AddDeal_InsuranceExpiredDate_id,sEndDateUI2,"Insurance Expiration");
				
				objGenericFunctionLibrary.fnSelectFromComboBoxId(SphereModules.Deals_AddDeal_Customer_Code_id,sCustomer_CodeID);
				objGenericFunctionLibrary.ClickByXpath(SphereModules.Deals_AddDeal_BtnSave_xp,"Save Button", true);
				objGenericFunctionLibrary.fnLoadingPageWait();
				
			   /* try {
					waitForTableLoad.until(ExpectedConditions.visibilityOfElementLocated(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)));
					String sSuccessMsg = TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText();
	   
					objGenericFunctionLibrary.HighlightElementByXpath(SphereModules.Deals_AddDeal_MsgSuccess_xp);
					System.out.println(sSuccessMsg);
					
					if(sSuccessMsg.contains("Success!") || sSuccessMsg.contains("Created"))
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message successfully displayed on the screen", "Pass");
					}
					else
					{
						obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					}
					
					//objGenericFunctionLibrary.fnVerifyLabelMsgText(AppMessages.Deals_AddDeal__Success_msg, sSuccessMsg.trim());
				} catch (Exception e) {
					// TODO Auto-generated catch block
					obj.repAddData( "Verify Text", "Success message should be displayed on the screen", "Success message not displayed on the screen", "Fail");
					e.printStackTrace();
				}*/
		        
			/*	HashMap<Integer, HashMap<Integer, String>> mTableDataUI = objGenericFunctionLibrary.fnGetTableData(objSphereModules.Common_ViewDealModule_Table_xp);
				System.out.println("Hello");
				String sTempDealnumber= TestDriver.driver.findElement(By.xpath(SphereModules.Deals_AddDeal_MsgSuccess_xp)).getText().trim();
				for(int i=1;i<=mTableDataUI.size(); i++)
				{
					String sDealNumberUI = mTableDataUI.get(i).get(2).toString();
					
					if(sDealNumberUI.equalsIgnoreCase(sTempDealnumber))
					{
						obj.repAddData( "Verify :" +sTempDealnumber,   " should  be displayed in table.", sTempDealnumber + " displayed in table.", "Pass");
						 System.out.println("success");
						 break;
					}
					
				}	
			*/
					
			   
				
				String sQuery = objSQLConfig.sDeals_AddDeal_Query;
			    sQuery = sQuery.replaceAll("deal_title_param",sDealTitleUI);//use Deal Number here instead of DealTitle;
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB = objDBUtility.fnWriteResultSet(TestDriver.rset);
				
				objDBUtility.fnCloseDBConnection(TestDriver.stmt, TestDriver.rset, TestDriver.conn);
				String sDealNumberDB = mTableDataDB.get(1).get(1).toString().trim();
				String sDealTitleDB = mTableDataDB.get(1).get(2).toString().trim();
				String sDealTypeDB = mTableDataDB.get(1).get(3).toString().trim();
				String sCustomerNameDB = mTableDataDB.get(1).get(4).toString().trim();
			    
				String sMainAddressLine1DB = mTableDataDB.get(1).get(4).toString().trim();
				String sMainAddressLine2DB = mTableDataDB.get(1).get(5).toString().trim();
				String sMainAddressLine3DB=mTableDataDB.get(1).get(6).toString().trim();
				String sMainCityDB=	mTableDataDB.get(1).get(7).toString().trim();
				String sMainZipcodeDB=	mTableDataDB.get(1).get(8).toString().trim();
				String sCountryDB = mTableDataDB.get(1).get(9).toString().trim();
				String sStateDB=mTableDataDB.get(1).get(10).toString().trim();
				String srevenueDB=mTableDataDB.get(1).get(11).toString().trim();
				String slot=mTableDataDB.get(1).get(12).toString().trim();
				String scostplusDB=mTableDataDB.get(1).get(13).toString().trim();
				String sInsuranceDB=mTableDataDB.get(1).get(14).toString().trim();
				String sInuranceExpiration=mTableDataDB.get(1).get(15).toString().trim();
				String sIsTaxDB=mTableDataDB.get(1).get(16).toString().trim();
				String sPoNumberDB=mTableDataDB.get(1).get(17).toString().trim();
				String sSalesForceProjectDB=mTableDataDB.get(1).get(18).toString().trim();
				String sCreditApprovedDB=mTableDataDB.get(1).get(19).toString().trim();
				String sDealStatusDB=mTableDataDB.get(1).get(20).toString().trim();
				
					//if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) &&sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB)&& sCostCenterUI.equalsIgnoreCase(sCostCenterDB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB) && sEmailAddressUI.equalsIgnoreCase(sEmailAddressDB) && sAddr1UI.equalsIgnoreCase(sMainAddressLine3DB)&&sAddr2UI.equalsIgnoreCase(sMainAddressLine4DB) && sProjectNameUI.equalsIgnoreCase(sProjectNameDB)&& sProjectType.equalsIgnoreCase(sProjectTypeDB)&& sProjectClusterUI.equalsIgnoreCase(sProjectClusterDB))
				
					if(sDealTitleUI.equalsIgnoreCase(sDealTitleDB) && 
							sDeal_TypeUI.equalsIgnoreCase(sDealTypeDB) && 
							sCustomerUI.equalsIgnoreCase(sCustomerNameDB))
				{	
					//TestDriver.bw.append("\n"+TestDriver.sTest_Case_ID+","+TestDriver.sTest_Case_Name+",\'"+sDealNumberDB+"/"+sDealTitleDB+",Create");
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI +" and Deal Number : "+sDealNumberDB, "Validation successful for deal title : "+ sDealTitleUI+" and Deal Number : "+sDealNumberDB, "Pass");
				}
				else
				{
					obj.repAddData( "Compare deal account record for Deal Title : "+ sDealTitleUI, "Deal account record on UI and DB should match for Deal Title : "+ sDealTitleUI, "Validation failed for deal title : "+ sDealTitleUI, "Fail");
				}
				
				
				
			} catch (Exception e) {
		   System.out.println("fnAddDealAccount --------------Failed");    
		   TestDriver.log.error("fnAddDealAccount failed",e);
		   }
			
			return sDealTitleUI;
	}
	 
	 public String fnVerifyMatchAndDeleteSuccess(String sExpDealNumberDB) throws Exception
		{
			
			try
			{
				String sQuery2 = objSQLConfig.sBillingApprovals_MatchAndDelete_Query;
				sQuery2 = sQuery2.replaceAll("deal_number_param",sExpDealNumberDB);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery2);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB2 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String transaction_statuscode_id_Row1=mTableDataDB2.get(1).get(1).toString().trim();
			  //  String transaction_statuscode_id_Row2=mTableDataDB2.get(1).get(2).toString().trim();
			    
			   
			
			    if((transaction_statuscode_id_Row1.equalsIgnoreCase("31015"))||(transaction_statuscode_id_Row1.equalsIgnoreCase("Match And Delete")))
			    {
			    	obj.repAddData( "Verify  transaftion status code id", 
						"transaction status code id Should be displayed as '31015' '' ",
						"transaction status code id is displayed as "+transaction_statuscode_id_Row1+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  transaction status code id", 
						"transaction status code id",
						"transaction status code id is displayed as "+transaction_statuscode_id_Row1+"", "Fail");
			    
			    }
			    
			    
			   /* if((transaction_statuscode_id_Row2.equalsIgnoreCase("31015"))||(transaction_statuscode_id_Row1.equalsIgnoreCase("Match And Delete")))
			    {
			    	obj.repAddData( "Verify  transaftion status code id", 
						"transaction status code id Should be displayed as '31015' '' ",
						"transaction status code id is displayed as "+transaction_statuscode_id_Row1+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify  transaction status code id", 
						"transaction status code id",
						"transaction status code id is displayed as "+transaction_statuscode_id_Row1+"", "Fail");
			    
			    }*/
			    
			    String sQuery1 = objSQLConfig.sBillingApprovals_MatchAndDelete_Query_dealid;
			    sQuery1 = sQuery1.replaceAll("deal_number_param",sExpDealNumberDB);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery1);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB21 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String dealid=mTableDataDB21.get(1).get(1).toString().trim();
			   
			    String sQuery11 = objSQLConfig.sBillingApprovals_MatchAndDelete_Query_dealOrderid;
			    sQuery11 = sQuery11.replaceAll("deal_number_param",dealid);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery11);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB212 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String dealorderid=mTableDataDB212.get(1).get(1).toString().trim();
			    
			    String sQuery112 = objSQLConfig.sBillingApprovals_MatchAndDelete_Query_groupingid;
			    sQuery112 = sQuery112.replaceAll("deal_number_param",dealorderid);
				TestDriver.conn = objDBUtility.fnOpenDBConnection();
				TestDriver.rset = objDBUtility.fnGetDBData(TestDriver.conn,sQuery112);
				HashMap<Integer, HashMap<Integer, String>> mTableDataDB2123 = objDBUtility.fnWriteResultSet(TestDriver.rset);
			    String matchAndDelete_groupingid_1=mTableDataDB2123.get(1).get(1).toString().trim();
			    String matchAndDelete_groupingid_2=mTableDataDB2123.get(2).get(1).toString().trim();
			   
			    
			    if(matchAndDelete_groupingid_1.equalsIgnoreCase(matchAndDelete_groupingid_2))
			    {
			    	obj.repAddData( "Verify match and delete grouping id ", 
						"match and delete grouping id  Should be same ",
						"match and delete grouping id  is same and is displayed as "+transaction_statuscode_id_Row1+"", "Pass");
			    }else
			    {
			    	obj.repAddData( "Verify match and delete grouping id ", 
						"match and delete grouping id  Should be same ",
						"match and delete grouping id  is not same and is displayed as "+transaction_statuscode_id_Row1+"", "Fail");
			    
			    }
				
			} catch (Exception e) {
				
		   System.out.println("fnVerifyDealExportData --------------Failed");    
		   TestDriver.log.error("fnVerifyDealExportData failed",e);
		   }
		//	String sExpDealNumberDB = null;
			return sExpDealNumberDB;
			
		}
	 
	 
}

